  [1m[36mSQL (0.8ms)[0m  [1mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (21.5ms)[0m  CREATE TABLE "buttafly_legends" ("id" serial primary key, "cartographer_id" integer, "data" json, "name" character varying(255), "created_at" timestamp, "updated_at" timestamp) 
  [1m[36m (15.1ms)[0m  [1mCREATE TABLE "buttafly_mappings" ("id" serial primary key, "legend_id" integer, "originable_id" integer, "originable_type" character varying(255), "targetable_model" character varying(255), "created_at" timestamp, "updated_at" timestamp) [0m
  [1m[35m (8.4ms)[0m  CREATE  INDEX  "index_buttafly_mappings_on_legend_id" ON "buttafly_mappings" USING btree ("legend_id")
  [1m[36m (8.8ms)[0m  [1mCREATE  INDEX  "index_buttafly_mappings_on_originable_id_and_originable_type" ON "buttafly_mappings" USING btree ("originable_id", "originable_type")[0m
  [1m[35m (9.6ms)[0m  CREATE TABLE "buttafly_spreadsheets" ("id" serial primary key, "data" json, "name" character varying(255), "user_id" integer, "imported_at" timestamp, "processed_at" timestamp, "aasm_state" character varying(255), "source_row_count" integer, "mtime" integer, "created_at" timestamp, "updated_at" timestamp, "flat_file" character varying(255)) 
  [1m[36m (3.2ms)[0m  [1mCREATE  INDEX  "index_buttafly_spreadsheets_on_aasm_state" ON "buttafly_spreadsheets" USING btree ("aasm_state")[0m
  [1m[35m (3.3ms)[0m  CREATE  INDEX  "index_buttafly_spreadsheets_on_imported_at" ON "buttafly_spreadsheets" USING btree ("imported_at")
  [1m[36m (3.4ms)[0m  [1mCREATE  INDEX  "index_buttafly_spreadsheets_on_name" ON "buttafly_spreadsheets" USING btree ("name")[0m
  [1m[35m (3.4ms)[0m  CREATE  INDEX  "index_buttafly_spreadsheets_on_processed_at" ON "buttafly_spreadsheets" USING btree ("processed_at")
  [1m[36m (5.2ms)[0m  [1mCREATE  INDEX  "index_buttafly_spreadsheets_on_user_id" ON "buttafly_spreadsheets" USING btree ("user_id")[0m
  [1m[35m (9.7ms)[0m  CREATE TABLE "dummy_children" ("id" serial primary key, "name" character varying(255), "dummy_parent_id" integer, "dummy_tribe_id" integer, "created_at" timestamp, "updated_at" timestamp, "age" integer) 
  [1m[36m (9.5ms)[0m  [1mCREATE TABLE "dummy_grandparents" ("id" serial primary key, "name" character varying(255), "dummy_tribe_id" integer, "created_at" timestamp, "updated_at" timestamp) [0m
  [1m[35m (9.4ms)[0m  CREATE TABLE "dummy_parents" ("id" serial primary key, "name" character varying(255), "dummy_grandparent_id" integer, "dummy_tribe_id" integer, "created_at" timestamp, "updated_at" timestamp) 
  [1m[36m (9.2ms)[0m  [1mCREATE TABLE "dummy_tribes" ("id" serial primary key, "name" character varying(255), "created_at" timestamp, "updated_at" timestamp) [0m
  [1m[35m (8.0ms)[0m  CREATE TABLE "users" ("id" serial primary key, "name" character varying(255), "created_at" timestamp, "updated_at" timestamp) 
  [1m[36m (1.6ms)[0m  [1mCREATE TABLE "schema_migrations" ("version" character varying(255) NOT NULL) [0m
  [1m[35m (3.3ms)[0m  CREATE UNIQUE INDEX  "unique_schema_migrations" ON "schema_migrations"  ("version")
  [1m[36m (0.4ms)[0m  [1mSELECT version FROM "schema_migrations"[0m
  [1m[35m (1.1ms)[0m  INSERT INTO "schema_migrations" (version) VALUES ('20141101223453')
  [1m[36m (1.0ms)[0m  [1mINSERT INTO "schema_migrations" (version) VALUES ('20140917185910')[0m
  [1m[35m (1.1ms)[0m  INSERT INTO "schema_migrations" (version) VALUES ('20140917190530')
  [1m[36m (1.0ms)[0m  [1mINSERT INTO "schema_migrations" (version) VALUES ('20140917190801')[0m
  [1m[35m (1.0ms)[0m  INSERT INTO "schema_migrations" (version) VALUES ('20140919055223')
  [1m[36m (1.0ms)[0m  [1mINSERT INTO "schema_migrations" (version) VALUES ('20140916214009')[0m
  [1m[35mActiveRecord::SchemaMigration Load (0.3ms)[0m  SELECT "schema_migrations".* FROM "schema_migrations"
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  COMMIT
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.2ms)[0m  ROLLBACK
  [1m[36m (0.2ms)[0m  [1mBEGIN[0m
  [1m[35m (0.2ms)[0m  COMMIT
  [1m[36m (0.2ms)[0m  [1mBEGIN[0m
  [1m[35m (0.2ms)[0m  ROLLBACK
  [1m[36m (0.2ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  COMMIT
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  COMMIT
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  COMMIT
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  COMMIT
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mButtafly::Spreadsheet Exists (1.0ms)[0m  [1mSELECT  1 AS one FROM "buttafly_spreadsheets"  WHERE "buttafly_spreadsheets"."name" = 'test_file_name1' LIMIT 1[0m
  [1m[35mSQL (0.5ms)[0m  INSERT INTO "buttafly_spreadsheets" ("aasm_state", "created_at", "data", "flat_file", "name", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["aasm_state", "not_imported"], ["created_at", "2014-11-15 00:08:59.280128"], ["data", "{}"], ["flat_file", "family.odt.csv"], ["name", "test_file_name1"], ["updated_at", "2014-11-15 00:08:59.280128"]]
  [1m[36m (0.2ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.5ms)[0m  [1mINSERT INTO "buttafly_legends" ("created_at", "data", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["created_at", "2014-11-15 00:08:59.296740"], ["data", "{\"meta\":{\"col_sep\":\",\",\"encoding\":\"utf-8\",\"row_sep\":\"/n\",\"headers\":[\"mother\",\"child\",\"grandparent\"]},\"dummy_child\":{\"name\":\"child\",\"dummy_parent\":{\"name\":\"mother\",\"dummy_grandparent\":{\"name\":\"grandparent\"}}}}"], ["updated_at", "2014-11-15 00:08:59.296740"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.3ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
----------------------------------------------
create mapping Feature Test: test_0001_success
----------------------------------------------
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mButtafly::Spreadsheet Exists (0.5ms)[0m  SELECT  1 AS one FROM "buttafly_spreadsheets"  WHERE "buttafly_spreadsheets"."name" = 'test_file_name2' LIMIT 1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO "buttafly_spreadsheets" ("aasm_state", "created_at", "data", "flat_file", "name", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["aasm_state", "not_imported"], ["created_at", "2014-11-15 00:08:59.306029"], ["data", "[{\"mother\":\"Sarah Jane Schoeneman\",\"child\":\"Ella Mac Pacurar\",\"grandparent\":\"Vicki Pacurar\"}]"], ["flat_file", "family.odt.csv"], ["name", "test_file_name2"], ["updated_at", "2014-11-15 00:08:59.306029"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Started GET "/buttafly/contents" for 127.0.0.1 at 2014-11-14 16:08:59 -0800
Processing by Buttafly::ContentsController#index as HTML
  Rendered /home/fred/work/opensource/buttafly/app/views/buttafly/contents/_form.html.haml (11.3ms)
  [1m[36mButtafly::Spreadsheet Load (0.8ms)[0m  [1mSELECT  "buttafly_spreadsheets".* FROM "buttafly_spreadsheets"   ORDER BY "buttafly_spreadsheets"."created_at" ASC LIMIT 5 OFFSET 0[0m
  [1m[35mButtafly::Mapping Load (0.3ms)[0m  SELECT "buttafly_mappings".* FROM "buttafly_mappings"  WHERE "buttafly_mappings"."originable_id" = $1 AND "buttafly_mappings"."originable_type" = $2  [["originable_id", 2], ["originable_type", "Buttafly::Spreadsheet"]]
  [1m[36mButtafly::Legend Load (0.3ms)[0m  [1mSELECT "buttafly_legends".* FROM "buttafly_legends"[0m
  Rendered /home/fred/work/opensource/buttafly/app/views/buttafly/contents/_content.html.haml (19.0ms)
  [1m[35m (0.3ms)[0m  SELECT COUNT(*) FROM "buttafly_spreadsheets"
  Rendered /home/fred/work/opensource/buttafly/app/views/buttafly/contents/index.html.haml within layouts/application (44.6ms)
  Rendered application/_messages.html.haml (8.9ms)
Completed 200 OK in 3896ms (Views: 3891.5ms | ActiveRecord: 1.7ms)
  [1m[36m (0.2ms)[0m  [1mSELECT COUNT(*) FROM "buttafly_mappings"  WHERE "buttafly_mappings"."originable_id" = $1 AND "buttafly_mappings"."originable_type" = $2[0m  [["originable_id", 2], ["originable_type", "Buttafly::Spreadsheet"]]
Started POST "/buttafly/mappings?originable_id=2" for 127.0.0.1 at 2014-11-14 16:09:03 -0800
Processing by Buttafly::MappingsController#create as HTML
  Parameters: {"utf8"=>"âœ“", "mapping"=>{"originable_id"=>"2", "targetable_model"=>"DummyChild"}, "commit"=>"Select Target Model", "originable_id"=>"2"}
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mButtafly::Spreadsheet Load (0.2ms)[0m  [1mSELECT  "buttafly_spreadsheets".* FROM "buttafly_spreadsheets"  WHERE "buttafly_spreadsheets"."id" = $1 LIMIT 1[0m  [["id", 2]]
  [1m[35mSQL (0.4ms)[0m  INSERT INTO "buttafly_mappings" ("created_at", "originable_id", "originable_type", "targetable_model", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["created_at", "2014-11-15 00:09:03.240461"], ["originable_id", 2], ["originable_type", "Buttafly::Spreadsheet"], ["targetable_model", "DummyChild"], ["updated_at", "2014-11-15 00:09:03.240461"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/buttafly/contents
Completed 302 Found in 5ms (ActiveRecord: 0.9ms)
Started GET "/buttafly/contents" for 127.0.0.1 at 2014-11-14 16:09:03 -0800
Processing by Buttafly::ContentsController#index as HTML
  Rendered /home/fred/work/opensource/buttafly/app/views/buttafly/contents/_form.html.haml (1.3ms)
  [1m[35mButtafly::Spreadsheet Load (0.3ms)[0m  SELECT  "buttafly_spreadsheets".* FROM "buttafly_spreadsheets"   ORDER BY "buttafly_spreadsheets"."created_at" ASC LIMIT 5 OFFSET 0
  [1m[36mButtafly::Mapping Load (0.3ms)[0m  [1mSELECT "buttafly_mappings".* FROM "buttafly_mappings"  WHERE "buttafly_mappings"."originable_id" = $1 AND "buttafly_mappings"."originable_type" = $2[0m  [["originable_id", 2], ["originable_type", "Buttafly::Spreadsheet"]]
  [1m[35mButtafly::Legend Load (0.2ms)[0m  SELECT "buttafly_legends".* FROM "buttafly_legends"
  Rendered /home/fred/work/opensource/buttafly/app/views/buttafly/contents/_content.html.haml (4.0ms)
  [1m[36m (0.2ms)[0m  [1mSELECT COUNT(*) FROM "buttafly_spreadsheets"[0m
  Rendered /home/fred/work/opensource/buttafly/app/views/buttafly/contents/index.html.haml within layouts/application (7.5ms)
  Rendered application/_messages.html.haml (0.5ms)
Completed 200 OK in 11ms (Views: 8.5ms | ActiveRecord: 1.0ms)
  [1m[35m (0.3ms)[0m  SELECT COUNT(*) FROM "buttafly_mappings"  WHERE "buttafly_mappings"."originable_id" = $1 AND "buttafly_mappings"."originable_type" = $2  [["originable_id", 2], ["originable_type", "Buttafly::Spreadsheet"]]
  [1m[36mButtafly::Mapping Load (0.3ms)[0m  [1mSELECT  "buttafly_mappings".* FROM "buttafly_mappings"  WHERE "buttafly_mappings"."originable_id" = $1 AND "buttafly_mappings"."originable_type" = $2  ORDER BY "buttafly_mappings"."id" ASC LIMIT 1[0m  [["originable_id", 2], ["originable_type", "Buttafly::Spreadsheet"]]
  [1m[35mButtafly::Spreadsheet Load (0.3ms)[0m  SELECT  "buttafly_spreadsheets".* FROM "buttafly_spreadsheets"  WHERE "buttafly_spreadsheets"."id" = $1 LIMIT 1  [["id", 2]]
  [1m[36m (0.2ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
-------------------------------------------------------------
Buttafly::LegendsController::GET #new: test_0001_must succeed
-------------------------------------------------------------
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mButtafly::Spreadsheet Exists (0.3ms)[0m  SELECT  1 AS one FROM "buttafly_spreadsheets"  WHERE "buttafly_spreadsheets"."name" = 'test_file_name3' LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "buttafly_spreadsheets" ("aasm_state", "created_at", "data", "flat_file", "name", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["aasm_state", "not_imported"], ["created_at", "2014-11-15 00:09:03.269403"], ["data", "{}"], ["flat_file", "family.odt.csv"], ["name", "test_file_name3"], ["updated_at", "2014-11-15 00:09:03.269403"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "buttafly_mappings" ("created_at", "originable_id", "originable_type", "targetable_model", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["created_at", "2014-11-15 00:09:03.271630"], ["originable_id", 3], ["originable_type", "Buttafly::Spreadsheet"], ["targetable_model", "DummyChild"], ["updated_at", "2014-11-15 00:09:03.271630"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by Buttafly::LegendsController#new as HTML
  Parameters: {"mapping_id"=>"2"}
  [1m[35mButtafly::Mapping Load (0.2ms)[0m  SELECT  "buttafly_mappings".* FROM "buttafly_mappings"  WHERE "buttafly_mappings"."id" = $1 LIMIT 1  [["id", 2]]
  [1m[36mButtafly::Spreadsheet Load (0.2ms)[0m  [1mSELECT  "buttafly_spreadsheets".* FROM "buttafly_spreadsheets"  WHERE "buttafly_spreadsheets"."id" = $1 LIMIT 1[0m  [["id", 3]]
  Rendered /home/fred/work/opensource/buttafly/app/views/buttafly/legends/new.html.haml within layouts/application (5.4ms)
  Rendered application/_messages.html.haml (0.1ms)
Completed 200 OK in 12ms (Views: 9.1ms | ActiveRecord: 0.4ms)
  [1m[35m (0.2ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
------------------------------------------------------------------------------------------------
Buttafly::LegendsController::GET #new: test_0002_must instantiate a legend from existing mapping
------------------------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mButtafly::Spreadsheet Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "buttafly_spreadsheets"  WHERE "buttafly_spreadsheets"."name" = 'test_file_name4' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "buttafly_spreadsheets" ("aasm_state", "created_at", "data", "flat_file", "name", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["aasm_state", "not_imported"], ["created_at", "2014-11-15 00:09:03.294544"], ["data", "{}"], ["flat_file", "family.odt.csv"], ["name", "test_file_name4"], ["updated_at", "2014-11-15 00:09:03.294544"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "buttafly_mappings" ("created_at", "originable_id", "originable_type", "targetable_model", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["created_at", "2014-11-15 00:09:03.296755"], ["originable_id", 4], ["originable_type", "Buttafly::Spreadsheet"], ["targetable_model", "DummyChild"], ["updated_at", "2014-11-15 00:09:03.296755"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by Buttafly::LegendsController#new as HTML
  Parameters: {"mapping_id"=>"3"}
  [1m[36mButtafly::Mapping Load (0.2ms)[0m  [1mSELECT  "buttafly_mappings".* FROM "buttafly_mappings"  WHERE "buttafly_mappings"."id" = $1 LIMIT 1[0m  [["id", 3]]
  [1m[35mButtafly::Spreadsheet Load (0.2ms)[0m  SELECT  "buttafly_spreadsheets".* FROM "buttafly_spreadsheets"  WHERE "buttafly_spreadsheets"."id" = $1 LIMIT 1  [["id", 4]]
  Rendered application/_messages.html.haml (0.1ms)
Completed 200 OK in 8ms (Views: 5.3ms | ActiveRecord: 0.4ms)
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
-----------------------------------------------------------------------------
Buttafly::LegendsController::POST #create: test_0001_must create a new legend
-----------------------------------------------------------------------------
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.0ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.0ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.0ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.0ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.0ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.0ms)[0m  BEGIN
  [1m[36mButtafly::Spreadsheet Exists (0.4ms)[0m  [1mSELECT  1 AS one FROM "buttafly_spreadsheets"  WHERE "buttafly_spreadsheets"."name" = 'test_file_name5' LIMIT 1[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  COMMIT
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  COMMIT
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  COMMIT
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
-----------------------------
ButtaflyTest: test_0001_truth
-----------------------------
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  COMMIT
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.2ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  COMMIT
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.4ms)[0m  [1mINSERT INTO "dummy_tribes" ("created_at", "name", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["created_at", "2014-11-15 00:09:03.346560"], ["name", "MyString"], ["updated_at", "2014-11-15 00:09:03.346560"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
-------------------------------------------------------------------------
Buttafly::ContentsController: test_0001_get #show must assign @originable
-------------------------------------------------------------------------
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mButtafly::Spreadsheet Exists (0.3ms)[0m  SELECT  1 AS one FROM "buttafly_spreadsheets"  WHERE "buttafly_spreadsheets"."name" = 'test_file_name6' LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "buttafly_spreadsheets" ("aasm_state", "created_at", "data", "flat_file", "name", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["aasm_state", "not_imported"], ["created_at", "2014-11-15 00:09:03.356649"], ["data", "{}"], ["flat_file", "family.odt.csv"], ["name", "test_file_name6"], ["updated_at", "2014-11-15 00:09:03.356649"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by Buttafly::ContentsController#show as HTML
  Parameters: {"id"=>"5"}
  [1m[36mButtafly::Spreadsheet Load (0.2ms)[0m  [1mSELECT  "buttafly_spreadsheets".* FROM "buttafly_spreadsheets"  WHERE "buttafly_spreadsheets"."id" = $1 LIMIT 1[0m  [["id", 5]]
  Rendered application/_messages.html.haml (0.1ms)
Completed 200 OK in 4ms (Views: 2.9ms | ActiveRecord: 0.2ms)
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
-------------------------------------------------
Buttafly::ContentsController: test_0002_get #edit
-------------------------------------------------
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mButtafly::Spreadsheet Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM "buttafly_spreadsheets"  WHERE "buttafly_spreadsheets"."name" = 'test_file_name7' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "buttafly_spreadsheets" ("aasm_state", "created_at", "data", "flat_file", "name", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["aasm_state", "not_imported"], ["created_at", "2014-11-15 00:09:03.367896"], ["data", "{}"], ["flat_file", "family.odt.csv"], ["name", "test_file_name7"], ["updated_at", "2014-11-15 00:09:03.367896"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by Buttafly::ContentsController#edit as HTML
  Parameters: {"id"=>"6"}
  [1m[35mButtafly::Spreadsheet Load (0.3ms)[0m  SELECT  "buttafly_spreadsheets".* FROM "buttafly_spreadsheets"  WHERE "buttafly_spreadsheets"."id" = $1 LIMIT 1  [["id", 6]]
  Rendered /home/fred/work/opensource/buttafly/app/views/buttafly/contents/_form.html.haml (1.5ms)
  Rendered application/_messages.html.haml (0.1ms)
Completed 200 OK in 6ms (Views: 5.1ms | ActiveRecord: 0.3ms)
  [1m[36m (0.2ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
----------------------------------------------------
Buttafly::ContentsController: test_0003_post #create
----------------------------------------------------
Processing by Buttafly::ContentsController#create as HTML
  Parameters: {"originable"=>{"name"=>"slick name", "flat_file"=>"slickname.csv"}}
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mButtafly::Spreadsheet Exists (0.3ms)[0m  SELECT  1 AS one FROM "buttafly_spreadsheets"  WHERE "buttafly_spreadsheets"."name" = 'slick name' LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "buttafly_spreadsheets" ("aasm_state", "created_at", "flat_file", "name", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["aasm_state", "not_imported"], ["created_at", "2014-11-15 00:09:03.381216"], ["flat_file", nil], ["name", "slick name"], ["updated_at", "2014-11-15 00:09:03.381216"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://test.host/buttafly/contents
Completed 302 Found in 4ms (ActiveRecord: 0.8ms)
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
-------------------------------------------------------------------------
Buttafly::ContentsController: test_0004_patch #import saves a spreadsheet
-------------------------------------------------------------------------
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mButtafly::Spreadsheet Exists (0.3ms)[0m  SELECT  1 AS one FROM "buttafly_spreadsheets"  WHERE "buttafly_spreadsheets"."name" = 'test_file_name8' LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "buttafly_spreadsheets" ("aasm_state", "created_at", "data", "flat_file", "name", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["aasm_state", "not_imported"], ["created_at", "2014-11-15 00:09:03.388047"], ["data", "{}"], ["flat_file", "family.odt.csv"], ["name", "test_file_name8"], ["updated_at", "2014-11-15 00:09:03.388047"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by Buttafly::ContentsController#import as HTML
  Parameters: {"originable_type"=>"Buttafly::Spreadsheet", "id"=>"8"}
  [1m[36mButtafly::Spreadsheet Load (0.1ms)[0m  [1mSELECT  "buttafly_spreadsheets".* FROM "buttafly_spreadsheets"  WHERE "buttafly_spreadsheets"."id" = $1 LIMIT 1[0m  [["id", 8]]
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mButtafly::Spreadsheet Exists (0.4ms)[0m  [1mSELECT  1 AS one FROM "buttafly_spreadsheets"  WHERE ("buttafly_spreadsheets"."name" = 'test_file_name8' AND "buttafly_spreadsheets"."id" != 8) LIMIT 1[0m
  [1m[35mSQL (0.3ms)[0m  UPDATE "buttafly_spreadsheets" SET "data" = $1, "imported_at" = $2, "updated_at" = $3 WHERE "buttafly_spreadsheets"."id" = 8  [["data", "[{\"child name\":\"ella mac\",\"parent name\":\"sara\",\"grandparent name\":\"kc shekhar\",\"tribe name\":\"india\",\"age\":\"2.5\"},{\"child name\":\"rohan\",\"parent name\":\"doug\",\"grandparent name\":\"vicki\",\"tribe name\":\"america\",\"age\":\"6\"}]"], ["imported_at", "2014-11-15 00:09:03.391613"], ["updated_at", "2014-11-15 00:09:03.394160"]]
  [1m[36mButtafly::Spreadsheet Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "buttafly_spreadsheets"  WHERE ("buttafly_spreadsheets"."name" = 'test_file_name8' AND "buttafly_spreadsheets"."id" != 8) LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  UPDATE "buttafly_spreadsheets" SET "aasm_state" = $1, "updated_at" = $2 WHERE "buttafly_spreadsheets"."id" = 8  [["aasm_state", "imported"], ["updated_at", "2014-11-15 00:09:03.397713"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to /referring/url
Completed 302 Found in 8ms (ActiveRecord: 1.5ms)
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
------------------------------------------------------------------------
Buttafly::ContentsController: test_0005_post #create saves a spreadsheet
------------------------------------------------------------------------
  [1m[35m (0.2ms)[0m  SELECT COUNT(*) FROM "buttafly_spreadsheets"
Processing by Buttafly::ContentsController#create as HTML
  Parameters: {"originable"=>{"name"=>"sweeet name", "flat_file"=>"summer.csv"}}
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mButtafly::Spreadsheet Exists (0.2ms)[0m  SELECT  1 AS one FROM "buttafly_spreadsheets"  WHERE "buttafly_spreadsheets"."name" = 'sweeet name' LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "buttafly_spreadsheets" ("aasm_state", "created_at", "flat_file", "name", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["aasm_state", "not_imported"], ["created_at", "2014-11-15 00:09:03.403580"], ["flat_file", nil], ["name", "sweeet name"], ["updated_at", "2014-11-15 00:09:03.403580"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://test.host/buttafly/contents
Completed 302 Found in 3ms (ActiveRecord: 0.6ms)
  [1m[36m (0.2ms)[0m  [1mSELECT COUNT(*) FROM "buttafly_spreadsheets"[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
--------------------------------------------------------
Buttafly::ContentsController: test_0006_should get index
--------------------------------------------------------
Processing by Buttafly::ContentsController#index as HTML
  Rendered /home/fred/work/opensource/buttafly/app/views/buttafly/contents/_form.html.haml (1.3ms)
  [1m[35mButtafly::Spreadsheet Load (0.3ms)[0m  SELECT  "buttafly_spreadsheets".* FROM "buttafly_spreadsheets"   ORDER BY "buttafly_spreadsheets"."created_at" ASC LIMIT 5 OFFSET 0
  [1m[36m (0.2ms)[0m  [1mSELECT COUNT(*) FROM "buttafly_spreadsheets"[0m
  Rendered application/_messages.html.haml (0.1ms)
Completed 200 OK in 6ms (Views: 4.6ms | ActiveRecord: 0.5ms)
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
  [1m[35m (0.0ms)[0m  COMMIT
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
  [1m[35mButtafly::Spreadsheet Exists (0.2ms)[0m  SELECT  1 AS one FROM "buttafly_spreadsheets"  WHERE "buttafly_spreadsheets"."name" = 'test_file_name9' LIMIT 1
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
  [1m[36m (0.0ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.0ms)[0m  BEGIN
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
  [1m[36m (0.0ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.0ms)[0m  BEGIN
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
  [1m[36m (0.0ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.0ms)[0m  BEGIN
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
  [1m[36m (0.0ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.0ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
  [1m[36m (0.0ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.0ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "dummy_tribes" ("created_at", "name", "updated_at") VALUES ($1, $2, $3) RETURNING "id"  [["created_at", "2014-11-15 00:09:03.424624"], ["name", "MyString"], ["updated_at", "2014-11-15 00:09:03.424624"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO "dummy_grandparents" ("created_at", "dummy_tribe_id", "name", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["created_at", "2014-11-15 00:09:03.426188"], ["dummy_tribe_id", 2], ["name", "Vicki Pacurar"], ["updated_at", "2014-11-15 00:09:03.426188"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "dummy_tribes" ("created_at", "name", "updated_at") VALUES ($1, $2, $3) RETURNING "id"  [["created_at", "2014-11-15 00:09:03.428610"], ["name", "MyString"], ["updated_at", "2014-11-15 00:09:03.428610"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO "dummy_parents" ("created_at", "dummy_grandparent_id", "dummy_tribe_id", "name", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["created_at", "2014-11-15 00:09:03.430407"], ["dummy_grandparent_id", 1], ["dummy_tribe_id", 3], ["name", "Sarah Jane Schoeneman"], ["updated_at", "2014-11-15 00:09:03.430407"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "dummy_tribes" ("created_at", "name", "updated_at") VALUES ($1, $2, $3) RETURNING "id"  [["created_at", "2014-11-15 00:09:03.432406"], ["name", "MyString"], ["updated_at", "2014-11-15 00:09:03.432406"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO "dummy_children" ("created_at", "dummy_parent_id", "dummy_tribe_id", "name", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["created_at", "2014-11-15 00:09:03.434062"], ["dummy_parent_id", 1], ["dummy_tribe_id", 4], ["name", "Ella Mac"], ["updated_at", "2014-11-15 00:09:03.434062"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
  [1m[36m (0.0ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.0ms)[0m  BEGIN
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "dummy_tribes" ("created_at", "name", "updated_at") VALUES ($1, $2, $3) RETURNING "id"  [["created_at", "2014-11-15 00:09:03.438458"], ["name", "MyString"], ["updated_at", "2014-11-15 00:09:03.438458"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "dummy_grandparents" ("created_at", "dummy_tribe_id", "name", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["created_at", "2014-11-15 00:09:03.439707"], ["dummy_tribe_id", 5], ["name", "Vicki Pacurar"], ["updated_at", "2014-11-15 00:09:03.439707"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "dummy_tribes" ("created_at", "name", "updated_at") VALUES ($1, $2, $3) RETURNING "id"  [["created_at", "2014-11-15 00:09:03.440903"], ["name", "MyString"], ["updated_at", "2014-11-15 00:09:03.440903"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO "dummy_parents" ("created_at", "dummy_grandparent_id", "dummy_tribe_id", "name", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["created_at", "2014-11-15 00:09:03.442234"], ["dummy_grandparent_id", 2], ["dummy_tribe_id", 6], ["name", "Sarah Jane Schoeneman"], ["updated_at", "2014-11-15 00:09:03.442234"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "dummy_tribes" ("created_at", "name", "updated_at") VALUES ($1, $2, $3) RETURNING "id"  [["created_at", "2014-11-15 00:09:03.444382"], ["name", "MyString"], ["updated_at", "2014-11-15 00:09:03.444382"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "dummy_children" ("created_at", "dummy_parent_id", "dummy_tribe_id", "name", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["created_at", "2014-11-15 00:09:03.446081"], ["dummy_parent_id", 2], ["dummy_tribe_id", 7], ["name", "Ella Mac"], ["updated_at", "2014-11-15 00:09:03.446081"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.0ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
  [1m[36m (0.0ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.0ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "dummy_tribes" ("created_at", "name", "updated_at") VALUES ($1, $2, $3) RETURNING "id"  [["created_at", "2014-11-15 00:09:03.450510"], ["name", "MyString"], ["updated_at", "2014-11-15 00:09:03.450510"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "dummy_grandparents" ("created_at", "dummy_tribe_id", "name", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["created_at", "2014-11-15 00:09:03.451665"], ["dummy_tribe_id", 8], ["name", "Vicki Pacurar"], ["updated_at", "2014-11-15 00:09:03.451665"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "dummy_tribes" ("created_at", "name", "updated_at") VALUES ($1, $2, $3) RETURNING "id"  [["created_at", "2014-11-15 00:09:03.452867"], ["name", "MyString"], ["updated_at", "2014-11-15 00:09:03.452867"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
-------------------------
RoutesTest: test_messages
-------------------------
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
  [1m[35m (0.0ms)[0m  COMMIT
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
  [1m[35m (0.0ms)[0m  COMMIT
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.2ms)[0m  ROLLBACK
  [1m[36m (0.2ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  COMMIT
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  COMMIT
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  COMMIT
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  COMMIT
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mButtafly::Spreadsheet Exists (0.3ms)[0m  SELECT  1 AS one FROM "buttafly_spreadsheets"  WHERE "buttafly_spreadsheets"."name" = 'test_file_name10' LIMIT 1
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.0ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.2ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
---------------------------------------------------------
Buttafly::MappingsController: test_0001_must POST #create
---------------------------------------------------------
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mButtafly::Spreadsheet Exists (0.2ms)[0m  SELECT  1 AS one FROM "buttafly_spreadsheets"  WHERE "buttafly_spreadsheets"."name" = 'test_file_name11' LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "buttafly_spreadsheets" ("aasm_state", "created_at", "data", "flat_file", "name", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["aasm_state", "not_imported"], ["created_at", "2014-11-15 00:09:03.491672"], ["data", "[{\"mother\":\"Sarah Jane Schoeneman\",\"child\":\"Ella Mac Pacurar\",\"grandparent\":\"Vicki Pacurar\"}]"], ["flat_file", "family.odt.csv"], ["name", "test_file_name11"], ["updated_at", "2014-11-15 00:09:03.491672"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by Buttafly::MappingsController#create as HTML
  Parameters: {"mapping"=>{"originable_id"=>"10", "targetable_model"=>"DummyChild"}}
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mButtafly::Spreadsheet Load (0.1ms)[0m  SELECT  "buttafly_spreadsheets".* FROM "buttafly_spreadsheets"  WHERE "buttafly_spreadsheets"."id" = $1 LIMIT 1  [["id", 10]]
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "buttafly_mappings" ("created_at", "originable_id", "originable_type", "targetable_model", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["created_at", "2014-11-15 00:09:03.496820"], ["originable_id", 10], ["originable_type", "Buttafly::Spreadsheet"], ["targetable_model", "DummyChild"], ["updated_at", "2014-11-15 00:09:03.496820"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to /referring/url
Completed 302 Found in 3ms (ActiveRecord: 0.4ms)
  [1m[36mButtafly::Mapping Load (0.2ms)[0m  [1mSELECT  "buttafly_mappings".* FROM "buttafly_mappings"  WHERE "buttafly_mappings"."originable_id" = $1 AND "buttafly_mappings"."originable_type" = $2  ORDER BY "buttafly_mappings"."id" ASC LIMIT 1[0m  [["originable_id", 10], ["originable_type", "Buttafly::Spreadsheet"]]
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
-------------------------------------------------------------
Buttafly::MappingsController: test_0002_must 'DELETE' destroy
-------------------------------------------------------------
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mButtafly::Spreadsheet Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM "buttafly_spreadsheets"  WHERE "buttafly_spreadsheets"."name" = 'test_file_name12' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "buttafly_spreadsheets" ("aasm_state", "created_at", "data", "flat_file", "name", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["aasm_state", "not_imported"], ["created_at", "2014-11-15 00:09:03.503046"], ["data", "{}"], ["flat_file", "family.odt.csv"], ["name", "test_file_name12"], ["updated_at", "2014-11-15 00:09:03.503046"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "buttafly_mappings" ("created_at", "originable_id", "originable_type", "targetable_model", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["created_at", "2014-11-15 00:09:03.506027"], ["originable_id", 11], ["originable_type", "Buttafly::Spreadsheet"], ["targetable_model", "DummyChild"], ["updated_at", "2014-11-15 00:09:03.506027"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.2ms)[0m  [1mSELECT COUNT(*) FROM "buttafly_mappings"[0m
Processing by Buttafly::MappingsController#destroy as HTML
  Parameters: {"id"=>"5"}
  [1m[35mButtafly::Mapping Load (0.2ms)[0m  SELECT  "buttafly_mappings".* FROM "buttafly_mappings"  WHERE "buttafly_mappings"."id" = $1 LIMIT 1  [["id", 5]]
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  DELETE FROM "buttafly_mappings" WHERE "buttafly_mappings"."id" = $1  [["id", 5]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to /referring/url
Completed 302 Found in 2ms (ActiveRecord: 0.5ms)
  [1m[35m (0.1ms)[0m  SELECT COUNT(*) FROM "buttafly_mappings"
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
  [1m[36m (0.0ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.0ms)[0m  BEGIN
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "dummy_tribes" ("created_at", "name", "updated_at") VALUES ($1, $2, $3) RETURNING "id"  [["created_at", "2014-11-15 00:09:03.513736"], ["name", "MyString"], ["updated_at", "2014-11-15 00:09:03.513736"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "dummy_grandparents" ("created_at", "dummy_tribe_id", "name", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["created_at", "2014-11-15 00:09:03.515018"], ["dummy_tribe_id", 10], ["name", "Vicki Pacurar"], ["updated_at", "2014-11-15 00:09:03.515018"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "dummy_tribes" ("created_at", "name", "updated_at") VALUES ($1, $2, $3) RETURNING "id"  [["created_at", "2014-11-15 00:09:03.516248"], ["name", "MyString"], ["updated_at", "2014-11-15 00:09:03.516248"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "dummy_parents" ("created_at", "dummy_grandparent_id", "dummy_tribe_id", "name", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["created_at", "2014-11-15 00:09:03.517407"], ["dummy_grandparent_id", 4], ["dummy_tribe_id", 11], ["name", "Sarah Jane Schoeneman"], ["updated_at", "2014-11-15 00:09:03.517407"]]
  [1m[35m (0.0ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.0ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "dummy_tribes" ("created_at", "name", "updated_at") VALUES ($1, $2, $3) RETURNING "id"  [["created_at", "2014-11-15 00:09:03.518657"], ["name", "MyString"], ["updated_at", "2014-11-15 00:09:03.518657"]]
  [1m[36m (0.0ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
  [1m[35m (0.0ms)[0m  COMMIT
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mButtafly::Spreadsheet Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM "buttafly_spreadsheets"  WHERE "buttafly_spreadsheets"."name" = 'test_file_name13' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "buttafly_spreadsheets" ("aasm_state", "created_at", "data", "flat_file", "name", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["aasm_state", "not_imported"], ["created_at", "2014-11-15 00:09:03.523362"], ["data", "{}"], ["flat_file", "family.odt.csv"], ["name", "test_file_name13"], ["updated_at", "2014-11-15 00:09:03.523362"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  COMMIT
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  COMMIT
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "dummy_tribes" ("created_at", "name", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["created_at", "2014-11-15 00:09:03.528208"], ["name", "MyString"], ["updated_at", "2014-11-15 00:09:03.528208"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.0ms)[0m  BEGIN
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
  [1m[36m (0.0ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.0ms)[0m  BEGIN
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
  [1m[36m (0.0ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.0ms)[0m  BEGIN
  [1m[36mButtafly::Spreadsheet Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "buttafly_spreadsheets"  WHERE "buttafly_spreadsheets"."name" = 'test_file_name14' LIMIT 1[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  COMMIT
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO "dummy_tribes" ("created_at", "name", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["created_at", "2014-11-15 00:09:03.536824"], ["name", "MyString"], ["updated_at", "2014-11-15 00:09:03.536824"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.0ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.2ms)[0m  BEGIN
  [1m[36m (0.2ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mButtafly::Spreadsheet Exists (0.6ms)[0m  SELECT  1 AS one FROM "buttafly_spreadsheets"  WHERE "buttafly_spreadsheets"."name" = 'test_file_name15' LIMIT 1
  [1m[36mSQL (0.4ms)[0m  [1mINSERT INTO "buttafly_spreadsheets" ("aasm_state", "created_at", "data", "flat_file", "name", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["aasm_state", "imported"], ["created_at", "2014-11-15 00:09:03.554380"], ["data", "[{\"mother\":\"Sarah Jane Schoeneman\",\"child\":\"Ella Mac Pacurar\",\"grandparent\":\"Vicki Pacurar\"}]"], ["flat_file", "family.odt.csv"], ["name", "test_file_name15"], ["updated_at", "2014-11-15 00:09:03.554380"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36mButtafly::Spreadsheet Load (0.1ms)[0m  [1mSELECT  "buttafly_spreadsheets".* FROM "buttafly_spreadsheets"  WHERE "buttafly_spreadsheets"."id" = $1 LIMIT 1[0m  [["id", 13]]
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  COMMIT
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
-----------------------------------------------
create content Feature Test: test_0001_success 
-----------------------------------------------
Started GET "/buttafly/contents" for 127.0.0.1 at 2014-11-14 16:09:03 -0800
Processing by Buttafly::ContentsController#index as HTML
  Rendered /home/fred/work/opensource/buttafly/app/views/buttafly/contents/_form.html.haml (1.6ms)
  [1m[35mButtafly::Spreadsheet Load (0.3ms)[0m  SELECT  "buttafly_spreadsheets".* FROM "buttafly_spreadsheets"   ORDER BY "buttafly_spreadsheets"."created_at" ASC LIMIT 5 OFFSET 0
  [1m[36m (0.1ms)[0m  [1mSELECT COUNT(*) FROM "buttafly_spreadsheets"[0m
  Rendered application/_messages.html.haml (0.2ms)
Completed 200 OK in 6ms (Views: 4.9ms | ActiveRecord: 0.4ms)
Started POST "/buttafly/contents" for 127.0.0.1 at 2014-11-14 16:09:03 -0800
Processing by Buttafly::ContentsController#create as HTML
  Parameters: {"utf8"=>"âœ“", "originable"=>{"name"=>"pinot noirs", "flat_file"=>#<ActionDispatch::Http::UploadedFile:0x007fcff2598480 @tempfile=#<Tempfile:/tmp/RackMultipart20141114-4469-mbvwsv>, @original_filename="family.odt.csv", @content_type="text/comma-separated-values", @headers="Content-Disposition: form-data; name=\"originable[flat_file]\"; filename=\"family.odt.csv\"\r\nContent-Type: text/comma-separated-values\r\nContent-Length: 117\r\n">}, "commit"=>"Upload file"}
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mButtafly::Spreadsheet Exists (0.4ms)[0m  [1mSELECT  1 AS one FROM "buttafly_spreadsheets"  WHERE "buttafly_spreadsheets"."name" = 'pinot noirs' LIMIT 1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO "buttafly_spreadsheets" ("aasm_state", "created_at", "flat_file", "name", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["aasm_state", "not_imported"], ["created_at", "2014-11-15 00:09:03.578873"], ["flat_file", "family.odt.csv"], ["name", "pinot noirs"], ["updated_at", "2014-11-15 00:09:03.578873"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/buttafly/contents
Completed 302 Found in 6ms (ActiveRecord: 0.8ms)
Started GET "/buttafly/contents" for 127.0.0.1 at 2014-11-14 16:09:03 -0800
Processing by Buttafly::ContentsController#index as HTML
  Rendered /home/fred/work/opensource/buttafly/app/views/buttafly/contents/_form.html.haml (1.5ms)
  [1m[35mButtafly::Spreadsheet Load (0.3ms)[0m  SELECT  "buttafly_spreadsheets".* FROM "buttafly_spreadsheets"   ORDER BY "buttafly_spreadsheets"."created_at" ASC LIMIT 5 OFFSET 0
  [1m[36mButtafly::Mapping Load (0.2ms)[0m  [1mSELECT "buttafly_mappings".* FROM "buttafly_mappings"  WHERE "buttafly_mappings"."originable_id" = $1 AND "buttafly_mappings"."originable_type" = $2[0m  [["originable_id", 14], ["originable_type", "Buttafly::Spreadsheet"]]
  [1m[35mButtafly::Legend Load (0.1ms)[0m  SELECT "buttafly_legends".* FROM "buttafly_legends"
  Rendered /home/fred/work/opensource/buttafly/app/views/buttafly/contents/_content.html.haml (3.4ms)
  [1m[36m (0.2ms)[0m  [1mSELECT COUNT(*) FROM "buttafly_spreadsheets"[0m
  Rendered application/_messages.html.haml (0.4ms)
Completed 200 OK in 10ms (Views: 7.8ms | ActiveRecord: 0.8ms)
  [1m[35m (0.3ms)[0m  SELECT COUNT(*) FROM "buttafly_spreadsheets"  WHERE "buttafly_spreadsheets"."name" = 'pinot noirs'
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
-----------------------------------------------------------
create content Feature Test: test_0002_fail renders message
-----------------------------------------------------------
Started GET "/buttafly/contents" for 127.0.0.1 at 2014-11-14 16:09:03 -0800
Processing by Buttafly::ContentsController#index as HTML
  Rendered /home/fred/work/opensource/buttafly/app/views/buttafly/contents/_form.html.haml (1.2ms)
  [1m[36mButtafly::Spreadsheet Load (0.3ms)[0m  [1mSELECT  "buttafly_spreadsheets".* FROM "buttafly_spreadsheets"   ORDER BY "buttafly_spreadsheets"."created_at" ASC LIMIT 5 OFFSET 0[0m
  [1m[35m (0.2ms)[0m  SELECT COUNT(*) FROM "buttafly_spreadsheets"
  Rendered application/_messages.html.haml (0.2ms)
Completed 200 OK in 6ms (Views: 3.9ms | ActiveRecord: 0.5ms)
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mButtafly::Spreadsheet Exists (0.4ms)[0m  SELECT  1 AS one FROM "buttafly_spreadsheets"  WHERE "buttafly_spreadsheets"."name" = 'test_file_name16' LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "buttafly_spreadsheets" ("aasm_state", "created_at", "data", "flat_file", "name", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["aasm_state", "not_imported"], ["created_at", "2014-11-15 00:09:03.610258"], ["data", "[{\"mother\":\"Sarah Jane Schoeneman\",\"child\":\"Ella Mac Pacurar\",\"grandparent\":\"Vicki Pacurar\"}]"], ["flat_file", "family.odt.csv"], ["name", "test_file_name16"], ["updated_at", "2014-11-15 00:09:03.610258"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Started POST "/buttafly/contents" for 127.0.0.1 at 2014-11-14 16:09:03 -0800
Processing by Buttafly::ContentsController#create as HTML
  Parameters: {"utf8"=>"âœ“", "originable"=>{"name"=>"test_file_name16", "flat_file"=>#<ActionDispatch::Http::UploadedFile:0x007fcff26b9710 @tempfile=#<Tempfile:/tmp/RackMultipart20141114-4469-wm7wbh>, @original_filename="family.odt.csv", @content_type="text/comma-separated-values", @headers="Content-Disposition: form-data; name=\"originable[flat_file]\"; filename=\"family.odt.csv\"\r\nContent-Type: text/comma-separated-values\r\nContent-Length: 117\r\n">}, "commit"=>"Upload file"}
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mButtafly::Spreadsheet Exists (0.3ms)[0m  SELECT  1 AS one FROM "buttafly_spreadsheets"  WHERE "buttafly_spreadsheets"."name" = 'test_file_name16' LIMIT 1
  [1m[36m (0.1ms)[0m  [1mROLLBACK TO SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/buttafly/
Completed 302 Found in 4ms (ActiveRecord: 0.6ms)
Started GET "/buttafly/" for 127.0.0.1 at 2014-11-14 16:09:03 -0800
Processing by Buttafly::ContentsController#index as HTML
  Rendered /home/fred/work/opensource/buttafly/app/views/buttafly/contents/_form.html.haml (1.2ms)
  [1m[35mButtafly::Spreadsheet Load (0.3ms)[0m  SELECT  "buttafly_spreadsheets".* FROM "buttafly_spreadsheets"   ORDER BY "buttafly_spreadsheets"."created_at" ASC LIMIT 5 OFFSET 0
  [1m[36mButtafly::Mapping Load (0.3ms)[0m  [1mSELECT "buttafly_mappings".* FROM "buttafly_mappings"  WHERE "buttafly_mappings"."originable_id" = $1 AND "buttafly_mappings"."originable_type" = $2[0m  [["originable_id", 15], ["originable_type", "Buttafly::Spreadsheet"]]
  [1m[35mButtafly::Legend Load (0.2ms)[0m  SELECT "buttafly_legends".* FROM "buttafly_legends"
  Rendered /home/fred/work/opensource/buttafly/app/views/buttafly/contents/_content.html.haml (3.9ms)
  [1m[36m (0.3ms)[0m  [1mSELECT COUNT(*) FROM "buttafly_spreadsheets"[0m
  Rendered application/_messages.html.haml (0.4ms)
Completed 200 OK in 10ms (Views: 8.1ms | ActiveRecord: 1.0ms)
  [1m[35m (0.3ms)[0m  SELECT COUNT(*) FROM "buttafly_spreadsheets"  WHERE "buttafly_spreadsheets"."name" = 'pinot noirs'
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mButtafly::Spreadsheet Exists (0.4ms)[0m  SELECT  1 AS one FROM "buttafly_spreadsheets"  WHERE "buttafly_spreadsheets"."name" = 'test_file_name17' LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "buttafly_spreadsheets" ("aasm_state", "created_at", "data", "flat_file", "name", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["aasm_state", "not_imported"], ["created_at", "2014-11-15 00:09:03.638299"], ["data", "{}"], ["flat_file", "family.odt.csv"], ["name", "test_file_name17"], ["updated_at", "2014-11-15 00:09:03.638299"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mButtafly::Spreadsheet Exists (0.3ms)[0m  SELECT  1 AS one FROM "buttafly_spreadsheets"  WHERE ("buttafly_spreadsheets"."name" = 'test_file_name17' AND "buttafly_spreadsheets"."id" != 16) LIMIT 1
  [1m[36mSQL (0.3ms)[0m  [1mUPDATE "buttafly_spreadsheets" SET "data" = $1, "imported_at" = $2, "updated_at" = $3 WHERE "buttafly_spreadsheets"."id" = 16[0m  [["data", "[{\"child name\":\"ella mac\",\"parent name\":\"sara\",\"grandparent name\":\"kc shekhar\",\"tribe name\":\"india\",\"age\":\"2.5\"},{\"child name\":\"rohan\",\"parent name\":\"doug\",\"grandparent name\":\"vicki\",\"tribe name\":\"america\",\"age\":\"6\"}]"], ["imported_at", "2014-11-15 00:09:03.640076"], ["updated_at", "2014-11-15 00:09:03.641819"]]
  [1m[35mButtafly::Spreadsheet Exists (0.2ms)[0m  SELECT  1 AS one FROM "buttafly_spreadsheets"  WHERE ("buttafly_spreadsheets"."name" = 'test_file_name17' AND "buttafly_spreadsheets"."id" != 16) LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mUPDATE "buttafly_spreadsheets" SET "aasm_state" = $1, "updated_at" = $2 WHERE "buttafly_spreadsheets"."id" = 16[0m  [["aasm_state", "imported"], ["updated_at", "2014-11-15 00:09:03.644391"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mButtafly::Spreadsheet Exists (0.2ms)[0m  SELECT  1 AS one FROM "buttafly_spreadsheets"  WHERE "buttafly_spreadsheets"."name" = 'test_file_name18' LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "buttafly_spreadsheets" ("aasm_state", "created_at", "data", "flat_file", "name", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["aasm_state", "not_imported"], ["created_at", "2014-11-15 00:09:03.648983"], ["data", "{}"], ["flat_file", "family.odt.csv"], ["name", "test_file_name18"], ["updated_at", "2014-11-15 00:09:03.648983"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mButtafly::Spreadsheet Exists (0.2ms)[0m  SELECT  1 AS one FROM "buttafly_spreadsheets"  WHERE ("buttafly_spreadsheets"."name" = 'test_file_name18' AND "buttafly_spreadsheets"."id" != 17) LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mUPDATE "buttafly_spreadsheets" SET "data" = $1, "updated_at" = $2 WHERE "buttafly_spreadsheets"."id" = 17[0m  [["data", "[{\"child name\":\"ella mac\",\"parent name\":\"sara\",\"grandparent name\":\"kc shekhar\",\"tribe name\":\"india\",\"age\":\"2.5\"},{\"child name\":\"rohan\",\"parent name\":\"doug\",\"grandparent name\":\"vicki\",\"tribe name\":\"america\",\"age\":\"6\"}]"], ["updated_at", "2014-11-15 00:09:03.652210"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
---------------------------------------------
create legend Feature Test: test_0001_success
---------------------------------------------
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mButtafly::Spreadsheet Exists (0.3ms)[0m  SELECT  1 AS one FROM "buttafly_spreadsheets"  WHERE "buttafly_spreadsheets"."name" = 'test_file_name19' LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "buttafly_spreadsheets" ("aasm_state", "created_at", "data", "flat_file", "name", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["aasm_state", "not_imported"], ["created_at", "2014-11-15 00:09:03.657436"], ["data", "{}"], ["flat_file", "family.odt.csv"], ["name", "test_file_name19"], ["updated_at", "2014-11-15 00:09:03.657436"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "buttafly_mappings" ("created_at", "originable_id", "originable_type", "targetable_model", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["created_at", "2014-11-15 00:09:03.659906"], ["originable_id", 18], ["originable_type", "Buttafly::Spreadsheet"], ["targetable_model", "DummyChild"], ["updated_at", "2014-11-15 00:09:03.659906"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Started GET "/buttafly/contents" for 127.0.0.1 at 2014-11-14 16:09:03 -0800
Processing by Buttafly::ContentsController#index as HTML
  Rendered /home/fred/work/opensource/buttafly/app/views/buttafly/contents/_form.html.haml (1.3ms)
  [1m[35mButtafly::Spreadsheet Load (0.3ms)[0m  SELECT  "buttafly_spreadsheets".* FROM "buttafly_spreadsheets"   ORDER BY "buttafly_spreadsheets"."created_at" ASC LIMIT 5 OFFSET 0
  [1m[36mButtafly::Mapping Load (0.2ms)[0m  [1mSELECT "buttafly_mappings".* FROM "buttafly_mappings"  WHERE "buttafly_mappings"."originable_id" = $1 AND "buttafly_mappings"."originable_type" = $2[0m  [["originable_id", 18], ["originable_type", "Buttafly::Spreadsheet"]]
  [1m[35mButtafly::Legend Load (0.1ms)[0m  SELECT "buttafly_legends".* FROM "buttafly_legends"
  Rendered /home/fred/work/opensource/buttafly/app/views/buttafly/contents/_content.html.haml (3.7ms)
  [1m[36m (0.2ms)[0m  [1mSELECT COUNT(*) FROM "buttafly_spreadsheets"[0m
  Rendered application/_messages.html.haml (0.2ms)
Completed 200 OK in 10ms (Views: 7.8ms | ActiveRecord: 0.9ms)
Started GET "/buttafly/legends/new?mapping_id=6" for 127.0.0.1 at 2014-11-14 16:09:03 -0800
Processing by Buttafly::LegendsController#new as HTML
  Parameters: {"mapping_id"=>"6"}
  [1m[35mButtafly::Mapping Load (0.3ms)[0m  SELECT  "buttafly_mappings".* FROM "buttafly_mappings"  WHERE "buttafly_mappings"."id" = $1 LIMIT 1  [["id", 6]]
  [1m[36mButtafly::Spreadsheet Load (0.1ms)[0m  [1mSELECT  "buttafly_spreadsheets".* FROM "buttafly_spreadsheets"  WHERE "buttafly_spreadsheets"."id" = $1 LIMIT 1[0m  [["id", 18]]
  Rendered application/_messages.html.haml (0.2ms)
Completed 200 OK in 8ms (Views: 5.0ms | ActiveRecord: 0.4ms)
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  COMMIT
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mButtafly::Spreadsheet Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "buttafly_spreadsheets"  WHERE "buttafly_spreadsheets"."name" = 'test_file_name20' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "buttafly_spreadsheets" ("aasm_state", "created_at", "data", "flat_file", "name", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["aasm_state", "not_imported"], ["created_at", "2014-11-15 00:09:03.688786"], ["data", "{}"], ["flat_file", "family.odt.csv"], ["name", "test_file_name20"], ["updated_at", "2014-11-15 00:09:03.688786"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "buttafly_mappings" ("created_at", "originable_id", "originable_type", "targetable_model", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["created_at", "2014-11-15 00:09:03.691155"], ["originable_id", 19], ["originable_type", "Buttafly::Spreadsheet"], ["targetable_model", "DummyChild"], ["updated_at", "2014-11-15 00:09:03.691155"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  ROLLBACK TO SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.0ms)[0m  BEGIN
  [1m[36mButtafly::Spreadsheet Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "buttafly_spreadsheets"  WHERE "buttafly_spreadsheets"."name" = 'test_file_name21' LIMIT 1[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  COMMIT
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
  [1m[35mButtafly::Spreadsheet Exists (0.2ms)[0m  SELECT  1 AS one FROM "buttafly_spreadsheets"  WHERE "buttafly_spreadsheets"."name" = 'test_file_name22' LIMIT 1
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.0ms)[0m  BEGIN
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.0ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.0ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.0ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.0ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.0ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.0ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.0ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.0ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "dummy_tribes" ("created_at", "name", "updated_at") VALUES ($1, $2, $3) RETURNING "id"  [["created_at", "2014-11-15 00:09:03.707845"], ["name", "MyString"], ["updated_at", "2014-11-15 00:09:03.707845"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "dummy_grandparents" ("created_at", "dummy_tribe_id", "name", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["created_at", "2014-11-15 00:09:03.709156"], ["dummy_tribe_id", 15], ["name", "Vicki Pacurar"], ["updated_at", "2014-11-15 00:09:03.709156"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "dummy_tribes" ("created_at", "name", "updated_at") VALUES ($1, $2, $3) RETURNING "id"  [["created_at", "2014-11-15 00:09:03.710443"], ["name", "MyString"], ["updated_at", "2014-11-15 00:09:03.710443"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "dummy_parents" ("created_at", "dummy_grandparent_id", "dummy_tribe_id", "name", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["created_at", "2014-11-15 00:09:03.711530"], ["dummy_grandparent_id", 5], ["dummy_tribe_id", 16], ["name", "Sarah Jane Schoeneman"], ["updated_at", "2014-11-15 00:09:03.711530"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "dummy_tribes" ("created_at", "name", "updated_at") VALUES ($1, $2, $3) RETURNING "id"  [["created_at", "2014-11-15 00:09:03.712732"], ["name", "MyString"], ["updated_at", "2014-11-15 00:09:03.712732"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  COMMIT
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mButtafly::Spreadsheet Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM "buttafly_spreadsheets"  WHERE "buttafly_spreadsheets"."name" = 'test_file_name26' LIMIT 1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO "buttafly_spreadsheets" ("aasm_state", "created_at", "data", "flat_file", "name", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["aasm_state", "not_imported"], ["created_at", "2014-11-15 00:09:03.717333"], ["data", "{}"], ["flat_file", "family.odt.csv"], ["name", "test_file_name26"], ["updated_at", "2014-11-15 00:09:03.717333"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "buttafly_mappings" ("created_at", "originable_id", "originable_type", "targetable_model", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["created_at", "2014-11-15 00:09:03.720104"], ["originable_id", 20], ["originable_type", "Buttafly::Spreadsheet"], ["targetable_model", "DummyChild"], ["updated_at", "2014-11-15 00:09:03.720104"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  UPDATE "buttafly_mappings" SET "targetable_model" = $1, "updated_at" = $2 WHERE "buttafly_mappings"."id" = 8  [["targetable_model", "DummyParent"], ["updated_at", "2014-11-15 00:09:03.721751"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  COMMIT
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.0ms)[0m  COMMIT
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.0ms)[0m  COMMIT
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.0ms)[0m  COMMIT
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.0ms)[0m  COMMIT
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mButtafly::Spreadsheet Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM "buttafly_spreadsheets"  WHERE "buttafly_spreadsheets"."name" = 'test_file_name27' LIMIT 1[0m
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "buttafly_spreadsheets" ("aasm_state", "created_at", "data", "flat_file", "name", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["aasm_state", "not_imported"], ["created_at", "2014-11-15 00:09:03.731595"], ["data", "{}"], ["flat_file", "family.odt.csv"], ["name", "test_file_name27"], ["updated_at", "2014-11-15 00:09:03.731595"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "buttafly_mappings" ("created_at", "originable_id", "originable_type", "targetable_model", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["created_at", "2014-11-15 00:09:03.733570"], ["originable_id", 21], ["originable_type", "Buttafly::Spreadsheet"], ["targetable_model", "DummyChild"], ["updated_at", "2014-11-15 00:09:03.733570"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.3ms)[0m  [1mSELECT "schema_migrations".* FROM "schema_migrations"[0m
  [1m[35m (0.2ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
-------------------------
RoutesTest: test_messages
-------------------------
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
-----------------------------
ButtaflyTest: test_0001_truth
-----------------------------
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
  [1m[36m (0.0ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.0ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.0ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.0ms)[0m  BEGIN
  [1m[36m (0.2ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.0ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.0ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.0ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.0ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.0ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.0ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.0ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.0ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.0ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.0ms)[0m  BEGIN
  [1m[36mButtafly::Spreadsheet Exists (0.7ms)[0m  [1mSELECT  1 AS one FROM "buttafly_spreadsheets"  WHERE "buttafly_spreadsheets"."name" = 'test_file_name4' LIMIT 1[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
-------------------------------------------------------------------------
Buttafly::ContentsController: test_0001_get #show must assign @originable
-------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mButtafly::Spreadsheet Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "buttafly_spreadsheets"  WHERE "buttafly_spreadsheets"."name" = 'test_file_name5' LIMIT 1[0m
  [1m[35mSQL (0.7ms)[0m  INSERT INTO "buttafly_spreadsheets" ("aasm_state", "created_at", "data", "flat_file", "name", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["aasm_state", "not_imported"], ["created_at", "2014-11-15 00:09:14.807656"], ["data", "{}"], ["flat_file", "family.odt.csv"], ["name", "test_file_name5"], ["updated_at", "2014-11-15 00:09:14.807656"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by Buttafly::ContentsController#show as HTML
  Parameters: {"id"=>"22"}
  [1m[35mButtafly::Spreadsheet Load (0.3ms)[0m  SELECT  "buttafly_spreadsheets".* FROM "buttafly_spreadsheets"  WHERE "buttafly_spreadsheets"."id" = $1 LIMIT 1  [["id", 22]]
  Rendered application/_messages.html.haml (1.2ms)
Completed 200 OK in 37ms (Views: 35.4ms | ActiveRecord: 0.3ms)
  [1m[36m (0.2ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
-------------------------------------------------
Buttafly::ContentsController: test_0002_get #edit
-------------------------------------------------
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mButtafly::Spreadsheet Exists (0.3ms)[0m  SELECT  1 AS one FROM "buttafly_spreadsheets"  WHERE "buttafly_spreadsheets"."name" = 'test_file_name6' LIMIT 1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO "buttafly_spreadsheets" ("aasm_state", "created_at", "data", "flat_file", "name", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["aasm_state", "not_imported"], ["created_at", "2014-11-15 00:09:14.855906"], ["data", "{}"], ["flat_file", "family.odt.csv"], ["name", "test_file_name6"], ["updated_at", "2014-11-15 00:09:14.855906"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by Buttafly::ContentsController#edit as HTML
  Parameters: {"id"=>"23"}
  [1m[36mButtafly::Spreadsheet Load (0.3ms)[0m  [1mSELECT  "buttafly_spreadsheets".* FROM "buttafly_spreadsheets"  WHERE "buttafly_spreadsheets"."id" = $1 LIMIT 1[0m  [["id", 23]]
  Rendered /home/fred/work/opensource/buttafly/app/views/buttafly/contents/_form.html.haml (11.0ms)
  Rendered application/_messages.html.haml (0.1ms)
Completed 200 OK in 18ms (Views: 16.8ms | ActiveRecord: 0.3ms)
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
----------------------------------------------------
Buttafly::ContentsController: test_0003_post #create
----------------------------------------------------
Processing by Buttafly::ContentsController#create as HTML
  Parameters: {"originable"=>{"name"=>"slick name", "flat_file"=>"slickname.csv"}}
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mButtafly::Spreadsheet Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "buttafly_spreadsheets"  WHERE "buttafly_spreadsheets"."name" = 'slick name' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "buttafly_spreadsheets" ("aasm_state", "created_at", "flat_file", "name", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["aasm_state", "not_imported"], ["created_at", "2014-11-15 00:09:14.881696"], ["flat_file", nil], ["name", "slick name"], ["updated_at", "2014-11-15 00:09:14.881696"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://test.host/buttafly/contents
Completed 302 Found in 4ms (ActiveRecord: 0.7ms)
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
-------------------------------------------------------------------------
Buttafly::ContentsController: test_0004_patch #import saves a spreadsheet
-------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mButtafly::Spreadsheet Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "buttafly_spreadsheets"  WHERE "buttafly_spreadsheets"."name" = 'test_file_name7' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "buttafly_spreadsheets" ("aasm_state", "created_at", "data", "flat_file", "name", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["aasm_state", "not_imported"], ["created_at", "2014-11-15 00:09:14.887465"], ["data", "{}"], ["flat_file", "family.odt.csv"], ["name", "test_file_name7"], ["updated_at", "2014-11-15 00:09:14.887465"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by Buttafly::ContentsController#import as HTML
  Parameters: {"originable_type"=>"Buttafly::Spreadsheet", "id"=>"25"}
  [1m[35mButtafly::Spreadsheet Load (0.3ms)[0m  SELECT  "buttafly_spreadsheets".* FROM "buttafly_spreadsheets"  WHERE "buttafly_spreadsheets"."id" = $1 LIMIT 1  [["id", 25]]
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mButtafly::Spreadsheet Exists (0.5ms)[0m  SELECT  1 AS one FROM "buttafly_spreadsheets"  WHERE ("buttafly_spreadsheets"."name" = 'test_file_name7' AND "buttafly_spreadsheets"."id" != 25) LIMIT 1
  [1m[36mSQL (0.3ms)[0m  [1mUPDATE "buttafly_spreadsheets" SET "data" = $1, "imported_at" = $2, "updated_at" = $3 WHERE "buttafly_spreadsheets"."id" = 25[0m  [["data", "[{\"child name\":\"ella mac\",\"parent name\":\"sara\",\"grandparent name\":\"kc shekhar\",\"tribe name\":\"india\",\"age\":\"2.5\"},{\"child name\":\"rohan\",\"parent name\":\"doug\",\"grandparent name\":\"vicki\",\"tribe name\":\"america\",\"age\":\"6\"}]"], ["imported_at", "2014-11-15 00:09:14.892119"], ["updated_at", "2014-11-15 00:09:14.895206"]]
  [1m[35mButtafly::Spreadsheet Exists (0.2ms)[0m  SELECT  1 AS one FROM "buttafly_spreadsheets"  WHERE ("buttafly_spreadsheets"."name" = 'test_file_name7' AND "buttafly_spreadsheets"."id" != 25) LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mUPDATE "buttafly_spreadsheets" SET "aasm_state" = $1, "updated_at" = $2 WHERE "buttafly_spreadsheets"."id" = 25[0m  [["aasm_state", "imported"], ["updated_at", "2014-11-15 00:09:14.898809"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to /referring/url
Completed 302 Found in 9ms (ActiveRecord: 1.7ms)
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
------------------------------------------------------------------------
Buttafly::ContentsController: test_0005_post #create saves a spreadsheet
------------------------------------------------------------------------
  [1m[36m (0.2ms)[0m  [1mSELECT COUNT(*) FROM "buttafly_spreadsheets"[0m
Processing by Buttafly::ContentsController#create as HTML
  Parameters: {"originable"=>{"name"=>"sweeet name", "flat_file"=>"summer.csv"}}
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mButtafly::Spreadsheet Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM "buttafly_spreadsheets"  WHERE "buttafly_spreadsheets"."name" = 'sweeet name' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "buttafly_spreadsheets" ("aasm_state", "created_at", "flat_file", "name", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["aasm_state", "not_imported"], ["created_at", "2014-11-15 00:09:14.904618"], ["flat_file", nil], ["name", "sweeet name"], ["updated_at", "2014-11-15 00:09:14.904618"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://test.host/buttafly/contents
Completed 302 Found in 3ms (ActiveRecord: 0.7ms)
  [1m[35m (0.2ms)[0m  SELECT COUNT(*) FROM "buttafly_spreadsheets"
  [1m[36m (0.2ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
--------------------------------------------------------
Buttafly::ContentsController: test_0006_should get index
--------------------------------------------------------
Processing by Buttafly::ContentsController#index as HTML
  Rendered /home/fred/work/opensource/buttafly/app/views/buttafly/contents/_form.html.haml (1.3ms)
  [1m[36mButtafly::Spreadsheet Load (0.5ms)[0m  [1mSELECT  "buttafly_spreadsheets".* FROM "buttafly_spreadsheets"   ORDER BY "buttafly_spreadsheets"."created_at" ASC LIMIT 5 OFFSET 0[0m
  [1m[35m (0.2ms)[0m  SELECT COUNT(*) FROM "buttafly_spreadsheets"
  Rendered application/_messages.html.haml (0.1ms)
Completed 200 OK in 15ms (Views: 9.4ms | ActiveRecord: 2.5ms)
  [1m[36m (0.2ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
  [1m[36m (0.0ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.0ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.0ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "dummy_tribes" ("created_at", "name", "updated_at") VALUES ($1, $2, $3) RETURNING "id"  [["created_at", "2014-11-15 00:09:14.932007"], ["name", "MyString"], ["updated_at", "2014-11-15 00:09:14.932007"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  COMMIT
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "dummy_tribes" ("created_at", "name", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["created_at", "2014-11-15 00:09:14.941878"], ["name", "MyString"], ["updated_at", "2014-11-15 00:09:14.941878"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.0ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
-----------------------------------------------------------------------------
Buttafly::LegendsController::POST #create: test_0001_must create a new legend
-----------------------------------------------------------------------------
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.0ms)[0m  BEGIN
  [1m[36mButtafly::Spreadsheet Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "buttafly_spreadsheets"  WHERE "buttafly_spreadsheets"."name" = 'test_file_name8' LIMIT 1[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
---------------------------------------------------------
Buttafly::MappingsController: test_0001_must POST #create
---------------------------------------------------------
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mButtafly::Spreadsheet Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "buttafly_spreadsheets"  WHERE "buttafly_spreadsheets"."name" = 'test_file_name9' LIMIT 1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO "buttafly_spreadsheets" ("aasm_state", "created_at", "data", "flat_file", "name", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["aasm_state", "not_imported"], ["created_at", "2014-11-15 00:09:14.961434"], ["data", "[{\"mother\":\"Sarah Jane Schoeneman\",\"child\":\"Ella Mac Pacurar\",\"grandparent\":\"Vicki Pacurar\"}]"], ["flat_file", "family.odt.csv"], ["name", "test_file_name9"], ["updated_at", "2014-11-15 00:09:14.961434"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by Buttafly::MappingsController#create as HTML
  Parameters: {"mapping"=>{"originable_id"=>"27", "targetable_model"=>"DummyChild"}}
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mButtafly::Spreadsheet Load (0.2ms)[0m  [1mSELECT  "buttafly_spreadsheets".* FROM "buttafly_spreadsheets"  WHERE "buttafly_spreadsheets"."id" = $1 LIMIT 1[0m  [["id", 27]]
  [1m[35mSQL (0.3ms)[0m  INSERT INTO "buttafly_mappings" ("created_at", "originable_id", "originable_type", "targetable_model", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["created_at", "2014-11-15 00:09:14.973504"], ["originable_id", 27], ["originable_type", "Buttafly::Spreadsheet"], ["targetable_model", "DummyChild"], ["updated_at", "2014-11-15 00:09:14.973504"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to /referring/url
Completed 302 Found in 10ms (ActiveRecord: 0.7ms)
  [1m[35mButtafly::Mapping Load (0.3ms)[0m  SELECT  "buttafly_mappings".* FROM "buttafly_mappings"  WHERE "buttafly_mappings"."originable_id" = $1 AND "buttafly_mappings"."originable_type" = $2  ORDER BY "buttafly_mappings"."id" ASC LIMIT 1  [["originable_id", 27], ["originable_type", "Buttafly::Spreadsheet"]]
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
-------------------------------------------------------------
Buttafly::MappingsController: test_0002_must 'DELETE' destroy
-------------------------------------------------------------
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mButtafly::Spreadsheet Exists (0.3ms)[0m  SELECT  1 AS one FROM "buttafly_spreadsheets"  WHERE "buttafly_spreadsheets"."name" = 'test_file_name10' LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "buttafly_spreadsheets" ("aasm_state", "created_at", "data", "flat_file", "name", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["aasm_state", "not_imported"], ["created_at", "2014-11-15 00:09:14.985480"], ["data", "{}"], ["flat_file", "family.odt.csv"], ["name", "test_file_name10"], ["updated_at", "2014-11-15 00:09:14.985480"]]
  [1m[35m (0.2ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "buttafly_mappings" ("created_at", "originable_id", "originable_type", "targetable_model", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["created_at", "2014-11-15 00:09:14.988040"], ["originable_id", 28], ["originable_type", "Buttafly::Spreadsheet"], ["targetable_model", "DummyChild"], ["updated_at", "2014-11-15 00:09:14.988040"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  SELECT COUNT(*) FROM "buttafly_mappings"
Processing by Buttafly::MappingsController#destroy as HTML
  Parameters: {"id"=>"11"}
  [1m[36mButtafly::Mapping Load (0.2ms)[0m  [1mSELECT  "buttafly_mappings".* FROM "buttafly_mappings"  WHERE "buttafly_mappings"."id" = $1 LIMIT 1[0m  [["id", 11]]
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.2ms)[0m  [1mDELETE FROM "buttafly_mappings" WHERE "buttafly_mappings"."id" = $1[0m  [["id", 11]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to /referring/url
Completed 302 Found in 2ms (ActiveRecord: 0.5ms)
  [1m[36m (0.2ms)[0m  [1mSELECT COUNT(*) FROM "buttafly_mappings"[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  COMMIT
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "dummy_tribes" ("created_at", "name", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["created_at", "2014-11-15 00:09:14.998574"], ["name", "MyString"], ["updated_at", "2014-11-15 00:09:14.998574"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "dummy_grandparents" ("created_at", "dummy_tribe_id", "name", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"  [["created_at", "2014-11-15 00:09:14.999927"], ["dummy_tribe_id", 20], ["name", "Vicki Pacurar"], ["updated_at", "2014-11-15 00:09:14.999927"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "dummy_tribes" ("created_at", "name", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["created_at", "2014-11-15 00:09:15.002360"], ["name", "MyString"], ["updated_at", "2014-11-15 00:09:15.002360"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO "dummy_parents" ("created_at", "dummy_grandparent_id", "dummy_tribe_id", "name", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["created_at", "2014-11-15 00:09:15.004543"], ["dummy_grandparent_id", 6], ["dummy_tribe_id", 21], ["name", "Sarah Jane Schoeneman"], ["updated_at", "2014-11-15 00:09:15.004543"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "dummy_tribes" ("created_at", "name", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["created_at", "2014-11-15 00:09:15.006417"], ["name", "MyString"], ["updated_at", "2014-11-15 00:09:15.006417"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "dummy_children" ("created_at", "dummy_parent_id", "dummy_tribe_id", "name", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["created_at", "2014-11-15 00:09:15.007742"], ["dummy_parent_id", 5], ["dummy_tribe_id", 22], ["name", "Ella Mac"], ["updated_at", "2014-11-15 00:09:15.007742"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  COMMIT
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  COMMIT
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  COMMIT
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "dummy_tribes" ("created_at", "name", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["created_at", "2014-11-15 00:09:15.012078"], ["name", "MyString"], ["updated_at", "2014-11-15 00:09:15.012078"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "dummy_grandparents" ("created_at", "dummy_tribe_id", "name", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"  [["created_at", "2014-11-15 00:09:15.013303"], ["dummy_tribe_id", 23], ["name", "Vicki Pacurar"], ["updated_at", "2014-11-15 00:09:15.013303"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "dummy_tribes" ("created_at", "name", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["created_at", "2014-11-15 00:09:15.014533"], ["name", "MyString"], ["updated_at", "2014-11-15 00:09:15.014533"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "dummy_parents" ("created_at", "dummy_grandparent_id", "dummy_tribe_id", "name", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["created_at", "2014-11-15 00:09:15.015625"], ["dummy_grandparent_id", 7], ["dummy_tribe_id", 24], ["name", "Sarah Jane Schoeneman"], ["updated_at", "2014-11-15 00:09:15.015625"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "dummy_tribes" ("created_at", "name", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["created_at", "2014-11-15 00:09:15.016797"], ["name", "MyString"], ["updated_at", "2014-11-15 00:09:15.016797"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "dummy_children" ("created_at", "dummy_parent_id", "dummy_tribe_id", "name", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["created_at", "2014-11-15 00:09:15.017899"], ["dummy_parent_id", 6], ["dummy_tribe_id", 25], ["name", "Ella Mac"], ["updated_at", "2014-11-15 00:09:15.017899"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  COMMIT
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  COMMIT
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
  [1m[35m (0.0ms)[0m  COMMIT
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
  [1m[35m (0.0ms)[0m  COMMIT
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
  [1m[35m (0.0ms)[0m  COMMIT
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
  [1m[35m (0.0ms)[0m  COMMIT
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
  [1m[35m (0.0ms)[0m  COMMIT
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
  [1m[35m (0.0ms)[0m  COMMIT
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
  [1m[35m (0.0ms)[0m  COMMIT
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
  [1m[35m (0.0ms)[0m  COMMIT
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
----------------------------------------------
create mapping Feature Test: test_0001_success
----------------------------------------------
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mButtafly::Spreadsheet Exists (0.4ms)[0m  [1mSELECT  1 AS one FROM "buttafly_spreadsheets"  WHERE "buttafly_spreadsheets"."name" = 'test_file_name11' LIMIT 1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO "buttafly_spreadsheets" ("aasm_state", "created_at", "data", "flat_file", "name", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["aasm_state", "not_imported"], ["created_at", "2014-11-15 00:09:15.035585"], ["data", "[{\"mother\":\"Sarah Jane Schoeneman\",\"child\":\"Ella Mac Pacurar\",\"grandparent\":\"Vicki Pacurar\"}]"], ["flat_file", "family.odt.csv"], ["name", "test_file_name11"], ["updated_at", "2014-11-15 00:09:15.035585"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Started GET "/buttafly/contents" for 127.0.0.1 at 2014-11-14 16:09:15 -0800
Processing by Buttafly::ContentsController#index as HTML
  Rendered /home/fred/work/opensource/buttafly/app/views/buttafly/contents/_form.html.haml (1.3ms)
  [1m[35mButtafly::Spreadsheet Load (0.3ms)[0m  SELECT  "buttafly_spreadsheets".* FROM "buttafly_spreadsheets"   ORDER BY "buttafly_spreadsheets"."created_at" ASC LIMIT 5 OFFSET 0
  [1m[36mButtafly::Mapping Load (0.2ms)[0m  [1mSELECT "buttafly_mappings".* FROM "buttafly_mappings"  WHERE "buttafly_mappings"."originable_id" = $1 AND "buttafly_mappings"."originable_type" = $2[0m  [["originable_id", 29], ["originable_type", "Buttafly::Spreadsheet"]]
  [1m[35mButtafly::Legend Load (0.2ms)[0m  SELECT "buttafly_legends".* FROM "buttafly_legends"
  Rendered /home/fred/work/opensource/buttafly/app/views/buttafly/contents/_content.html.haml (11.2ms)
  [1m[36m (0.2ms)[0m  [1mSELECT COUNT(*) FROM "buttafly_spreadsheets"[0m
  Rendered application/_messages.html.haml (7.4ms)
Completed 200 OK in 25ms (Views: 23.3ms | ActiveRecord: 1.0ms)
  [1m[35m (0.2ms)[0m  SELECT COUNT(*) FROM "buttafly_mappings"  WHERE "buttafly_mappings"."originable_id" = $1 AND "buttafly_mappings"."originable_type" = $2  [["originable_id", 29], ["originable_type", "Buttafly::Spreadsheet"]]
Started POST "/buttafly/mappings?originable_id=29" for 127.0.0.1 at 2014-11-14 16:09:15 -0800
Processing by Buttafly::MappingsController#create as HTML
  Parameters: {"utf8"=>"âœ“", "mapping"=>{"originable_id"=>"29", "targetable_model"=>"DummyChild"}, "commit"=>"Select Target Model", "originable_id"=>"29"}
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mButtafly::Spreadsheet Load (0.2ms)[0m  SELECT  "buttafly_spreadsheets".* FROM "buttafly_spreadsheets"  WHERE "buttafly_spreadsheets"."id" = $1 LIMIT 1  [["id", 29]]
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "buttafly_mappings" ("created_at", "originable_id", "originable_type", "targetable_model", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["created_at", "2014-11-15 00:09:15.082984"], ["originable_id", 29], ["originable_type", "Buttafly::Spreadsheet"], ["targetable_model", "DummyChild"], ["updated_at", "2014-11-15 00:09:15.082984"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://www.example.com/buttafly/contents
Completed 302 Found in 3ms (ActiveRecord: 0.6ms)
Started GET "/buttafly/contents" for 127.0.0.1 at 2014-11-14 16:09:15 -0800
Processing by Buttafly::ContentsController#index as HTML
  Rendered /home/fred/work/opensource/buttafly/app/views/buttafly/contents/_form.html.haml (1.2ms)
  [1m[36mButtafly::Spreadsheet Load (0.3ms)[0m  [1mSELECT  "buttafly_spreadsheets".* FROM "buttafly_spreadsheets"   ORDER BY "buttafly_spreadsheets"."created_at" ASC LIMIT 5 OFFSET 0[0m
  [1m[35mButtafly::Mapping Load (0.2ms)[0m  SELECT "buttafly_mappings".* FROM "buttafly_mappings"  WHERE "buttafly_mappings"."originable_id" = $1 AND "buttafly_mappings"."originable_type" = $2  [["originable_id", 29], ["originable_type", "Buttafly::Spreadsheet"]]
  [1m[36mButtafly::Legend Load (0.2ms)[0m  [1mSELECT "buttafly_legends".* FROM "buttafly_legends"[0m
  Rendered /home/fred/work/opensource/buttafly/app/views/buttafly/contents/_content.html.haml (4.9ms)
  [1m[35m (0.4ms)[0m  SELECT COUNT(*) FROM "buttafly_spreadsheets"
  Rendered application/_messages.html.haml (0.5ms)
Completed 200 OK in 11ms (Views: 9.1ms | ActiveRecord: 1.1ms)
  [1m[36m (0.3ms)[0m  [1mSELECT COUNT(*) FROM "buttafly_mappings"  WHERE "buttafly_mappings"."originable_id" = $1 AND "buttafly_mappings"."originable_type" = $2[0m  [["originable_id", 29], ["originable_type", "Buttafly::Spreadsheet"]]
  [1m[35mButtafly::Mapping Load (0.2ms)[0m  SELECT  "buttafly_mappings".* FROM "buttafly_mappings"  WHERE "buttafly_mappings"."originable_id" = $1 AND "buttafly_mappings"."originable_type" = $2  ORDER BY "buttafly_mappings"."id" ASC LIMIT 1  [["originable_id", 29], ["originable_type", "Buttafly::Spreadsheet"]]
  [1m[36mButtafly::Spreadsheet Load (0.2ms)[0m  [1mSELECT  "buttafly_spreadsheets".* FROM "buttafly_spreadsheets"  WHERE "buttafly_spreadsheets"."id" = $1 LIMIT 1[0m  [["id", 29]]
  [1m[35m (0.2ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
-----------------------------------------------
create content Feature Test: test_0001_success 
-----------------------------------------------
Started GET "/buttafly/contents" for 127.0.0.1 at 2014-11-14 16:09:15 -0800
Processing by Buttafly::ContentsController#index as HTML
  Rendered /home/fred/work/opensource/buttafly/app/views/buttafly/contents/_form.html.haml (1.2ms)
  [1m[35mButtafly::Spreadsheet Load (0.3ms)[0m  SELECT  "buttafly_spreadsheets".* FROM "buttafly_spreadsheets"   ORDER BY "buttafly_spreadsheets"."created_at" ASC LIMIT 5 OFFSET 0
  [1m[36m (0.2ms)[0m  [1mSELECT COUNT(*) FROM "buttafly_spreadsheets"[0m
  Rendered application/_messages.html.haml (0.2ms)
Completed 200 OK in 6ms (Views: 4.1ms | ActiveRecord: 0.5ms)
Started POST "/buttafly/contents" for 127.0.0.1 at 2014-11-14 16:09:15 -0800
Processing by Buttafly::ContentsController#create as HTML
  Parameters: {"utf8"=>"âœ“", "originable"=>{"name"=>"pinot noirs", "flat_file"=>#<ActionDispatch::Http::UploadedFile:0x007fad42e5c058 @tempfile=#<Tempfile:/tmp/RackMultipart20141114-4490-1yk09kn>, @original_filename="family.odt.csv", @content_type="text/comma-separated-values", @headers="Content-Disposition: form-data; name=\"originable[flat_file]\"; filename=\"family.odt.csv\"\r\nContent-Type: text/comma-separated-values\r\nContent-Length: 117\r\n">}, "commit"=>"Upload file"}
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mButtafly::Spreadsheet Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "buttafly_spreadsheets"  WHERE "buttafly_spreadsheets"."name" = 'pinot noirs' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "buttafly_spreadsheets" ("aasm_state", "created_at", "flat_file", "name", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["aasm_state", "not_imported"], ["created_at", "2014-11-15 00:09:15.120235"], ["flat_file", "family.odt.csv"], ["name", "pinot noirs"], ["updated_at", "2014-11-15 00:09:15.120235"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/buttafly/contents
Completed 302 Found in 6ms (ActiveRecord: 0.8ms)
Started GET "/buttafly/contents" for 127.0.0.1 at 2014-11-14 16:09:15 -0800
Processing by Buttafly::ContentsController#index as HTML
  Rendered /home/fred/work/opensource/buttafly/app/views/buttafly/contents/_form.html.haml (1.4ms)
  [1m[35mButtafly::Spreadsheet Load (0.4ms)[0m  SELECT  "buttafly_spreadsheets".* FROM "buttafly_spreadsheets"   ORDER BY "buttafly_spreadsheets"."created_at" ASC LIMIT 5 OFFSET 0
  [1m[36mButtafly::Mapping Load (0.2ms)[0m  [1mSELECT "buttafly_mappings".* FROM "buttafly_mappings"  WHERE "buttafly_mappings"."originable_id" = $1 AND "buttafly_mappings"."originable_type" = $2[0m  [["originable_id", 30], ["originable_type", "Buttafly::Spreadsheet"]]
  [1m[35mButtafly::Legend Load (0.2ms)[0m  SELECT "buttafly_legends".* FROM "buttafly_legends"
  Rendered /home/fred/work/opensource/buttafly/app/views/buttafly/contents/_content.html.haml (4.3ms)
  [1m[36m (0.2ms)[0m  [1mSELECT COUNT(*) FROM "buttafly_spreadsheets"[0m
  Rendered application/_messages.html.haml (0.4ms)
Completed 200 OK in 11ms (Views: 8.8ms | ActiveRecord: 1.0ms)
  [1m[35m (0.3ms)[0m  SELECT COUNT(*) FROM "buttafly_spreadsheets"  WHERE "buttafly_spreadsheets"."name" = 'pinot noirs'
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
-----------------------------------------------------------
create content Feature Test: test_0002_fail renders message
-----------------------------------------------------------
Started GET "/buttafly/contents" for 127.0.0.1 at 2014-11-14 16:09:15 -0800
Processing by Buttafly::ContentsController#index as HTML
  Rendered /home/fred/work/opensource/buttafly/app/views/buttafly/contents/_form.html.haml (1.3ms)
  [1m[36mButtafly::Spreadsheet Load (0.3ms)[0m  [1mSELECT  "buttafly_spreadsheets".* FROM "buttafly_spreadsheets"   ORDER BY "buttafly_spreadsheets"."created_at" ASC LIMIT 5 OFFSET 0[0m
  [1m[35m (0.2ms)[0m  SELECT COUNT(*) FROM "buttafly_spreadsheets"
  Rendered application/_messages.html.haml (0.2ms)
Completed 200 OK in 6ms (Views: 4.1ms | ActiveRecord: 0.5ms)
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mButtafly::Spreadsheet Exists (0.3ms)[0m  SELECT  1 AS one FROM "buttafly_spreadsheets"  WHERE "buttafly_spreadsheets"."name" = 'test_file_name12' LIMIT 1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO "buttafly_spreadsheets" ("aasm_state", "created_at", "data", "flat_file", "name", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["aasm_state", "not_imported"], ["created_at", "2014-11-15 00:09:15.153990"], ["data", "[{\"mother\":\"Sarah Jane Schoeneman\",\"child\":\"Ella Mac Pacurar\",\"grandparent\":\"Vicki Pacurar\"}]"], ["flat_file", "family.odt.csv"], ["name", "test_file_name12"], ["updated_at", "2014-11-15 00:09:15.153990"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Started POST "/buttafly/contents" for 127.0.0.1 at 2014-11-14 16:09:15 -0800
Processing by Buttafly::ContentsController#create as HTML
  Parameters: {"utf8"=>"âœ“", "originable"=>{"name"=>"test_file_name12", "flat_file"=>#<ActionDispatch::Http::UploadedFile:0x007fad4232f2c0 @tempfile=#<Tempfile:/tmp/RackMultipart20141114-4490-xeh6xw>, @original_filename="family.odt.csv", @content_type="text/comma-separated-values", @headers="Content-Disposition: form-data; name=\"originable[flat_file]\"; filename=\"family.odt.csv\"\r\nContent-Type: text/comma-separated-values\r\nContent-Length: 117\r\n">}, "commit"=>"Upload file"}
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mButtafly::Spreadsheet Exists (0.4ms)[0m  SELECT  1 AS one FROM "buttafly_spreadsheets"  WHERE "buttafly_spreadsheets"."name" = 'test_file_name12' LIMIT 1
  [1m[36m (0.1ms)[0m  [1mROLLBACK TO SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/buttafly/
Completed 302 Found in 5ms (ActiveRecord: 0.6ms)
Started GET "/buttafly/" for 127.0.0.1 at 2014-11-14 16:09:15 -0800
Processing by Buttafly::ContentsController#index as HTML
  Rendered /home/fred/work/opensource/buttafly/app/views/buttafly/contents/_form.html.haml (1.3ms)
  [1m[35mButtafly::Spreadsheet Load (0.3ms)[0m  SELECT  "buttafly_spreadsheets".* FROM "buttafly_spreadsheets"   ORDER BY "buttafly_spreadsheets"."created_at" ASC LIMIT 5 OFFSET 0
  [1m[36mButtafly::Mapping Load (0.2ms)[0m  [1mSELECT "buttafly_mappings".* FROM "buttafly_mappings"  WHERE "buttafly_mappings"."originable_id" = $1 AND "buttafly_mappings"."originable_type" = $2[0m  [["originable_id", 31], ["originable_type", "Buttafly::Spreadsheet"]]
  [1m[35mButtafly::Legend Load (0.2ms)[0m  SELECT "buttafly_legends".* FROM "buttafly_legends"
  Rendered /home/fred/work/opensource/buttafly/app/views/buttafly/contents/_content.html.haml (3.4ms)
  [1m[36m (0.2ms)[0m  [1mSELECT COUNT(*) FROM "buttafly_spreadsheets"[0m
  Rendered application/_messages.html.haml (0.4ms)
Completed 200 OK in 10ms (Views: 7.5ms | ActiveRecord: 1.0ms)
  [1m[35m (0.3ms)[0m  SELECT COUNT(*) FROM "buttafly_spreadsheets"  WHERE "buttafly_spreadsheets"."name" = 'pinot noirs'
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.0ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.0ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.0ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (1.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mButtafly::Spreadsheet Exists (0.4ms)[0m  SELECT  1 AS one FROM "buttafly_spreadsheets"  WHERE "buttafly_spreadsheets"."name" = 'test_file_name13' LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "buttafly_spreadsheets" ("aasm_state", "created_at", "data", "flat_file", "name", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["aasm_state", "not_imported"], ["created_at", "2014-11-15 00:09:15.195388"], ["data", "{}"], ["flat_file", "family.odt.csv"], ["name", "test_file_name13"], ["updated_at", "2014-11-15 00:09:15.195388"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "buttafly_mappings" ("created_at", "originable_id", "originable_type", "targetable_model", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["created_at", "2014-11-15 00:09:15.198043"], ["originable_id", 32], ["originable_type", "Buttafly::Spreadsheet"], ["targetable_model", "DummyChild"], ["updated_at", "2014-11-15 00:09:15.198043"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.2ms)[0m  [1mUPDATE "buttafly_mappings" SET "targetable_model" = $1, "updated_at" = $2 WHERE "buttafly_mappings"."id" = 13[0m  [["targetable_model", "DummyParent"], ["updated_at", "2014-11-15 00:09:15.199823"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.0ms)[0m  BEGIN
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
  [1m[36m (0.0ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.0ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
  [1m[36m (0.0ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.0ms)[0m  BEGIN
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
  [1m[36m (0.0ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.0ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mButtafly::Spreadsheet Exists (0.3ms)[0m  SELECT  1 AS one FROM "buttafly_spreadsheets"  WHERE "buttafly_spreadsheets"."name" = 'test_file_name14' LIMIT 1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO "buttafly_spreadsheets" ("aasm_state", "created_at", "data", "flat_file", "name", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["aasm_state", "not_imported"], ["created_at", "2014-11-15 00:09:15.209985"], ["data", "{}"], ["flat_file", "family.odt.csv"], ["name", "test_file_name14"], ["updated_at", "2014-11-15 00:09:15.209985"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mButtafly::Spreadsheet Exists (0.3ms)[0m  SELECT  1 AS one FROM "buttafly_spreadsheets"  WHERE ("buttafly_spreadsheets"."name" = 'test_file_name14' AND "buttafly_spreadsheets"."id" != 33) LIMIT 1
  [1m[36mSQL (0.3ms)[0m  [1mUPDATE "buttafly_spreadsheets" SET "data" = $1, "imported_at" = $2, "updated_at" = $3 WHERE "buttafly_spreadsheets"."id" = 33[0m  [["data", "[{\"child name\":\"ella mac\",\"parent name\":\"sara\",\"grandparent name\":\"kc shekhar\",\"tribe name\":\"india\",\"age\":\"2.5\"},{\"child name\":\"rohan\",\"parent name\":\"doug\",\"grandparent name\":\"vicki\",\"tribe name\":\"america\",\"age\":\"6\"}]"], ["imported_at", "2014-11-15 00:09:15.268057"], ["updated_at", "2014-11-15 00:09:15.270379"]]
  [1m[35mButtafly::Spreadsheet Exists (0.3ms)[0m  SELECT  1 AS one FROM "buttafly_spreadsheets"  WHERE ("buttafly_spreadsheets"."name" = 'test_file_name14' AND "buttafly_spreadsheets"."id" != 33) LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mUPDATE "buttafly_spreadsheets" SET "aasm_state" = $1, "updated_at" = $2 WHERE "buttafly_spreadsheets"."id" = 33[0m  [["aasm_state", "imported"], ["updated_at", "2014-11-15 00:09:15.273742"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mButtafly::Spreadsheet Exists (0.3ms)[0m  SELECT  1 AS one FROM "buttafly_spreadsheets"  WHERE "buttafly_spreadsheets"."name" = 'test_file_name15' LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "buttafly_spreadsheets" ("aasm_state", "created_at", "data", "flat_file", "name", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["aasm_state", "not_imported"], ["created_at", "2014-11-15 00:09:15.278761"], ["data", "{}"], ["flat_file", "family.odt.csv"], ["name", "test_file_name15"], ["updated_at", "2014-11-15 00:09:15.278761"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mButtafly::Spreadsheet Exists (0.3ms)[0m  SELECT  1 AS one FROM "buttafly_spreadsheets"  WHERE ("buttafly_spreadsheets"."name" = 'test_file_name15' AND "buttafly_spreadsheets"."id" != 34) LIMIT 1
  [1m[36mSQL (0.4ms)[0m  [1mUPDATE "buttafly_spreadsheets" SET "data" = $1, "updated_at" = $2 WHERE "buttafly_spreadsheets"."id" = 34[0m  [["data", "[{\"child name\":\"ella mac\",\"parent name\":\"sara\",\"grandparent name\":\"kc shekhar\",\"tribe name\":\"india\",\"age\":\"2.5\"},{\"child name\":\"rohan\",\"parent name\":\"doug\",\"grandparent name\":\"vicki\",\"tribe name\":\"america\",\"age\":\"6\"}]"], ["updated_at", "2014-11-15 00:09:15.282800"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.0ms)[0m  BEGIN
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
  [1m[36m (0.0ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.0ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.0ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.0ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mButtafly::Spreadsheet Exists (0.3ms)[0m  SELECT  1 AS one FROM "buttafly_spreadsheets"  WHERE "buttafly_spreadsheets"."name" = 'test_file_name16' LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "buttafly_spreadsheets" ("aasm_state", "created_at", "data", "flat_file", "name", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["aasm_state", "not_imported"], ["created_at", "2014-11-15 00:09:15.292779"], ["data", "{}"], ["flat_file", "family.odt.csv"], ["name", "test_file_name16"], ["updated_at", "2014-11-15 00:09:15.292779"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO "buttafly_legends" ("created_at", "data", "updated_at") VALUES ($1, $2, $3) RETURNING "id"  [["created_at", "2014-11-15 00:09:15.296165"], ["data", "{\"meta\":{\"col_sep\":\",\",\"encoding\":\"utf-8\",\"row_sep\":\"/n\",\"headers\":[\"mother\",\"child\",\"grandparent\"]},\"dummy_child\":{\"name\":\"child\",\"dummy_parent\":{\"name\":\"mother\",\"dummy_grandparent\":{\"name\":\"grandparent\"}}}}"], ["updated_at", "2014-11-15 00:09:15.296165"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  COMMIT
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mButtafly::Spreadsheet Exists (0.4ms)[0m  [1mSELECT  1 AS one FROM "buttafly_spreadsheets"  WHERE "buttafly_spreadsheets"."name" = 'test_file_name17' LIMIT 1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO "buttafly_spreadsheets" ("aasm_state", "created_at", "data", "flat_file", "name", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["aasm_state", "not_imported"], ["created_at", "2014-11-15 00:09:15.303541"], ["data", "{}"], ["flat_file", "family.odt.csv"], ["name", "test_file_name17"], ["updated_at", "2014-11-15 00:09:15.303541"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "buttafly_mappings" ("created_at", "originable_id", "originable_type", "targetable_model", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["created_at", "2014-11-15 00:09:15.306966"], ["originable_id", 36], ["originable_type", "Buttafly::Spreadsheet"], ["targetable_model", "DummyChild"], ["updated_at", "2014-11-15 00:09:15.306966"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  ROLLBACK TO SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36mButtafly::Spreadsheet Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "buttafly_spreadsheets"  WHERE "buttafly_spreadsheets"."name" = 'test_file_name18' LIMIT 1[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
-------------------------------------------------------------
Buttafly::LegendsController::GET #new: test_0001_must succeed
-------------------------------------------------------------
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mButtafly::Spreadsheet Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "buttafly_spreadsheets"  WHERE "buttafly_spreadsheets"."name" = 'test_file_name19' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "buttafly_spreadsheets" ("aasm_state", "created_at", "data", "flat_file", "name", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["aasm_state", "not_imported"], ["created_at", "2014-11-15 00:09:15.319058"], ["data", "{}"], ["flat_file", "family.odt.csv"], ["name", "test_file_name19"], ["updated_at", "2014-11-15 00:09:15.319058"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "buttafly_mappings" ("created_at", "originable_id", "originable_type", "targetable_model", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["created_at", "2014-11-15 00:09:15.321886"], ["originable_id", 37], ["originable_type", "Buttafly::Spreadsheet"], ["targetable_model", "DummyChild"], ["updated_at", "2014-11-15 00:09:15.321886"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by Buttafly::LegendsController#new as HTML
  Parameters: {"mapping_id"=>"15"}
  [1m[36mButtafly::Mapping Load (0.2ms)[0m  [1mSELECT  "buttafly_mappings".* FROM "buttafly_mappings"  WHERE "buttafly_mappings"."id" = $1 LIMIT 1[0m  [["id", 15]]
  [1m[35mButtafly::Spreadsheet Load (0.2ms)[0m  SELECT  "buttafly_spreadsheets".* FROM "buttafly_spreadsheets"  WHERE "buttafly_spreadsheets"."id" = $1 LIMIT 1  [["id", 37]]
  Rendered application/_messages.html.haml (0.1ms)
Completed 200 OK in 15ms (Views: 11.0ms | ActiveRecord: 0.4ms)
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
------------------------------------------------------------------------------------------------
Buttafly::LegendsController::GET #new: test_0002_must instantiate a legend from existing mapping
------------------------------------------------------------------------------------------------
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mButtafly::Spreadsheet Exists (0.3ms)[0m  SELECT  1 AS one FROM "buttafly_spreadsheets"  WHERE "buttafly_spreadsheets"."name" = 'test_file_name20' LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "buttafly_spreadsheets" ("aasm_state", "created_at", "data", "flat_file", "name", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["aasm_state", "not_imported"], ["created_at", "2014-11-15 00:09:15.344856"], ["data", "{}"], ["flat_file", "family.odt.csv"], ["name", "test_file_name20"], ["updated_at", "2014-11-15 00:09:15.344856"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "buttafly_mappings" ("created_at", "originable_id", "originable_type", "targetable_model", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["created_at", "2014-11-15 00:09:15.347536"], ["originable_id", 38], ["originable_type", "Buttafly::Spreadsheet"], ["targetable_model", "DummyChild"], ["updated_at", "2014-11-15 00:09:15.347536"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by Buttafly::LegendsController#new as HTML
  Parameters: {"mapping_id"=>"16"}
  [1m[35mButtafly::Mapping Load (0.2ms)[0m  SELECT  "buttafly_mappings".* FROM "buttafly_mappings"  WHERE "buttafly_mappings"."id" = $1 LIMIT 1  [["id", 16]]
  [1m[36mButtafly::Spreadsheet Load (0.1ms)[0m  [1mSELECT  "buttafly_spreadsheets".* FROM "buttafly_spreadsheets"  WHERE "buttafly_spreadsheets"."id" = $1 LIMIT 1[0m  [["id", 38]]
  Rendered application/_messages.html.haml (0.1ms)
Completed 200 OK in 8ms (Views: 5.4ms | ActiveRecord: 0.4ms)
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  COMMIT
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "dummy_tribes" ("created_at", "name", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["created_at", "2014-11-15 00:09:15.360587"], ["name", "MyString"], ["updated_at", "2014-11-15 00:09:15.360587"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "dummy_grandparents" ("created_at", "dummy_tribe_id", "name", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"  [["created_at", "2014-11-15 00:09:15.361992"], ["dummy_tribe_id", 26], ["name", "Vicki Pacurar"], ["updated_at", "2014-11-15 00:09:15.361992"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "dummy_tribes" ("created_at", "name", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["created_at", "2014-11-15 00:09:15.363188"], ["name", "MyString"], ["updated_at", "2014-11-15 00:09:15.363188"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO "dummy_parents" ("created_at", "dummy_grandparent_id", "dummy_tribe_id", "name", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["created_at", "2014-11-15 00:09:15.364791"], ["dummy_grandparent_id", 8], ["dummy_tribe_id", 27], ["name", "Sarah Jane Schoeneman"], ["updated_at", "2014-11-15 00:09:15.364791"]]
  [1m[36m (0.2ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.0ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "dummy_tribes" ("created_at", "name", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["created_at", "2014-11-15 00:09:15.366636"], ["name", "MyString"], ["updated_at", "2014-11-15 00:09:15.366636"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.2ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.0ms)[0m  BEGIN
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.0ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "dummy_tribes" ("created_at", "name", "updated_at") VALUES ($1, $2, $3) RETURNING "id"  [["created_at", "2014-11-15 00:09:15.371323"], ["name", "MyString"], ["updated_at", "2014-11-15 00:09:15.371323"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "dummy_grandparents" ("created_at", "dummy_tribe_id", "name", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["created_at", "2014-11-15 00:09:15.372483"], ["dummy_tribe_id", 29], ["name", "Vicki Pacurar"], ["updated_at", "2014-11-15 00:09:15.372483"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "dummy_tribes" ("created_at", "name", "updated_at") VALUES ($1, $2, $3) RETURNING "id"  [["created_at", "2014-11-15 00:09:15.373738"], ["name", "MyString"], ["updated_at", "2014-11-15 00:09:15.373738"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "dummy_parents" ("created_at", "dummy_grandparent_id", "dummy_tribe_id", "name", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["created_at", "2014-11-15 00:09:15.374865"], ["dummy_grandparent_id", 9], ["dummy_tribe_id", 30], ["name", "Sarah Jane Schoeneman"], ["updated_at", "2014-11-15 00:09:15.374865"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "dummy_tribes" ("created_at", "name", "updated_at") VALUES ($1, $2, $3) RETURNING "id"  [["created_at", "2014-11-15 00:09:15.376086"], ["name", "MyString"], ["updated_at", "2014-11-15 00:09:15.376086"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  COMMIT
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mButtafly::Spreadsheet Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "buttafly_spreadsheets"  WHERE "buttafly_spreadsheets"."name" = 'test_file_name21' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "buttafly_spreadsheets" ("aasm_state", "created_at", "data", "flat_file", "name", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["aasm_state", "imported"], ["created_at", "2014-11-15 00:09:15.381084"], ["data", "[{\"mother\":\"Sarah Jane Schoeneman\",\"child\":\"Ella Mac Pacurar\",\"grandparent\":\"Vicki Pacurar\"}]"], ["flat_file", "family.odt.csv"], ["name", "test_file_name21"], ["updated_at", "2014-11-15 00:09:15.381084"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35mButtafly::Spreadsheet Load (0.1ms)[0m  SELECT  "buttafly_spreadsheets".* FROM "buttafly_spreadsheets"  WHERE "buttafly_spreadsheets"."id" = $1 LIMIT 1  [["id", 39]]
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.0ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "dummy_tribes" ("created_at", "name", "updated_at") VALUES ($1, $2, $3) RETURNING "id"  [["created_at", "2014-11-15 00:09:15.386203"], ["name", "MyString"], ["updated_at", "2014-11-15 00:09:15.386203"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.0ms)[0m  COMMIT
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
  [1m[35m (0.0ms)[0m  COMMIT
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
  [1m[35m (0.0ms)[0m  COMMIT
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
  [1m[35m (0.0ms)[0m  COMMIT
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mButtafly::Spreadsheet Exists (0.4ms)[0m  [1mSELECT  1 AS one FROM "buttafly_spreadsheets"  WHERE "buttafly_spreadsheets"."name" = 'test_file_name22' LIMIT 1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO "buttafly_spreadsheets" ("aasm_state", "created_at", "data", "flat_file", "name", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["aasm_state", "not_imported"], ["created_at", "2014-11-15 00:09:15.397851"], ["data", "{}"], ["flat_file", "family.odt.csv"], ["name", "test_file_name22"], ["updated_at", "2014-11-15 00:09:15.397851"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  COMMIT
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
  [1m[35m (0.0ms)[0m  COMMIT
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.0ms)[0m  COMMIT
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "dummy_tribes" ("created_at", "name", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["created_at", "2014-11-15 00:09:15.404331"], ["name", "MyString"], ["updated_at", "2014-11-15 00:09:15.404331"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "dummy_grandparents" ("created_at", "dummy_tribe_id", "name", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"  [["created_at", "2014-11-15 00:09:15.406086"], ["dummy_tribe_id", 33], ["name", "Vicki Pacurar"], ["updated_at", "2014-11-15 00:09:15.406086"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.1ms)[0m  [1mINSERT INTO "dummy_tribes" ("created_at", "name", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["created_at", "2014-11-15 00:09:15.407498"], ["name", "MyString"], ["updated_at", "2014-11-15 00:09:15.407498"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.0ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.0ms)[0m  BEGIN
  [1m[36mButtafly::Spreadsheet Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "buttafly_spreadsheets"  WHERE "buttafly_spreadsheets"."name" = 'test_file_name23' LIMIT 1[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  COMMIT
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.0ms)[0m  COMMIT
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
  [1m[35m (0.0ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  COMMIT
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
  [1m[35mButtafly::Spreadsheet Exists (0.3ms)[0m  SELECT  1 AS one FROM "buttafly_spreadsheets"  WHERE "buttafly_spreadsheets"."name" = 'test_file_name24' LIMIT 1
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mButtafly::Spreadsheet Exists (0.3ms)[0m  SELECT  1 AS one FROM "buttafly_spreadsheets"  WHERE "buttafly_spreadsheets"."name" = 'test_file_name25' LIMIT 1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO "buttafly_spreadsheets" ("aasm_state", "created_at", "data", "flat_file", "name", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["aasm_state", "not_imported"], ["created_at", "2014-11-15 00:09:15.425893"], ["data", "{}"], ["flat_file", "family.odt.csv"], ["name", "test_file_name25"], ["updated_at", "2014-11-15 00:09:15.425893"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "buttafly_mappings" ("created_at", "originable_id", "originable_type", "targetable_model", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["created_at", "2014-11-15 00:09:15.429221"], ["originable_id", 41], ["originable_type", "Buttafly::Spreadsheet"], ["targetable_model", "DummyChild"], ["updated_at", "2014-11-15 00:09:15.429221"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  COMMIT
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mButtafly::Spreadsheet Exists (0.3ms)[0m  SELECT  1 AS one FROM "buttafly_spreadsheets"  WHERE "buttafly_spreadsheets"."name" = 'test_file_name26' LIMIT 1
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.0ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
---------------------------------------------
create legend Feature Test: test_0001_success
---------------------------------------------
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mButtafly::Spreadsheet Exists (0.4ms)[0m  SELECT  1 AS one FROM "buttafly_spreadsheets"  WHERE "buttafly_spreadsheets"."name" = 'test_file_name27' LIMIT 1
  [1m[36mSQL (1.2ms)[0m  [1mINSERT INTO "buttafly_spreadsheets" ("aasm_state", "created_at", "data", "flat_file", "name", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["aasm_state", "not_imported"], ["created_at", "2014-11-15 00:09:15.455049"], ["data", "{}"], ["flat_file", "family.odt.csv"], ["name", "test_file_name27"], ["updated_at", "2014-11-15 00:09:15.455049"]]
  [1m[35m (0.2ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO "buttafly_mappings" ("created_at", "originable_id", "originable_type", "targetable_model", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["created_at", "2014-11-15 00:09:15.460011"], ["originable_id", 42], ["originable_type", "Buttafly::Spreadsheet"], ["targetable_model", "DummyChild"], ["updated_at", "2014-11-15 00:09:15.460011"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Started GET "/buttafly/contents" for 127.0.0.1 at 2014-11-14 16:09:15 -0800
Processing by Buttafly::ContentsController#index as HTML
  Rendered /home/fred/work/opensource/buttafly/app/views/buttafly/contents/_form.html.haml (1.4ms)
  [1m[35mButtafly::Spreadsheet Load (0.3ms)[0m  SELECT  "buttafly_spreadsheets".* FROM "buttafly_spreadsheets"   ORDER BY "buttafly_spreadsheets"."created_at" ASC LIMIT 5 OFFSET 0
  [1m[36mButtafly::Mapping Load (0.2ms)[0m  [1mSELECT "buttafly_mappings".* FROM "buttafly_mappings"  WHERE "buttafly_mappings"."originable_id" = $1 AND "buttafly_mappings"."originable_type" = $2[0m  [["originable_id", 42], ["originable_type", "Buttafly::Spreadsheet"]]
  [1m[35mButtafly::Legend Load (0.2ms)[0m  SELECT "buttafly_legends".* FROM "buttafly_legends"
  Rendered /home/fred/work/opensource/buttafly/app/views/buttafly/contents/_content.html.haml (3.7ms)
  [1m[36m (0.2ms)[0m  [1mSELECT COUNT(*) FROM "buttafly_spreadsheets"[0m
  Rendered application/_messages.html.haml (0.2ms)
Completed 200 OK in 10ms (Views: 7.8ms | ActiveRecord: 0.9ms)
Started GET "/buttafly/legends/new?mapping_id=18" for 127.0.0.1 at 2014-11-14 16:09:15 -0800
Processing by Buttafly::LegendsController#new as HTML
  Parameters: {"mapping_id"=>"18"}
  [1m[35mButtafly::Mapping Load (0.2ms)[0m  SELECT  "buttafly_mappings".* FROM "buttafly_mappings"  WHERE "buttafly_mappings"."id" = $1 LIMIT 1  [["id", 18]]
  [1m[36mButtafly::Spreadsheet Load (0.1ms)[0m  [1mSELECT  "buttafly_spreadsheets".* FROM "buttafly_spreadsheets"  WHERE "buttafly_spreadsheets"."id" = $1 LIMIT 1[0m  [["id", 42]]
  Rendered application/_messages.html.haml (0.2ms)
Completed 200 OK in 8ms (Views: 5.2ms | ActiveRecord: 0.4ms)
  [1m[35m (0.2ms)[0m  ROLLBACK
  [1m[36mActiveRecord::SchemaMigration Load (1.2ms)[0m  [1mSELECT "schema_migrations".* FROM "schema_migrations"[0m
  [1m[35m (0.2ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mButtafly::Spreadsheet Exists (3.0ms)[0m  SELECT  1 AS one FROM "buttafly_spreadsheets"  WHERE "buttafly_spreadsheets"."name" = 'test_file_name1' LIMIT 1
  [1m[36mSQL (1.0ms)[0m  [1mINSERT INTO "buttafly_spreadsheets" ("aasm_state", "created_at", "data", "flat_file", "name", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["aasm_state", "not_imported"], ["created_at", "2014-11-17 01:58:46.063046"], ["data", "{}"], ["flat_file", "family.odt.csv"], ["name", "test_file_name1"], ["updated_at", "2014-11-17 01:58:46.063046"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.6ms)[0m  INSERT INTO "buttafly_mappings" ("created_at", "originable_id", "originable_type", "targetable_model", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["created_at", "2014-11-17 01:58:46.073268"], ["originable_id", 43], ["originable_type", "Buttafly::Spreadsheet"], ["targetable_model", "DummyChild"], ["updated_at", "2014-11-17 01:58:46.073268"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  COMMIT
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.2ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  COMMIT
  [1m[36m (0.2ms)[0m  [1mBEGIN[0m
  [1m[35m (0.2ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  COMMIT
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.2ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  COMMIT
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (1.2ms)[0m  [1mINSERT INTO "dummy_tribes" ("created_at", "name", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["created_at", "2014-11-17 01:58:46.134739"], ["name", "MyString"], ["updated_at", "2014-11-17 01:58:46.134739"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.0ms)[0m  INSERT INTO "dummy_grandparents" ("created_at", "dummy_tribe_id", "name", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"  [["created_at", "2014-11-17 01:58:46.138448"], ["dummy_tribe_id", 35], ["name", "Vicki Pacurar"], ["updated_at", "2014-11-17 01:58:46.138448"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "dummy_tribes" ("created_at", "name", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["created_at", "2014-11-17 01:58:46.142518"], ["name", "MyString"], ["updated_at", "2014-11-17 01:58:46.142518"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.1ms)[0m  INSERT INTO "dummy_parents" ("created_at", "dummy_grandparent_id", "dummy_tribe_id", "name", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["created_at", "2014-11-17 01:58:46.145181"], ["dummy_grandparent_id", 11], ["dummy_tribe_id", 36], ["name", "Sarah Jane Schoeneman"], ["updated_at", "2014-11-17 01:58:46.145181"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "dummy_tribes" ("created_at", "name", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["created_at", "2014-11-17 01:58:46.148999"], ["name", "MyString"], ["updated_at", "2014-11-17 01:58:46.148999"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.2ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mButtafly::Spreadsheet Exists (0.4ms)[0m  SELECT  1 AS one FROM "buttafly_spreadsheets"  WHERE "buttafly_spreadsheets"."name" = 'test_file_name2' LIMIT 1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO "buttafly_spreadsheets" ("aasm_state", "created_at", "data", "flat_file", "name", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["aasm_state", "not_imported"], ["created_at", "2014-11-17 01:58:46.158725"], ["data", "{}"], ["flat_file", "family.odt.csv"], ["name", "test_file_name2"], ["updated_at", "2014-11-17 01:58:46.158725"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
----------------------------------------------
create mapping Feature Test: test_0001_success
----------------------------------------------
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mButtafly::Spreadsheet Exists (0.4ms)[0m  SELECT  1 AS one FROM "buttafly_spreadsheets"  WHERE "buttafly_spreadsheets"."name" = 'test_file_name3' LIMIT 1
  [1m[36mSQL (0.4ms)[0m  [1mINSERT INTO "buttafly_spreadsheets" ("aasm_state", "created_at", "data", "flat_file", "name", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["aasm_state", "not_imported"], ["created_at", "2014-11-17 01:58:46.184540"], ["data", "[{\"mother\":\"Sarah Jane Schoeneman\",\"child\":\"Ella Mac Pacurar\",\"grandparent\":\"Vicki Pacurar\"}]"], ["flat_file", "family.odt.csv"], ["name", "test_file_name3"], ["updated_at", "2014-11-17 01:58:46.184540"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Started GET "/buttafly/contents" for 127.0.0.1 at 2014-11-16 17:58:46 -0800
Processing by Buttafly::ContentsController#index as HTML
  Rendered /home/fred/work/opensource/buttafly/app/views/buttafly/contents/_form.html.haml (8.1ms)
  [1m[36mButtafly::Spreadsheet Load (0.6ms)[0m  [1mSELECT  "buttafly_spreadsheets".* FROM "buttafly_spreadsheets"   ORDER BY "buttafly_spreadsheets"."created_at" ASC LIMIT 5 OFFSET 0[0m
  [1m[35mButtafly::Mapping Load (0.3ms)[0m  SELECT "buttafly_mappings".* FROM "buttafly_mappings"  WHERE "buttafly_mappings"."originable_id" = $1 AND "buttafly_mappings"."originable_type" = $2  [["originable_id", 45], ["originable_type", "Buttafly::Spreadsheet"]]
  [1m[36mButtafly::Legend Load (0.9ms)[0m  [1mSELECT "buttafly_legends".* FROM "buttafly_legends"[0m
  Rendered /home/fred/work/opensource/buttafly/app/views/buttafly/contents/_content.html.haml (26.2ms)
  [1m[35m (0.4ms)[0m  SELECT COUNT(*) FROM "buttafly_spreadsheets"
  Rendered /home/fred/work/opensource/buttafly/app/views/buttafly/contents/index.html.haml within layouts/application (50.9ms)
  Rendered application/_messages.html.haml (13.5ms)
Completed 200 OK in 127ms (Views: 122.6ms | ActiveRecord: 2.1ms)
  [1m[36m (0.3ms)[0m  [1mSELECT COUNT(*) FROM "buttafly_mappings"  WHERE "buttafly_mappings"."originable_id" = $1 AND "buttafly_mappings"."originable_type" = $2[0m  [["originable_id", 45], ["originable_type", "Buttafly::Spreadsheet"]]
Started POST "/buttafly/mappings?originable_id=45" for 127.0.0.1 at 2014-11-16 17:58:46 -0800
Processing by Buttafly::MappingsController#create as HTML
  Parameters: {"utf8"=>"âœ“", "mapping"=>{"originable_id"=>"45", "targetable_model"=>"DummyChild"}, "commit"=>"Select Target Model", "originable_id"=>"45"}
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mButtafly::Spreadsheet Load (0.3ms)[0m  [1mSELECT  "buttafly_spreadsheets".* FROM "buttafly_spreadsheets"  WHERE "buttafly_spreadsheets"."id" = $1 LIMIT 1[0m  [["id", 45]]
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "buttafly_mappings" ("created_at", "originable_id", "originable_type", "targetable_model", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["created_at", "2014-11-17 01:58:46.359851"], ["originable_id", 45], ["originable_type", "Buttafly::Spreadsheet"], ["targetable_model", "DummyChild"], ["updated_at", "2014-11-17 01:58:46.359851"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/buttafly/contents
Completed 302 Found in 5ms (ActiveRecord: 0.8ms)
Started GET "/buttafly/contents" for 127.0.0.1 at 2014-11-16 17:58:46 -0800
Processing by Buttafly::ContentsController#index as HTML
  Rendered /home/fred/work/opensource/buttafly/app/views/buttafly/contents/_form.html.haml (1.8ms)
  [1m[35mButtafly::Spreadsheet Load (0.4ms)[0m  SELECT  "buttafly_spreadsheets".* FROM "buttafly_spreadsheets"   ORDER BY "buttafly_spreadsheets"."created_at" ASC LIMIT 5 OFFSET 0
  [1m[36mButtafly::Mapping Load (0.3ms)[0m  [1mSELECT "buttafly_mappings".* FROM "buttafly_mappings"  WHERE "buttafly_mappings"."originable_id" = $1 AND "buttafly_mappings"."originable_type" = $2[0m  [["originable_id", 45], ["originable_type", "Buttafly::Spreadsheet"]]
  [1m[35mButtafly::Legend Load (0.3ms)[0m  SELECT "buttafly_legends".* FROM "buttafly_legends"
  Rendered /home/fred/work/opensource/buttafly/app/views/buttafly/contents/_content.html.haml (6.8ms)
  [1m[36m (0.3ms)[0m  [1mSELECT COUNT(*) FROM "buttafly_spreadsheets"[0m
  Rendered /home/fred/work/opensource/buttafly/app/views/buttafly/contents/index.html.haml within layouts/application (11.6ms)
  Rendered application/_messages.html.haml (0.6ms)
Completed 200 OK in 16ms (Views: 12.8ms | ActiveRecord: 1.3ms)
  [1m[35m (0.4ms)[0m  SELECT COUNT(*) FROM "buttafly_mappings"  WHERE "buttafly_mappings"."originable_id" = $1 AND "buttafly_mappings"."originable_type" = $2  [["originable_id", 45], ["originable_type", "Buttafly::Spreadsheet"]]
  [1m[36mButtafly::Mapping Load (0.3ms)[0m  [1mSELECT  "buttafly_mappings".* FROM "buttafly_mappings"  WHERE "buttafly_mappings"."originable_id" = $1 AND "buttafly_mappings"."originable_type" = $2  ORDER BY "buttafly_mappings"."id" ASC LIMIT 1[0m  [["originable_id", 45], ["originable_type", "Buttafly::Spreadsheet"]]
  [1m[35mButtafly::Spreadsheet Load (0.3ms)[0m  SELECT  "buttafly_spreadsheets".* FROM "buttafly_spreadsheets"  WHERE "buttafly_spreadsheets"."id" = $1 LIMIT 1  [["id", 45]]
  [1m[36m (0.2ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mButtafly::Spreadsheet Exists (0.3ms)[0m  SELECT  1 AS one FROM "buttafly_spreadsheets"  WHERE "buttafly_spreadsheets"."name" = 'test_file_name4' LIMIT 1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO "buttafly_spreadsheets" ("aasm_state", "created_at", "data", "flat_file", "name", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["aasm_state", "not_imported"], ["created_at", "2014-11-17 01:58:46.402605"], ["data", "{}"], ["flat_file", "family.odt.csv"], ["name", "test_file_name4"], ["updated_at", "2014-11-17 01:58:46.402605"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO "buttafly_mappings" ("created_at", "originable_id", "originable_type", "targetable_model", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["created_at", "2014-11-17 01:58:46.406395"], ["originable_id", 46], ["originable_type", "Buttafly::Spreadsheet"], ["targetable_model", "DummyChild"], ["updated_at", "2014-11-17 01:58:46.406395"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.3ms)[0m  [1mUPDATE "buttafly_mappings" SET "targetable_model" = $1, "updated_at" = $2 WHERE "buttafly_mappings"."id" = 21[0m  [["targetable_model", "DummyParent"], ["updated_at", "2014-11-17 01:58:46.408359"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "dummy_tribes" ("created_at", "name", "updated_at") VALUES ($1, $2, $3) RETURNING "id"  [["created_at", "2014-11-17 01:58:46.417327"], ["name", "MyString"], ["updated_at", "2014-11-17 01:58:46.417327"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "dummy_grandparents" ("created_at", "dummy_tribe_id", "name", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["created_at", "2014-11-17 01:58:46.419297"], ["dummy_tribe_id", 38], ["name", "Vicki Pacurar"], ["updated_at", "2014-11-17 01:58:46.419297"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "dummy_tribes" ("created_at", "name", "updated_at") VALUES ($1, $2, $3) RETURNING "id"  [["created_at", "2014-11-17 01:58:46.421172"], ["name", "MyString"], ["updated_at", "2014-11-17 01:58:46.421172"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "dummy_parents" ("created_at", "dummy_grandparent_id", "dummy_tribe_id", "name", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["created_at", "2014-11-17 01:58:46.423005"], ["dummy_grandparent_id", 12], ["dummy_tribe_id", 39], ["name", "Sarah Jane Schoeneman"], ["updated_at", "2014-11-17 01:58:46.423005"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "dummy_tribes" ("created_at", "name", "updated_at") VALUES ($1, $2, $3) RETURNING "id"  [["created_at", "2014-11-17 01:58:46.424858"], ["name", "MyString"], ["updated_at", "2014-11-17 01:58:46.424858"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (1.0ms)[0m  [1mINSERT INTO "dummy_children" ("created_at", "dummy_parent_id", "dummy_tribe_id", "name", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["created_at", "2014-11-17 01:58:46.426647"], ["dummy_parent_id", 10], ["dummy_tribe_id", 40], ["name", "Ella Mac"], ["updated_at", "2014-11-17 01:58:46.426647"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.0ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.0ms)[0m  BEGIN
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.0ms)[0m  BEGIN
  [1m[36m (0.0ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.0ms)[0m  BEGIN
  [1m[36m (0.0ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.0ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.0ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "dummy_tribes" ("created_at", "name", "updated_at") VALUES ($1, $2, $3) RETURNING "id"  [["created_at", "2014-11-17 01:58:46.433710"], ["name", "MyString"], ["updated_at", "2014-11-17 01:58:46.433710"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "dummy_grandparents" ("created_at", "dummy_tribe_id", "name", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["created_at", "2014-11-17 01:58:46.435680"], ["dummy_tribe_id", 41], ["name", "Vicki Pacurar"], ["updated_at", "2014-11-17 01:58:46.435680"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "dummy_tribes" ("created_at", "name", "updated_at") VALUES ($1, $2, $3) RETURNING "id"  [["created_at", "2014-11-17 01:58:46.437627"], ["name", "MyString"], ["updated_at", "2014-11-17 01:58:46.437627"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "dummy_parents" ("created_at", "dummy_grandparent_id", "dummy_tribe_id", "name", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["created_at", "2014-11-17 01:58:46.439357"], ["dummy_grandparent_id", 13], ["dummy_tribe_id", 42], ["name", "Sarah Jane Schoeneman"], ["updated_at", "2014-11-17 01:58:46.439357"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "dummy_tribes" ("created_at", "name", "updated_at") VALUES ($1, $2, $3) RETURNING "id"  [["created_at", "2014-11-17 01:58:46.441208"], ["name", "MyString"], ["updated_at", "2014-11-17 01:58:46.441208"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "dummy_children" ("created_at", "dummy_parent_id", "dummy_tribe_id", "name", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["created_at", "2014-11-17 01:58:46.442806"], ["dummy_parent_id", 11], ["dummy_tribe_id", 43], ["name", "Ella Mac"], ["updated_at", "2014-11-17 01:58:46.442806"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "dummy_tribes" ("created_at", "name", "updated_at") VALUES ($1, $2, $3) RETURNING "id"  [["created_at", "2014-11-17 01:58:46.451470"], ["name", "MyString"], ["updated_at", "2014-11-17 01:58:46.451470"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "dummy_grandparents" ("created_at", "dummy_tribe_id", "name", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["created_at", "2014-11-17 01:58:46.453234"], ["dummy_tribe_id", 44], ["name", "Vicki Pacurar"], ["updated_at", "2014-11-17 01:58:46.453234"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "dummy_tribes" ("created_at", "name", "updated_at") VALUES ($1, $2, $3) RETURNING "id"  [["created_at", "2014-11-17 01:58:46.455075"], ["name", "MyString"], ["updated_at", "2014-11-17 01:58:46.455075"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO "dummy_parents" ("created_at", "dummy_grandparent_id", "dummy_tribe_id", "name", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["created_at", "2014-11-17 01:58:46.456920"], ["dummy_grandparent_id", 14], ["dummy_tribe_id", 45], ["name", "Sarah Jane Schoeneman"], ["updated_at", "2014-11-17 01:58:46.456920"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "dummy_tribes" ("created_at", "name", "updated_at") VALUES ($1, $2, $3) RETURNING "id"  [["created_at", "2014-11-17 01:58:46.459398"], ["name", "MyString"], ["updated_at", "2014-11-17 01:58:46.459398"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  COMMIT
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mButtafly::Spreadsheet Exists (0.4ms)[0m  [1mSELECT  1 AS one FROM "buttafly_spreadsheets"  WHERE "buttafly_spreadsheets"."name" = 'test_file_name5' LIMIT 1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO "buttafly_spreadsheets" ("aasm_state", "created_at", "data", "flat_file", "name", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["aasm_state", "imported"], ["created_at", "2014-11-17 01:58:46.466362"], ["data", "[{\"mother\":\"Sarah Jane Schoeneman\",\"child\":\"Ella Mac Pacurar\",\"grandparent\":\"Vicki Pacurar\"}]"], ["flat_file", "family.odt.csv"], ["name", "test_file_name5"], ["updated_at", "2014-11-17 01:58:46.466362"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35mButtafly::Spreadsheet Load (0.3ms)[0m  SELECT  "buttafly_spreadsheets".* FROM "buttafly_spreadsheets"  WHERE "buttafly_spreadsheets"."id" = $1 LIMIT 1  [["id", 47]]
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "dummy_tribes" ("created_at", "name", "updated_at") VALUES ($1, $2, $3) RETURNING "id"  [["created_at", "2014-11-17 01:58:46.472483"], ["name", "MyString"], ["updated_at", "2014-11-17 01:58:46.472483"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "dummy_grandparents" ("created_at", "dummy_tribe_id", "name", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["created_at", "2014-11-17 01:58:46.474308"], ["dummy_tribe_id", 47], ["name", "Vicki Pacurar"], ["updated_at", "2014-11-17 01:58:46.474308"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "dummy_tribes" ("created_at", "name", "updated_at") VALUES ($1, $2, $3) RETURNING "id"  [["created_at", "2014-11-17 01:58:46.476112"], ["name", "MyString"], ["updated_at", "2014-11-17 01:58:46.476112"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  COMMIT
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  COMMIT
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "dummy_tribes" ("created_at", "name", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["created_at", "2014-11-17 01:58:46.480626"], ["name", "MyString"], ["updated_at", "2014-11-17 01:58:46.480626"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
-------------------------------------------------------------------------
Buttafly::ContentsController: test_0001_get #show must assign @originable
-------------------------------------------------------------------------
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mButtafly::Spreadsheet Exists (0.3ms)[0m  SELECT  1 AS one FROM "buttafly_spreadsheets"  WHERE "buttafly_spreadsheets"."name" = 'test_file_name6' LIMIT 1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO "buttafly_spreadsheets" ("aasm_state", "created_at", "data", "flat_file", "name", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["aasm_state", "not_imported"], ["created_at", "2014-11-17 01:58:46.488780"], ["data", "{}"], ["flat_file", "family.odt.csv"], ["name", "test_file_name6"], ["updated_at", "2014-11-17 01:58:46.488780"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by Buttafly::ContentsController#show as HTML
  Parameters: {"id"=>"48"}
  [1m[36mButtafly::Spreadsheet Load (0.3ms)[0m  [1mSELECT  "buttafly_spreadsheets".* FROM "buttafly_spreadsheets"  WHERE "buttafly_spreadsheets"."id" = $1 LIMIT 1[0m  [["id", 48]]
  Rendered /home/fred/work/opensource/buttafly/app/views/buttafly/contents/show.html.haml within layouts/application (0.9ms)
  Rendered application/_messages.html.haml (0.1ms)
Completed 200 OK in 6ms (Views: 4.5ms | ActiveRecord: 0.3ms)
  [1m[35m (0.2ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
-------------------------------------------------
Buttafly::ContentsController: test_0002_get #edit
-------------------------------------------------
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mButtafly::Spreadsheet Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "buttafly_spreadsheets"  WHERE "buttafly_spreadsheets"."name" = 'test_file_name7' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "buttafly_spreadsheets" ("aasm_state", "created_at", "data", "flat_file", "name", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["aasm_state", "not_imported"], ["created_at", "2014-11-17 01:58:46.506628"], ["data", "{}"], ["flat_file", "family.odt.csv"], ["name", "test_file_name7"], ["updated_at", "2014-11-17 01:58:46.506628"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by Buttafly::ContentsController#edit as HTML
  Parameters: {"id"=>"49"}
  [1m[35mButtafly::Spreadsheet Load (0.3ms)[0m  SELECT  "buttafly_spreadsheets".* FROM "buttafly_spreadsheets"  WHERE "buttafly_spreadsheets"."id" = $1 LIMIT 1  [["id", 49]]
  Rendered /home/fred/work/opensource/buttafly/app/views/buttafly/contents/_form.html.haml (1.9ms)
  Rendered application/_messages.html.haml (0.1ms)
Completed 200 OK in 8ms (Views: 6.9ms | ActiveRecord: 0.3ms)
  [1m[36m (0.2ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
----------------------------------------------------
Buttafly::ContentsController: test_0003_post #create
----------------------------------------------------
Processing by Buttafly::ContentsController#create as HTML
  Parameters: {"originable"=>{"name"=>"slick name", "flat_file"=>"slickname.csv"}}
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mButtafly::Spreadsheet Exists (0.3ms)[0m  SELECT  1 AS one FROM "buttafly_spreadsheets"  WHERE "buttafly_spreadsheets"."name" = 'slick name' LIMIT 1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO "buttafly_spreadsheets" ("aasm_state", "created_at", "flat_file", "name", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["aasm_state", "not_imported"], ["created_at", "2014-11-17 01:58:46.523502"], ["flat_file", nil], ["name", "slick name"], ["updated_at", "2014-11-17 01:58:46.523502"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://test.host/buttafly/contents
Completed 302 Found in 5ms (ActiveRecord: 0.8ms)
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
-------------------------------------------------------------------------
Buttafly::ContentsController: test_0004_patch #import saves a spreadsheet
-------------------------------------------------------------------------
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mButtafly::Spreadsheet Exists (0.4ms)[0m  SELECT  1 AS one FROM "buttafly_spreadsheets"  WHERE "buttafly_spreadsheets"."name" = 'test_file_name8' LIMIT 1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO "buttafly_spreadsheets" ("aasm_state", "created_at", "data", "flat_file", "name", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["aasm_state", "not_imported"], ["created_at", "2014-11-17 01:58:46.531001"], ["data", "{}"], ["flat_file", "family.odt.csv"], ["name", "test_file_name8"], ["updated_at", "2014-11-17 01:58:46.531001"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by Buttafly::ContentsController#import as HTML
  Parameters: {"originable_type"=>"Buttafly::Spreadsheet", "id"=>"51"}
  [1m[36mButtafly::Spreadsheet Load (0.3ms)[0m  [1mSELECT  "buttafly_spreadsheets".* FROM "buttafly_spreadsheets"  WHERE "buttafly_spreadsheets"."id" = $1 LIMIT 1[0m  [["id", 51]]
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mButtafly::Spreadsheet Exists (0.5ms)[0m  [1mSELECT  1 AS one FROM "buttafly_spreadsheets"  WHERE ("buttafly_spreadsheets"."name" = 'test_file_name8' AND "buttafly_spreadsheets"."id" != 51) LIMIT 1[0m
  [1m[35mSQL (0.3ms)[0m  UPDATE "buttafly_spreadsheets" SET "data" = $1, "imported_at" = $2, "updated_at" = $3 WHERE "buttafly_spreadsheets"."id" = 51  [["data", "[{\"child name\":\"ella mac\",\"parent name\":\"sara\",\"grandparent name\":\"kc shekhar\",\"tribe name\":\"india\",\"age\":\"2.5\"},{\"child name\":\"rohan\",\"parent name\":\"doug\",\"grandparent name\":\"vicki\",\"tribe name\":\"america\",\"age\":\"6\"}]"], ["imported_at", "2014-11-17 01:58:46.535933"], ["updated_at", "2014-11-17 01:58:46.539362"]]
  [1m[36mButtafly::Spreadsheet Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "buttafly_spreadsheets"  WHERE ("buttafly_spreadsheets"."name" = 'test_file_name8' AND "buttafly_spreadsheets"."id" != 51) LIMIT 1[0m
  [1m[35mSQL (0.3ms)[0m  UPDATE "buttafly_spreadsheets" SET "aasm_state" = $1, "updated_at" = $2 WHERE "buttafly_spreadsheets"."id" = 51  [["aasm_state", "imported"], ["updated_at", "2014-11-17 01:58:46.542959"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to /referring/url
Completed 302 Found in 10ms (ActiveRecord: 1.9ms)
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
------------------------------------------------------------------------
Buttafly::ContentsController: test_0005_post #create saves a spreadsheet
------------------------------------------------------------------------
  [1m[35m (0.3ms)[0m  SELECT COUNT(*) FROM "buttafly_spreadsheets"
Processing by Buttafly::ContentsController#create as HTML
  Parameters: {"originable"=>{"name"=>"sweeet name", "flat_file"=>"summer.csv"}}
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mButtafly::Spreadsheet Exists (0.3ms)[0m  SELECT  1 AS one FROM "buttafly_spreadsheets"  WHERE "buttafly_spreadsheets"."name" = 'sweeet name' LIMIT 1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO "buttafly_spreadsheets" ("aasm_state", "created_at", "flat_file", "name", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["aasm_state", "not_imported"], ["created_at", "2014-11-17 01:58:46.550540"], ["flat_file", nil], ["name", "sweeet name"], ["updated_at", "2014-11-17 01:58:46.550540"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://test.host/buttafly/contents
Completed 302 Found in 4ms (ActiveRecord: 0.8ms)
  [1m[36m (0.3ms)[0m  [1mSELECT COUNT(*) FROM "buttafly_spreadsheets"[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
--------------------------------------------------------
Buttafly::ContentsController: test_0006_should get index
--------------------------------------------------------
Processing by Buttafly::ContentsController#index as HTML
  Rendered /home/fred/work/opensource/buttafly/app/views/buttafly/contents/_form.html.haml (1.8ms)
  [1m[35mButtafly::Spreadsheet Load (0.4ms)[0m  SELECT  "buttafly_spreadsheets".* FROM "buttafly_spreadsheets"   ORDER BY "buttafly_spreadsheets"."created_at" ASC LIMIT 5 OFFSET 0
  [1m[36m (0.2ms)[0m  [1mSELECT COUNT(*) FROM "buttafly_spreadsheets"[0m
  Rendered application/_messages.html.haml (0.1ms)
Completed 200 OK in 8ms (Views: 5.5ms | ActiveRecord: 0.6ms)
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  COMMIT
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  COMMIT
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
-------------------------------------------------------------
Buttafly::LegendsController::GET #new: test_0001_must succeed
-------------------------------------------------------------
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mButtafly::Spreadsheet Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "buttafly_spreadsheets"  WHERE "buttafly_spreadsheets"."name" = 'test_file_name9' LIMIT 1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO "buttafly_spreadsheets" ("aasm_state", "created_at", "data", "flat_file", "name", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["aasm_state", "not_imported"], ["created_at", "2014-11-17 01:58:46.580436"], ["data", "{}"], ["flat_file", "family.odt.csv"], ["name", "test_file_name9"], ["updated_at", "2014-11-17 01:58:46.580436"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "buttafly_mappings" ("created_at", "originable_id", "originable_type", "targetable_model", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["created_at", "2014-11-17 01:58:46.583502"], ["originable_id", 53], ["originable_type", "Buttafly::Spreadsheet"], ["targetable_model", "DummyChild"], ["updated_at", "2014-11-17 01:58:46.583502"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by Buttafly::LegendsController#new as HTML
  Parameters: {"mapping_id"=>"22"}
  [1m[36mButtafly::Mapping Load (0.3ms)[0m  [1mSELECT  "buttafly_mappings".* FROM "buttafly_mappings"  WHERE "buttafly_mappings"."id" = $1 LIMIT 1[0m  [["id", 22]]
  [1m[35mButtafly::Spreadsheet Load (0.2ms)[0m  SELECT  "buttafly_spreadsheets".* FROM "buttafly_spreadsheets"  WHERE "buttafly_spreadsheets"."id" = $1 LIMIT 1  [["id", 53]]
  Rendered application/_messages.html.haml (0.1ms)
Completed 200 OK in 17ms (Views: 13.1ms | ActiveRecord: 0.4ms)
  [1m[36m (0.2ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.2ms)[0m  BEGIN
------------------------------------------------------------------------------------------------
Buttafly::LegendsController::GET #new: test_0002_must instantiate a legend from existing mapping
------------------------------------------------------------------------------------------------
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mButtafly::Spreadsheet Exists (0.3ms)[0m  SELECT  1 AS one FROM "buttafly_spreadsheets"  WHERE "buttafly_spreadsheets"."name" = 'test_file_name10' LIMIT 1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO "buttafly_spreadsheets" ("aasm_state", "created_at", "data", "flat_file", "name", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["aasm_state", "not_imported"], ["created_at", "2014-11-17 01:58:46.610196"], ["data", "{}"], ["flat_file", "family.odt.csv"], ["name", "test_file_name10"], ["updated_at", "2014-11-17 01:58:46.610196"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "buttafly_mappings" ("created_at", "originable_id", "originable_type", "targetable_model", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["created_at", "2014-11-17 01:58:46.613215"], ["originable_id", 54], ["originable_type", "Buttafly::Spreadsheet"], ["targetable_model", "DummyChild"], ["updated_at", "2014-11-17 01:58:46.613215"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by Buttafly::LegendsController#new as HTML
  Parameters: {"mapping_id"=>"23"}
  [1m[35mButtafly::Mapping Load (0.3ms)[0m  SELECT  "buttafly_mappings".* FROM "buttafly_mappings"  WHERE "buttafly_mappings"."id" = $1 LIMIT 1  [["id", 23]]
  [1m[36mButtafly::Spreadsheet Load (0.2ms)[0m  [1mSELECT  "buttafly_spreadsheets".* FROM "buttafly_spreadsheets"  WHERE "buttafly_spreadsheets"."id" = $1 LIMIT 1[0m  [["id", 54]]
  Rendered application/_messages.html.haml (0.1ms)
Completed 200 OK in 11ms (Views: 7.7ms | ActiveRecord: 0.5ms)
  [1m[35m (0.2ms)[0m  ROLLBACK
  [1m[36m (0.2ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  COMMIT
  [1m[36m (0.2ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  COMMIT
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  COMMIT
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
---------------------------------------------
create legend Feature Test: test_0001_success
---------------------------------------------
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mButtafly::Spreadsheet Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "buttafly_spreadsheets"  WHERE "buttafly_spreadsheets"."name" = 'test_file_name14' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "buttafly_spreadsheets" ("aasm_state", "created_at", "data", "flat_file", "name", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["aasm_state", "not_imported"], ["created_at", "2014-11-17 01:58:46.641905"], ["data", "{}"], ["flat_file", "family.odt.csv"], ["name", "test_file_name14"], ["updated_at", "2014-11-17 01:58:46.641905"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO "buttafly_mappings" ("created_at", "originable_id", "originable_type", "targetable_model", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["created_at", "2014-11-17 01:58:46.644887"], ["originable_id", 55], ["originable_type", "Buttafly::Spreadsheet"], ["targetable_model", "DummyChild"], ["updated_at", "2014-11-17 01:58:46.644887"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Started GET "/buttafly/contents" for 127.0.0.1 at 2014-11-16 17:58:46 -0800
Processing by Buttafly::ContentsController#index as HTML
  Rendered /home/fred/work/opensource/buttafly/app/views/buttafly/contents/_form.html.haml (1.9ms)
  [1m[36mButtafly::Spreadsheet Load (0.4ms)[0m  [1mSELECT  "buttafly_spreadsheets".* FROM "buttafly_spreadsheets"   ORDER BY "buttafly_spreadsheets"."created_at" ASC LIMIT 5 OFFSET 0[0m
  [1m[35mButtafly::Mapping Load (0.3ms)[0m  SELECT "buttafly_mappings".* FROM "buttafly_mappings"  WHERE "buttafly_mappings"."originable_id" = $1 AND "buttafly_mappings"."originable_type" = $2  [["originable_id", 55], ["originable_type", "Buttafly::Spreadsheet"]]
  [1m[36mButtafly::Legend Load (0.2ms)[0m  [1mSELECT "buttafly_legends".* FROM "buttafly_legends"[0m
  Rendered /home/fred/work/opensource/buttafly/app/views/buttafly/contents/_content.html.haml (5.4ms)
  [1m[35m (0.3ms)[0m  SELECT COUNT(*) FROM "buttafly_spreadsheets"
  Rendered application/_messages.html.haml (0.2ms)
Completed 200 OK in 14ms (Views: 11.0ms | ActiveRecord: 1.2ms)
Started GET "/buttafly/legends/new?mapping_id=24" for 127.0.0.1 at 2014-11-16 17:58:46 -0800
Processing by Buttafly::LegendsController#new as HTML
  Parameters: {"mapping_id"=>"24"}
  [1m[36mButtafly::Mapping Load (0.3ms)[0m  [1mSELECT  "buttafly_mappings".* FROM "buttafly_mappings"  WHERE "buttafly_mappings"."id" = $1 LIMIT 1[0m  [["id", 24]]
  [1m[35mButtafly::Spreadsheet Load (0.2ms)[0m  SELECT  "buttafly_spreadsheets".* FROM "buttafly_spreadsheets"  WHERE "buttafly_spreadsheets"."id" = $1 LIMIT 1  [["id", 55]]
  Rendered application/_messages.html.haml (0.2ms)
Completed 200 OK in 11ms (Views: 7.7ms | ActiveRecord: 0.5ms)
  [1m[36m (0.2ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36mButtafly::Spreadsheet Exists (0.4ms)[0m  [1mSELECT  1 AS one FROM "buttafly_spreadsheets"  WHERE "buttafly_spreadsheets"."name" = 'test_file_name15' LIMIT 1[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  COMMIT
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  COMMIT
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
-----------------------------------------------
create content Feature Test: test_0001_success 
-----------------------------------------------
Started GET "/buttafly/contents" for 127.0.0.1 at 2014-11-16 17:58:46 -0800
Processing by Buttafly::ContentsController#index as HTML
  Rendered /home/fred/work/opensource/buttafly/app/views/buttafly/contents/_form.html.haml (1.9ms)
  [1m[35mButtafly::Spreadsheet Load (0.4ms)[0m  SELECT  "buttafly_spreadsheets".* FROM "buttafly_spreadsheets"   ORDER BY "buttafly_spreadsheets"."created_at" ASC LIMIT 5 OFFSET 0
  [1m[36m (0.2ms)[0m  [1mSELECT COUNT(*) FROM "buttafly_spreadsheets"[0m
  Rendered application/_messages.html.haml (0.2ms)
Completed 200 OK in 8ms (Views: 5.7ms | ActiveRecord: 0.6ms)
Started POST "/buttafly/contents" for 127.0.0.1 at 2014-11-16 17:58:46 -0800
Processing by Buttafly::ContentsController#create as HTML
  Parameters: {"utf8"=>"âœ“", "originable"=>{"name"=>"pinot noirs", "flat_file"=>#<ActionDispatch::Http::UploadedFile:0x007f7de0ee02b8 @tempfile=#<Tempfile:/tmp/RackMultipart20141116-3333-1mzy078>, @original_filename="family.odt.csv", @content_type="text/comma-separated-values", @headers="Content-Disposition: form-data; name=\"originable[flat_file]\"; filename=\"family.odt.csv\"\r\nContent-Type: text/comma-separated-values\r\nContent-Length: 117\r\n">}, "commit"=>"Upload file"}
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mButtafly::Spreadsheet Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "buttafly_spreadsheets"  WHERE "buttafly_spreadsheets"."name" = 'pinot noirs' LIMIT 1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO "buttafly_spreadsheets" ("aasm_state", "created_at", "flat_file", "name", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["aasm_state", "not_imported"], ["created_at", "2014-11-17 01:58:46.779047"], ["flat_file", "family.odt.csv"], ["name", "pinot noirs"], ["updated_at", "2014-11-17 01:58:46.779047"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/buttafly/contents
Completed 302 Found in 10ms (ActiveRecord: 0.9ms)
Started GET "/buttafly/contents" for 127.0.0.1 at 2014-11-16 17:58:46 -0800
Processing by Buttafly::ContentsController#index as HTML
  Rendered /home/fred/work/opensource/buttafly/app/views/buttafly/contents/_form.html.haml (1.8ms)
  [1m[35mButtafly::Spreadsheet Load (0.4ms)[0m  SELECT  "buttafly_spreadsheets".* FROM "buttafly_spreadsheets"   ORDER BY "buttafly_spreadsheets"."created_at" ASC LIMIT 5 OFFSET 0
  [1m[36mButtafly::Mapping Load (0.3ms)[0m  [1mSELECT "buttafly_mappings".* FROM "buttafly_mappings"  WHERE "buttafly_mappings"."originable_id" = $1 AND "buttafly_mappings"."originable_type" = $2[0m  [["originable_id", 56], ["originable_type", "Buttafly::Spreadsheet"]]
  [1m[35mButtafly::Legend Load (0.2ms)[0m  SELECT "buttafly_legends".* FROM "buttafly_legends"
  Rendered /home/fred/work/opensource/buttafly/app/views/buttafly/contents/_content.html.haml (4.8ms)
  [1m[36m (0.3ms)[0m  [1mSELECT COUNT(*) FROM "buttafly_spreadsheets"[0m
  Rendered application/_messages.html.haml (0.6ms)
Completed 200 OK in 13ms (Views: 10.6ms | ActiveRecord: 1.2ms)
  [1m[35m (0.5ms)[0m  SELECT COUNT(*) FROM "buttafly_spreadsheets"  WHERE "buttafly_spreadsheets"."name" = 'pinot noirs'
  [1m[36m (0.2ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
-----------------------------------------------------------
create content Feature Test: test_0002_fail renders message
-----------------------------------------------------------
Started GET "/buttafly/contents" for 127.0.0.1 at 2014-11-16 17:58:46 -0800
Processing by Buttafly::ContentsController#index as HTML
  Rendered /home/fred/work/opensource/buttafly/app/views/buttafly/contents/_form.html.haml (2.1ms)
  [1m[36mButtafly::Spreadsheet Load (0.5ms)[0m  [1mSELECT  "buttafly_spreadsheets".* FROM "buttafly_spreadsheets"   ORDER BY "buttafly_spreadsheets"."created_at" ASC LIMIT 5 OFFSET 0[0m
  [1m[35m (0.3ms)[0m  SELECT COUNT(*) FROM "buttafly_spreadsheets"
  Rendered application/_messages.html.haml (0.4ms)
Completed 200 OK in 10ms (Views: 7.1ms | ActiveRecord: 0.8ms)
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mButtafly::Spreadsheet Exists (0.4ms)[0m  SELECT  1 AS one FROM "buttafly_spreadsheets"  WHERE "buttafly_spreadsheets"."name" = 'test_file_name16' LIMIT 1
  [1m[36mSQL (0.4ms)[0m  [1mINSERT INTO "buttafly_spreadsheets" ("aasm_state", "created_at", "data", "flat_file", "name", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["aasm_state", "not_imported"], ["created_at", "2014-11-17 01:58:46.825325"], ["data", "[{\"mother\":\"Sarah Jane Schoeneman\",\"child\":\"Ella Mac Pacurar\",\"grandparent\":\"Vicki Pacurar\"}]"], ["flat_file", "family.odt.csv"], ["name", "test_file_name16"], ["updated_at", "2014-11-17 01:58:46.825325"]]
  [1m[35m (0.2ms)[0m  RELEASE SAVEPOINT active_record_1
Started POST "/buttafly/contents" for 127.0.0.1 at 2014-11-16 17:58:46 -0800
Processing by Buttafly::ContentsController#create as HTML
  Parameters: {"utf8"=>"âœ“", "originable"=>{"name"=>"test_file_name16", "flat_file"=>#<ActionDispatch::Http::UploadedFile:0x007f7de31141e0 @tempfile=#<Tempfile:/tmp/RackMultipart20141116-3333-cx2ktg>, @original_filename="family.odt.csv", @content_type="text/comma-separated-values", @headers="Content-Disposition: form-data; name=\"originable[flat_file]\"; filename=\"family.odt.csv\"\r\nContent-Type: text/comma-separated-values\r\nContent-Length: 117\r\n">}, "commit"=>"Upload file"}
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mButtafly::Spreadsheet Exists (0.5ms)[0m  SELECT  1 AS one FROM "buttafly_spreadsheets"  WHERE "buttafly_spreadsheets"."name" = 'test_file_name16' LIMIT 1
  [1m[36m (0.2ms)[0m  [1mROLLBACK TO SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/buttafly/
Completed 302 Found in 6ms (ActiveRecord: 0.8ms)
Started GET "/buttafly/" for 127.0.0.1 at 2014-11-16 17:58:46 -0800
Processing by Buttafly::ContentsController#index as HTML
  Rendered /home/fred/work/opensource/buttafly/app/views/buttafly/contents/_form.html.haml (2.7ms)
  [1m[35mButtafly::Spreadsheet Load (0.4ms)[0m  SELECT  "buttafly_spreadsheets".* FROM "buttafly_spreadsheets"   ORDER BY "buttafly_spreadsheets"."created_at" ASC LIMIT 5 OFFSET 0
  [1m[36mButtafly::Mapping Load (0.4ms)[0m  [1mSELECT "buttafly_mappings".* FROM "buttafly_mappings"  WHERE "buttafly_mappings"."originable_id" = $1 AND "buttafly_mappings"."originable_type" = $2[0m  [["originable_id", 57], ["originable_type", "Buttafly::Spreadsheet"]]
  [1m[35mButtafly::Legend Load (0.3ms)[0m  SELECT "buttafly_legends".* FROM "buttafly_legends"
  Rendered /home/fred/work/opensource/buttafly/app/views/buttafly/contents/_content.html.haml (5.6ms)
  [1m[36m (0.3ms)[0m  [1mSELECT COUNT(*) FROM "buttafly_spreadsheets"[0m
  Rendered application/_messages.html.haml (0.6ms)
Completed 200 OK in 16ms (Views: 12.9ms | ActiveRecord: 1.5ms)
  [1m[35m (0.4ms)[0m  SELECT COUNT(*) FROM "buttafly_spreadsheets"  WHERE "buttafly_spreadsheets"."name" = 'pinot noirs'
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
-------------------------
RoutesTest: test_messages
-------------------------
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36mButtafly::Spreadsheet Exists (0.4ms)[0m  [1mSELECT  1 AS one FROM "buttafly_spreadsheets"  WHERE "buttafly_spreadsheets"."name" = 'test_file_name17' LIMIT 1[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  COMMIT
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  COMMIT
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mButtafly::Spreadsheet Exists (0.4ms)[0m  SELECT  1 AS one FROM "buttafly_spreadsheets"  WHERE "buttafly_spreadsheets"."name" = 'test_file_name18' LIMIT 1
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36mButtafly::Spreadsheet Exists (0.4ms)[0m  [1mSELECT  1 AS one FROM "buttafly_spreadsheets"  WHERE "buttafly_spreadsheets"."name" = 'test_file_name19' LIMIT 1[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
-----------------------------
ButtaflyTest: test_0001_truth
-----------------------------
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  COMMIT
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mButtafly::Spreadsheet Exists (0.4ms)[0m  SELECT  1 AS one FROM "buttafly_spreadsheets"  WHERE "buttafly_spreadsheets"."name" = 'test_file_name20' LIMIT 1
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36mButtafly::Spreadsheet Exists (0.4ms)[0m  [1mSELECT  1 AS one FROM "buttafly_spreadsheets"  WHERE "buttafly_spreadsheets"."name" = 'test_file_name21' LIMIT 1[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  COMMIT
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "dummy_tribes" ("created_at", "name", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["created_at", "2014-11-17 01:58:46.904078"], ["name", "MyString"], ["updated_at", "2014-11-17 01:58:46.904078"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "dummy_tribes" ("created_at", "name", "updated_at") VALUES ($1, $2, $3) RETURNING "id"  [["created_at", "2014-11-17 01:58:46.912018"], ["name", "MyString"], ["updated_at", "2014-11-17 01:58:46.912018"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  COMMIT
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  COMMIT
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mButtafly::Spreadsheet Exists (0.4ms)[0m  [1mSELECT  1 AS one FROM "buttafly_spreadsheets"  WHERE "buttafly_spreadsheets"."name" = 'test_file_name22' LIMIT 1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO "buttafly_spreadsheets" ("aasm_state", "created_at", "data", "flat_file", "name", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["aasm_state", "not_imported"], ["created_at", "2014-11-17 01:58:46.923100"], ["data", "{}"], ["flat_file", "family.odt.csv"], ["name", "test_file_name22"], ["updated_at", "2014-11-17 01:58:46.923100"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "buttafly_mappings" ("created_at", "originable_id", "originable_type", "targetable_model", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["created_at", "2014-11-17 01:58:46.926258"], ["originable_id", 58], ["originable_type", "Buttafly::Spreadsheet"], ["targetable_model", "DummyChild"], ["updated_at", "2014-11-17 01:58:46.926258"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  ROLLBACK TO SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
---------------------------------------------------------
Buttafly::MappingsController: test_0001_must POST #create
---------------------------------------------------------
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mButtafly::Spreadsheet Exists (0.4ms)[0m  SELECT  1 AS one FROM "buttafly_spreadsheets"  WHERE "buttafly_spreadsheets"."name" = 'test_file_name23' LIMIT 1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO "buttafly_spreadsheets" ("aasm_state", "created_at", "data", "flat_file", "name", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["aasm_state", "not_imported"], ["created_at", "2014-11-17 01:58:46.939026"], ["data", "[{\"mother\":\"Sarah Jane Schoeneman\",\"child\":\"Ella Mac Pacurar\",\"grandparent\":\"Vicki Pacurar\"}]"], ["flat_file", "family.odt.csv"], ["name", "test_file_name23"], ["updated_at", "2014-11-17 01:58:46.939026"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by Buttafly::MappingsController#create as HTML
  Parameters: {"mapping"=>{"originable_id"=>"59", "targetable_model"=>"DummyChild"}}
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mButtafly::Spreadsheet Load (0.2ms)[0m  SELECT  "buttafly_spreadsheets".* FROM "buttafly_spreadsheets"  WHERE "buttafly_spreadsheets"."id" = $1 LIMIT 1  [["id", 59]]
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "buttafly_mappings" ("created_at", "originable_id", "originable_type", "targetable_model", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["created_at", "2014-11-17 01:58:46.946490"], ["originable_id", 59], ["originable_type", "Buttafly::Spreadsheet"], ["targetable_model", "DummyChild"], ["updated_at", "2014-11-17 01:58:46.946490"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to /referring/url
Completed 302 Found in 4ms (ActiveRecord: 0.7ms)
  [1m[36mButtafly::Mapping Load (0.4ms)[0m  [1mSELECT  "buttafly_mappings".* FROM "buttafly_mappings"  WHERE "buttafly_mappings"."originable_id" = $1 AND "buttafly_mappings"."originable_type" = $2  ORDER BY "buttafly_mappings"."id" ASC LIMIT 1[0m  [["originable_id", 59], ["originable_type", "Buttafly::Spreadsheet"]]
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
-------------------------------------------------------------
Buttafly::MappingsController: test_0002_must 'DELETE' destroy
-------------------------------------------------------------
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mButtafly::Spreadsheet Exists (0.4ms)[0m  [1mSELECT  1 AS one FROM "buttafly_spreadsheets"  WHERE "buttafly_spreadsheets"."name" = 'test_file_name24' LIMIT 1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO "buttafly_spreadsheets" ("aasm_state", "created_at", "data", "flat_file", "name", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["aasm_state", "not_imported"], ["created_at", "2014-11-17 01:58:46.955580"], ["data", "{}"], ["flat_file", "family.odt.csv"], ["name", "test_file_name24"], ["updated_at", "2014-11-17 01:58:46.955580"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "buttafly_mappings" ("created_at", "originable_id", "originable_type", "targetable_model", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["created_at", "2014-11-17 01:58:46.958682"], ["originable_id", 60], ["originable_type", "Buttafly::Spreadsheet"], ["targetable_model", "DummyChild"], ["updated_at", "2014-11-17 01:58:46.958682"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.3ms)[0m  [1mSELECT COUNT(*) FROM "buttafly_mappings"[0m
Processing by Buttafly::MappingsController#destroy as HTML
  Parameters: {"id"=>"27"}
  [1m[35mButtafly::Mapping Load (0.3ms)[0m  SELECT  "buttafly_mappings".* FROM "buttafly_mappings"  WHERE "buttafly_mappings"."id" = $1 LIMIT 1  [["id", 27]]
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  DELETE FROM "buttafly_mappings" WHERE "buttafly_mappings"."id" = $1  [["id", 27]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to /referring/url
Completed 302 Found in 2ms (ActiveRecord: 0.7ms)
  [1m[35m (0.2ms)[0m  SELECT COUNT(*) FROM "buttafly_mappings"
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
-----------------------------------------------------------------------------
Buttafly::LegendsController::POST #create: test_0001_must create a new legend
-----------------------------------------------------------------------------
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mButtafly::Spreadsheet Exists (0.3ms)[0m  SELECT  1 AS one FROM "buttafly_spreadsheets"  WHERE "buttafly_spreadsheets"."name" = 'test_file_name25' LIMIT 1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO "buttafly_spreadsheets" ("aasm_state", "created_at", "data", "flat_file", "name", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["aasm_state", "not_imported"], ["created_at", "2014-11-17 01:58:46.983666"], ["data", "{}"], ["flat_file", "family.odt.csv"], ["name", "test_file_name25"], ["updated_at", "2014-11-17 01:58:46.983666"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO "buttafly_mappings" ("created_at", "originable_id", "originable_type", "targetable_model", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["created_at", "2014-11-17 01:58:46.986778"], ["originable_id", 61], ["originable_type", "Buttafly::Spreadsheet"], ["targetable_model", "DummyChild"], ["updated_at", "2014-11-17 01:58:46.986778"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by Buttafly::LegendsController#create as HTML
  Parameters: {"mapping_id"=>"28"}
Completed 500 Internal Server Error in 477787ms
  [1m[35m (0.3ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  COMMIT
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  COMMIT
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mButtafly::Spreadsheet Exists (0.5ms)[0m  [1mSELECT  1 AS one FROM "buttafly_spreadsheets"  WHERE "buttafly_spreadsheets"."name" = 'test_file_name26' LIMIT 1[0m
  [1m[35mSQL (0.4ms)[0m  INSERT INTO "buttafly_spreadsheets" ("aasm_state", "created_at", "data", "flat_file", "name", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["aasm_state", "not_imported"], ["created_at", "2014-11-17 02:06:44.787250"], ["data", "{}"], ["flat_file", "family.odt.csv"], ["name", "test_file_name26"], ["updated_at", "2014-11-17 02:06:44.787250"]]
  [1m[36m (0.2ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mButtafly::Spreadsheet Exists (0.4ms)[0m  [1mSELECT  1 AS one FROM "buttafly_spreadsheets"  WHERE ("buttafly_spreadsheets"."name" = 'test_file_name26' AND "buttafly_spreadsheets"."id" != 62) LIMIT 1[0m
  [1m[35mSQL (0.3ms)[0m  UPDATE "buttafly_spreadsheets" SET "data" = $1, "imported_at" = $2, "updated_at" = $3 WHERE "buttafly_spreadsheets"."id" = 62  [["data", "[{\"child name\":\"ella mac\",\"parent name\":\"sara\",\"grandparent name\":\"kc shekhar\",\"tribe name\":\"india\",\"age\":\"2.5\"},{\"child name\":\"rohan\",\"parent name\":\"doug\",\"grandparent name\":\"vicki\",\"tribe name\":\"america\",\"age\":\"6\"}]"], ["imported_at", "2014-11-17 02:06:44.790744"], ["updated_at", "2014-11-17 02:06:44.793846"]]
  [1m[36mButtafly::Spreadsheet Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "buttafly_spreadsheets"  WHERE ("buttafly_spreadsheets"."name" = 'test_file_name26' AND "buttafly_spreadsheets"."id" != 62) LIMIT 1[0m
  [1m[35mSQL (0.3ms)[0m  UPDATE "buttafly_spreadsheets" SET "aasm_state" = $1, "updated_at" = $2 WHERE "buttafly_spreadsheets"."id" = 62  [["aasm_state", "imported"], ["updated_at", "2014-11-17 02:06:44.797649"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  COMMIT
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mButtafly::Spreadsheet Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "buttafly_spreadsheets"  WHERE "buttafly_spreadsheets"."name" = 'test_file_name27' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "buttafly_spreadsheets" ("aasm_state", "created_at", "data", "flat_file", "name", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["aasm_state", "not_imported"], ["created_at", "2014-11-17 02:06:44.804320"], ["data", "{}"], ["flat_file", "family.odt.csv"], ["name", "test_file_name27"], ["updated_at", "2014-11-17 02:06:44.804320"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mButtafly::Spreadsheet Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "buttafly_spreadsheets"  WHERE ("buttafly_spreadsheets"."name" = 'test_file_name27' AND "buttafly_spreadsheets"."id" != 63) LIMIT 1[0m
  [1m[35mSQL (0.3ms)[0m  UPDATE "buttafly_spreadsheets" SET "data" = $1, "updated_at" = $2 WHERE "buttafly_spreadsheets"."id" = 63  [["data", "[{\"child name\":\"ella mac\",\"parent name\":\"sara\",\"grandparent name\":\"kc shekhar\",\"tribe name\":\"india\",\"age\":\"2.5\"},{\"child name\":\"rohan\",\"parent name\":\"doug\",\"grandparent name\":\"vicki\",\"tribe name\":\"america\",\"age\":\"6\"}]"], ["updated_at", "2014-11-17 02:06:44.809183"]]
  [1m[36m (0.2ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  COMMIT
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mButtafly::Spreadsheet Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "buttafly_spreadsheets"  WHERE "buttafly_spreadsheets"."name" = 'test_file_name28' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "buttafly_spreadsheets" ("aasm_state", "created_at", "data", "flat_file", "name", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["aasm_state", "not_imported"], ["created_at", "2014-11-17 02:06:44.816552"], ["data", "{}"], ["flat_file", "family.odt.csv"], ["name", "test_file_name28"], ["updated_at", "2014-11-17 02:06:44.816552"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.8ms)[0m  [1mINSERT INTO "buttafly_legends" ("created_at", "data", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["created_at", "2014-11-17 02:06:44.820034"], ["data", "{\"meta\":{\"col_sep\":\",\",\"encoding\":\"utf-8\",\"row_sep\":\"/n\",\"headers\":[\"mother\",\"child\",\"grandparent\"]},\"dummy_child\":{\"name\":\"child\",\"dummy_parent\":{\"name\":\"mother\",\"dummy_grandparent\":{\"name\":\"grandparent\"}}}}"], ["updated_at", "2014-11-17 02:06:44.820034"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[36mSQL (0.4ms)[0m  [1mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (11.1ms)[0m  CREATE TABLE "buttafly_legends" ("id" serial primary key, "cartographer_id" integer, "data" json, "name" character varying(255), "created_at" timestamp, "updated_at" timestamp) 
  [1m[36m (10.6ms)[0m  [1mCREATE TABLE "buttafly_mappings" ("id" serial primary key, "legend_id" integer, "originable_id" integer, "originable_type" character varying(255), "targetable_model" character varying(255), "created_at" timestamp, "updated_at" timestamp) [0m
  [1m[35m (8.6ms)[0m  CREATE  INDEX  "index_buttafly_mappings_on_legend_id" ON "buttafly_mappings" USING btree ("legend_id")
  [1m[36m (8.7ms)[0m  [1mCREATE  INDEX  "index_buttafly_mappings_on_originable_id_and_originable_type" ON "buttafly_mappings" USING btree ("originable_id", "originable_type")[0m
  [1m[35m (15.7ms)[0m  CREATE TABLE "buttafly_spreadsheets" ("id" serial primary key, "data" json, "name" character varying(255), "user_id" integer, "imported_at" timestamp, "processed_at" timestamp, "aasm_state" character varying(255), "source_row_count" integer, "mtime" integer, "created_at" timestamp, "updated_at" timestamp, "flat_file" character varying(255)) 
  [1m[36m (8.6ms)[0m  [1mCREATE  INDEX  "index_buttafly_spreadsheets_on_aasm_state" ON "buttafly_spreadsheets" USING btree ("aasm_state")[0m
  [1m[35m (3.2ms)[0m  CREATE  INDEX  "index_buttafly_spreadsheets_on_imported_at" ON "buttafly_spreadsheets" USING btree ("imported_at")
  [1m[36m (3.0ms)[0m  [1mCREATE  INDEX  "index_buttafly_spreadsheets_on_name" ON "buttafly_spreadsheets" USING btree ("name")[0m
  [1m[35m (3.0ms)[0m  CREATE  INDEX  "index_buttafly_spreadsheets_on_processed_at" ON "buttafly_spreadsheets" USING btree ("processed_at")
  [1m[36m (3.0ms)[0m  [1mCREATE  INDEX  "index_buttafly_spreadsheets_on_user_id" ON "buttafly_spreadsheets" USING btree ("user_id")[0m
  [1m[35m (4.4ms)[0m  CREATE TABLE "dummy_children" ("id" serial primary key, "name" character varying(255), "dummy_parent_id" integer, "dummy_tribe_id" integer, "created_at" timestamp, "updated_at" timestamp, "age" integer) 
  [1m[36m (6.0ms)[0m  [1mCREATE TABLE "dummy_grandparents" ("id" serial primary key, "name" character varying(255), "dummy_tribe_id" integer, "created_at" timestamp, "updated_at" timestamp) [0m
  [1m[35m (9.6ms)[0m  CREATE TABLE "dummy_parents" ("id" serial primary key, "name" character varying(255), "dummy_grandparent_id" integer, "dummy_tribe_id" integer, "created_at" timestamp, "updated_at" timestamp) 
  [1m[36m (11.9ms)[0m  [1mCREATE TABLE "dummy_tribes" ("id" serial primary key, "name" character varying(255), "created_at" timestamp, "updated_at" timestamp) [0m
  [1m[35m (10.0ms)[0m  CREATE TABLE "users" ("id" serial primary key, "name" character varying(255), "created_at" timestamp, "updated_at" timestamp) 
  [1m[36m (3.5ms)[0m  [1mCREATE TABLE "schema_migrations" ("version" character varying(255) NOT NULL) [0m
  [1m[35m (8.3ms)[0m  CREATE UNIQUE INDEX  "unique_schema_migrations" ON "schema_migrations"  ("version")
  [1m[36m (0.4ms)[0m  [1mSELECT version FROM "schema_migrations"[0m
  [1m[35m (3.0ms)[0m  INSERT INTO "schema_migrations" (version) VALUES ('20141109071108')
  [1m[36m (3.1ms)[0m  [1mINSERT INTO "schema_migrations" (version) VALUES ('20140917185910')[0m
  [1m[35m (3.0ms)[0m  INSERT INTO "schema_migrations" (version) VALUES ('20140917190530')
  [1m[36m (1.3ms)[0m  [1mINSERT INTO "schema_migrations" (version) VALUES ('20140917190801')[0m
  [1m[35m (1.5ms)[0m  INSERT INTO "schema_migrations" (version) VALUES ('20140919055223')
  [1m[36m (1.3ms)[0m  [1mINSERT INTO "schema_migrations" (version) VALUES ('20140916214009')[0m
  [1m[35mActiveRecord::SchemaMigration Load (0.4ms)[0m  SELECT "schema_migrations".* FROM "schema_migrations"
  [1m[36m (0.2ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  COMMIT
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.2ms)[0m  ROLLBACK
  [1m[36m (0.2ms)[0m  [1mBEGIN[0m
  [1m[35m (0.2ms)[0m  COMMIT
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  COMMIT
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  COMMIT
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.6ms)[0m  [1mINSERT INTO "dummy_tribes" ("created_at", "name", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["created_at", "2014-11-17 02:18:52.526351"], ["name", "MyString"], ["updated_at", "2014-11-17 02:18:52.526351"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.4ms)[0m  INSERT INTO "dummy_grandparents" ("created_at", "dummy_tribe_id", "name", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"  [["created_at", "2014-11-17 02:18:52.536710"], ["dummy_tribe_id", 1], ["name", "Vicki Pacurar"], ["updated_at", "2014-11-17 02:18:52.536710"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO "dummy_tribes" ("created_at", "name", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["created_at", "2014-11-17 02:18:52.540048"], ["name", "MyString"], ["updated_at", "2014-11-17 02:18:52.540048"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.4ms)[0m  INSERT INTO "dummy_parents" ("created_at", "dummy_grandparent_id", "dummy_tribe_id", "name", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["created_at", "2014-11-17 02:18:52.542739"], ["dummy_grandparent_id", 1], ["dummy_tribe_id", 2], ["name", "Sarah Jane Schoeneman"], ["updated_at", "2014-11-17 02:18:52.542739"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "dummy_tribes" ("created_at", "name", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["created_at", "2014-11-17 02:18:52.545863"], ["name", "MyString"], ["updated_at", "2014-11-17 02:18:52.545863"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36mButtafly::Spreadsheet Exists (0.9ms)[0m  [1mSELECT  1 AS one FROM "buttafly_spreadsheets"  WHERE "buttafly_spreadsheets"."name" = 'test_file_name1' LIMIT 1[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  COMMIT
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.2ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  COMMIT
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mButtafly::Spreadsheet Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "buttafly_spreadsheets"  WHERE "buttafly_spreadsheets"."name" = 'test_file_name2' LIMIT 1[0m
  [1m[35mSQL (0.6ms)[0m  INSERT INTO "buttafly_spreadsheets" ("aasm_state", "created_at", "data", "flat_file", "name", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["aasm_state", "imported"], ["created_at", "2014-11-17 02:18:52.577205"], ["data", "[{\"mother\":\"Sarah Jane Schoeneman\",\"child\":\"Ella Mac Pacurar\",\"grandparent\":\"Vicki Pacurar\"}]"], ["flat_file", "family.odt.csv"], ["name", "test_file_name2"], ["updated_at", "2014-11-17 02:18:52.577205"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35mButtafly::Spreadsheet Load (0.4ms)[0m  SELECT  "buttafly_spreadsheets".* FROM "buttafly_spreadsheets"  WHERE "buttafly_spreadsheets"."id" = $1 LIMIT 1  [["id", 1]]
  [1m[36m (0.2ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36mButtafly::Spreadsheet Exists (0.5ms)[0m  [1mSELECT  1 AS one FROM "buttafly_spreadsheets"  WHERE "buttafly_spreadsheets"."name" = 'test_file_name3' LIMIT 1[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  COMMIT
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  COMMIT
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  COMMIT
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  COMMIT
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  COMMIT
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  COMMIT
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO "dummy_tribes" ("created_at", "name", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["created_at", "2014-11-17 02:18:52.604247"], ["name", "MyString"], ["updated_at", "2014-11-17 02:18:52.604247"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
-----------------------------------------------
create content Feature Test: test_0001_success 
-----------------------------------------------
Started GET "/buttafly/contents" for 127.0.0.1 at 2014-11-16 18:18:52 -0800
Processing by Buttafly::ContentsController#index as HTML
  Rendered /home/fred/work/opensource/buttafly/app/views/buttafly/contents/_form.html.haml (7.0ms)
  [1m[36mButtafly::Spreadsheet Load (0.7ms)[0m  [1mSELECT  "buttafly_spreadsheets".* FROM "buttafly_spreadsheets"   ORDER BY "buttafly_spreadsheets"."created_at" ASC LIMIT 5 OFFSET 0[0m
  [1m[35m (0.3ms)[0m  SELECT COUNT(*) FROM "buttafly_spreadsheets"
  Rendered /home/fred/work/opensource/buttafly/app/views/buttafly/contents/index.html.haml within layouts/application (20.5ms)
  Rendered application/_messages.html.haml (13.4ms)
Completed 200 OK in 88ms (Views: 79.1ms | ActiveRecord: 2.9ms)
Started POST "/buttafly/contents" for 127.0.0.1 at 2014-11-16 18:18:52 -0800
Processing by Buttafly::ContentsController#create as HTML
  Parameters: {"utf8"=>"âœ“", "originable"=>{"name"=>"pinot noirs", "flat_file"=>#<ActionDispatch::Http::UploadedFile:0x007fa0029728a0 @tempfile=#<Tempfile:/tmp/RackMultipart20141116-4351-t2gsoe>, @original_filename="family.odt.csv", @content_type="text/comma-separated-values", @headers="Content-Disposition: form-data; name=\"originable[flat_file]\"; filename=\"family.odt.csv\"\r\nContent-Type: text/comma-separated-values\r\nContent-Length: 117\r\n">}, "commit"=>"Upload file"}
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mButtafly::Spreadsheet Exists (0.3ms)[0m  SELECT  1 AS one FROM "buttafly_spreadsheets"  WHERE "buttafly_spreadsheets"."name" = 'pinot noirs' LIMIT 1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO "buttafly_spreadsheets" ("aasm_state", "created_at", "flat_file", "name", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["aasm_state", "not_imported"], ["created_at", "2014-11-17 02:18:52.753624"], ["flat_file", "family.odt.csv"], ["name", "pinot noirs"], ["updated_at", "2014-11-17 02:18:52.753624"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://www.example.com/buttafly/contents
Completed 302 Found in 8ms (ActiveRecord: 0.9ms)
Started GET "/buttafly/contents" for 127.0.0.1 at 2014-11-16 18:18:52 -0800
Processing by Buttafly::ContentsController#index as HTML
  Rendered /home/fred/work/opensource/buttafly/app/views/buttafly/contents/_form.html.haml (1.8ms)
  [1m[36mButtafly::Spreadsheet Load (0.4ms)[0m  [1mSELECT  "buttafly_spreadsheets".* FROM "buttafly_spreadsheets"   ORDER BY "buttafly_spreadsheets"."created_at" ASC LIMIT 5 OFFSET 0[0m
  [1m[35mButtafly::Mapping Load (0.5ms)[0m  SELECT "buttafly_mappings".* FROM "buttafly_mappings"  WHERE "buttafly_mappings"."originable_id" = $1 AND "buttafly_mappings"."originable_type" = $2  [["originable_id", 2], ["originable_type", "Buttafly::Spreadsheet"]]
  [1m[36mButtafly::Legend Load (0.5ms)[0m  [1mSELECT "buttafly_legends".* FROM "buttafly_legends"[0m
  Rendered /home/fred/work/opensource/buttafly/app/views/buttafly/contents/_content.html.haml (28.3ms)
  [1m[35m (0.3ms)[0m  SELECT COUNT(*) FROM "buttafly_spreadsheets"
  Rendered /home/fred/work/opensource/buttafly/app/views/buttafly/contents/index.html.haml within layouts/application (34.5ms)
  Rendered application/_messages.html.haml (0.6ms)
Completed 200 OK in 39ms (Views: 35.4ms | ActiveRecord: 1.7ms)
  [1m[36m (0.4ms)[0m  [1mSELECT COUNT(*) FROM "buttafly_spreadsheets"  WHERE "buttafly_spreadsheets"."name" = 'pinot noirs'[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
-----------------------------------------------------------
create content Feature Test: test_0002_fail renders message
-----------------------------------------------------------
Started GET "/buttafly/contents" for 127.0.0.1 at 2014-11-16 18:18:52 -0800
Processing by Buttafly::ContentsController#index as HTML
  Rendered /home/fred/work/opensource/buttafly/app/views/buttafly/contents/_form.html.haml (1.8ms)
  [1m[35mButtafly::Spreadsheet Load (0.4ms)[0m  SELECT  "buttafly_spreadsheets".* FROM "buttafly_spreadsheets"   ORDER BY "buttafly_spreadsheets"."created_at" ASC LIMIT 5 OFFSET 0
  [1m[36m (0.2ms)[0m  [1mSELECT COUNT(*) FROM "buttafly_spreadsheets"[0m
  Rendered /home/fred/work/opensource/buttafly/app/views/buttafly/contents/index.html.haml within layouts/application (4.3ms)
  Rendered application/_messages.html.haml (0.2ms)
Completed 200 OK in 8ms (Views: 5.8ms | ActiveRecord: 0.6ms)
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mButtafly::Spreadsheet Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "buttafly_spreadsheets"  WHERE "buttafly_spreadsheets"."name" = 'test_file_name7' LIMIT 1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO "buttafly_spreadsheets" ("aasm_state", "created_at", "data", "flat_file", "name", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["aasm_state", "not_imported"], ["created_at", "2014-11-17 02:18:52.822828"], ["data", "[{\"mother\":\"Sarah Jane Schoeneman\",\"child\":\"Ella Mac Pacurar\",\"grandparent\":\"Vicki Pacurar\"}]"], ["flat_file", "family.odt.csv"], ["name", "test_file_name7"], ["updated_at", "2014-11-17 02:18:52.822828"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Started POST "/buttafly/contents" for 127.0.0.1 at 2014-11-16 18:18:52 -0800
Processing by Buttafly::ContentsController#create as HTML
  Parameters: {"utf8"=>"âœ“", "originable"=>{"name"=>"test_file_name7", "flat_file"=>#<ActionDispatch::Http::UploadedFile:0x007fa0043394a0 @tempfile=#<Tempfile:/tmp/RackMultipart20141116-4351-11nljpk>, @original_filename="family.odt.csv", @content_type="text/comma-separated-values", @headers="Content-Disposition: form-data; name=\"originable[flat_file]\"; filename=\"family.odt.csv\"\r\nContent-Type: text/comma-separated-values\r\nContent-Length: 117\r\n">}, "commit"=>"Upload file"}
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mButtafly::Spreadsheet Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "buttafly_spreadsheets"  WHERE "buttafly_spreadsheets"."name" = 'test_file_name7' LIMIT 1[0m
  [1m[35m (0.1ms)[0m  ROLLBACK TO SAVEPOINT active_record_1
Redirected to http://www.example.com/buttafly/
Completed 302 Found in 5ms (ActiveRecord: 0.6ms)
Started GET "/buttafly/" for 127.0.0.1 at 2014-11-16 18:18:52 -0800
Processing by Buttafly::ContentsController#index as HTML
  Rendered /home/fred/work/opensource/buttafly/app/views/buttafly/contents/_form.html.haml (1.9ms)
  [1m[36mButtafly::Spreadsheet Load (0.4ms)[0m  [1mSELECT  "buttafly_spreadsheets".* FROM "buttafly_spreadsheets"   ORDER BY "buttafly_spreadsheets"."created_at" ASC LIMIT 5 OFFSET 0[0m
  [1m[35mButtafly::Mapping Load (0.3ms)[0m  SELECT "buttafly_mappings".* FROM "buttafly_mappings"  WHERE "buttafly_mappings"."originable_id" = $1 AND "buttafly_mappings"."originable_type" = $2  [["originable_id", 3], ["originable_type", "Buttafly::Spreadsheet"]]
  [1m[36mButtafly::Legend Load (0.2ms)[0m  [1mSELECT "buttafly_legends".* FROM "buttafly_legends"[0m
  Rendered /home/fred/work/opensource/buttafly/app/views/buttafly/contents/_content.html.haml (4.8ms)
  [1m[35m (0.3ms)[0m  SELECT COUNT(*) FROM "buttafly_spreadsheets"
  Rendered /home/fred/work/opensource/buttafly/app/views/buttafly/contents/index.html.haml within layouts/application (9.5ms)
  Rendered application/_messages.html.haml (0.6ms)
Completed 200 OK in 14ms (Views: 10.8ms | ActiveRecord: 1.2ms)
  [1m[36m (0.4ms)[0m  [1mSELECT COUNT(*) FROM "buttafly_spreadsheets"  WHERE "buttafly_spreadsheets"."name" = 'pinot noirs'[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  COMMIT
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
-----------------------------
ButtaflyTest: test_0001_truth
-----------------------------
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  COMMIT
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  COMMIT
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mButtafly::Spreadsheet Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "buttafly_spreadsheets"  WHERE "buttafly_spreadsheets"."name" = 'test_file_name8' LIMIT 1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO "buttafly_spreadsheets" ("aasm_state", "created_at", "data", "flat_file", "name", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["aasm_state", "not_imported"], ["created_at", "2014-11-17 02:18:52.868886"], ["data", "{}"], ["flat_file", "family.odt.csv"], ["name", "test_file_name8"], ["updated_at", "2014-11-17 02:18:52.868886"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.4ms)[0m  [1mINSERT INTO "buttafly_mappings" ("created_at", "originable_id", "originable_type", "targetable_model", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["created_at", "2014-11-17 02:18:52.873163"], ["originable_id", 4], ["originable_type", "Buttafly::Spreadsheet"], ["targetable_model", "DummyChild"], ["updated_at", "2014-11-17 02:18:52.873163"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.4ms)[0m  UPDATE "buttafly_mappings" SET "targetable_model" = $1, "updated_at" = $2 WHERE "buttafly_mappings"."id" = 1  [["targetable_model", "DummyParent"], ["updated_at", "2014-11-17 02:18:52.875683"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  COMMIT
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  COMMIT
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  COMMIT
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  COMMIT
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.2ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  COMMIT
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  COMMIT
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mButtafly::Spreadsheet Exists (0.4ms)[0m  SELECT  1 AS one FROM "buttafly_spreadsheets"  WHERE "buttafly_spreadsheets"."name" = 'test_file_name9' LIMIT 1
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
-----------------------------------------------------------------------------
Buttafly::LegendsController::POST #create: test_0001_must create a new legend
-----------------------------------------------------------------------------
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mButtafly::Spreadsheet Exists (0.3ms)[0m  SELECT  1 AS one FROM "buttafly_spreadsheets"  WHERE "buttafly_spreadsheets"."name" = 'test_file_name10' LIMIT 1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO "buttafly_spreadsheets" ("aasm_state", "created_at", "data", "flat_file", "name", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["aasm_state", "not_imported"], ["created_at", "2014-11-17 02:18:52.910116"], ["data", "{}"], ["flat_file", "family.odt.csv"], ["name", "test_file_name10"], ["updated_at", "2014-11-17 02:18:52.910116"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO "buttafly_mappings" ("created_at", "originable_id", "originable_type", "targetable_model", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["created_at", "2014-11-17 02:18:52.913284"], ["originable_id", 5], ["originable_type", "Buttafly::Spreadsheet"], ["targetable_model", "DummyChild"], ["updated_at", "2014-11-17 02:18:52.913284"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by Buttafly::LegendsController#create as HTML
  Parameters: {"mapping_id"=>"2"}
Completed 500 Internal Server Error in 8765ms
  [1m[35m (0.3ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  COMMIT
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  COMMIT
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  COMMIT
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  COMMIT
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.4ms)[0m  [1mINSERT INTO "dummy_tribes" ("created_at", "name", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["created_at", "2014-11-17 02:19:01.695810"], ["name", "MyString"], ["updated_at", "2014-11-17 02:19:01.695810"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mButtafly::Spreadsheet Exists (0.4ms)[0m  SELECT  1 AS one FROM "buttafly_spreadsheets"  WHERE "buttafly_spreadsheets"."name" = 'test_file_name11' LIMIT 1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO "buttafly_spreadsheets" ("aasm_state", "created_at", "data", "flat_file", "name", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["aasm_state", "not_imported"], ["created_at", "2014-11-17 02:19:01.707314"], ["data", "{}"], ["flat_file", "family.odt.csv"], ["name", "test_file_name11"], ["updated_at", "2014-11-17 02:19:01.707314"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.4ms)[0m  INSERT INTO "buttafly_legends" ("created_at", "data", "updated_at") VALUES ($1, $2, $3) RETURNING "id"  [["created_at", "2014-11-17 02:19:01.711214"], ["data", "{\"meta\":{\"col_sep\":\",\",\"encoding\":\"utf-8\",\"row_sep\":\"/n\",\"headers\":[\"mother\",\"child\",\"grandparent\"]},\"dummy_child\":{\"name\":\"child\",\"dummy_parent\":{\"name\":\"mother\",\"dummy_grandparent\":{\"name\":\"grandparent\"}}}}"], ["updated_at", "2014-11-17 02:19:01.711214"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.2ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  COMMIT
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mButtafly::Spreadsheet Exists (0.3ms)[0m  SELECT  1 AS one FROM "buttafly_spreadsheets"  WHERE "buttafly_spreadsheets"."name" = 'test_file_name12' LIMIT 1
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
----------------------------------------------
create mapping Feature Test: test_0001_success
----------------------------------------------
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mButtafly::Spreadsheet Exists (0.3ms)[0m  SELECT  1 AS one FROM "buttafly_spreadsheets"  WHERE "buttafly_spreadsheets"."name" = 'test_file_name13' LIMIT 1
  [1m[36mSQL (0.4ms)[0m  [1mINSERT INTO "buttafly_spreadsheets" ("aasm_state", "created_at", "data", "flat_file", "name", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["aasm_state", "not_imported"], ["created_at", "2014-11-17 02:19:01.726043"], ["data", "[{\"mother\":\"Sarah Jane Schoeneman\",\"child\":\"Ella Mac Pacurar\",\"grandparent\":\"Vicki Pacurar\"}]"], ["flat_file", "family.odt.csv"], ["name", "test_file_name13"], ["updated_at", "2014-11-17 02:19:01.726043"]]
  [1m[35m (0.2ms)[0m  RELEASE SAVEPOINT active_record_1
Started GET "/buttafly/contents" for 127.0.0.1 at 2014-11-16 18:19:01 -0800
Processing by Buttafly::ContentsController#index as HTML
  Rendered /home/fred/work/opensource/buttafly/app/views/buttafly/contents/_form.html.haml (2.1ms)
  [1m[36mButtafly::Spreadsheet Load (0.4ms)[0m  [1mSELECT  "buttafly_spreadsheets".* FROM "buttafly_spreadsheets"   ORDER BY "buttafly_spreadsheets"."created_at" ASC LIMIT 5 OFFSET 0[0m
  [1m[35mButtafly::Mapping Load (0.3ms)[0m  SELECT "buttafly_mappings".* FROM "buttafly_mappings"  WHERE "buttafly_mappings"."originable_id" = $1 AND "buttafly_mappings"."originable_type" = $2  [["originable_id", 7], ["originable_type", "Buttafly::Spreadsheet"]]
  [1m[36mButtafly::Legend Load (0.3ms)[0m  [1mSELECT "buttafly_legends".* FROM "buttafly_legends"[0m
  Rendered /home/fred/work/opensource/buttafly/app/views/buttafly/contents/_content.html.haml (5.1ms)
  [1m[35m (0.3ms)[0m  SELECT COUNT(*) FROM "buttafly_spreadsheets"
  Rendered application/_messages.html.haml (0.3ms)
Completed 200 OK in 15ms (Views: 12.2ms | ActiveRecord: 1.2ms)
  [1m[36m (0.3ms)[0m  [1mSELECT COUNT(*) FROM "buttafly_mappings"  WHERE "buttafly_mappings"."originable_id" = $1 AND "buttafly_mappings"."originable_type" = $2[0m  [["originable_id", 7], ["originable_type", "Buttafly::Spreadsheet"]]
Started POST "/buttafly/mappings?originable_id=7" for 127.0.0.1 at 2014-11-16 18:19:01 -0800
Processing by Buttafly::MappingsController#create as HTML
  Parameters: {"utf8"=>"âœ“", "mapping"=>{"originable_id"=>"7", "targetable_model"=>"DummyChild"}, "commit"=>"Select Target Model", "originable_id"=>"7"}
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mButtafly::Spreadsheet Load (0.3ms)[0m  [1mSELECT  "buttafly_spreadsheets".* FROM "buttafly_spreadsheets"  WHERE "buttafly_spreadsheets"."id" = $1 LIMIT 1[0m  [["id", 7]]
  [1m[35mSQL (0.3ms)[0m  INSERT INTO "buttafly_mappings" ("created_at", "originable_id", "originable_type", "targetable_model", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["created_at", "2014-11-17 02:19:01.843988"], ["originable_id", 7], ["originable_type", "Buttafly::Spreadsheet"], ["targetable_model", "DummyChild"], ["updated_at", "2014-11-17 02:19:01.843988"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://www.example.com/buttafly/contents
Completed 302 Found in 5ms (ActiveRecord: 0.8ms)
Started GET "/buttafly/contents" for 127.0.0.1 at 2014-11-16 18:19:01 -0800
Processing by Buttafly::ContentsController#index as HTML
  Rendered /home/fred/work/opensource/buttafly/app/views/buttafly/contents/_form.html.haml (1.8ms)
  [1m[35mButtafly::Spreadsheet Load (0.4ms)[0m  SELECT  "buttafly_spreadsheets".* FROM "buttafly_spreadsheets"   ORDER BY "buttafly_spreadsheets"."created_at" ASC LIMIT 5 OFFSET 0
  [1m[36mButtafly::Mapping Load (0.3ms)[0m  [1mSELECT "buttafly_mappings".* FROM "buttafly_mappings"  WHERE "buttafly_mappings"."originable_id" = $1 AND "buttafly_mappings"."originable_type" = $2[0m  [["originable_id", 7], ["originable_type", "Buttafly::Spreadsheet"]]
  [1m[35mButtafly::Legend Load (0.2ms)[0m  SELECT "buttafly_legends".* FROM "buttafly_legends"
  Rendered /home/fred/work/opensource/buttafly/app/views/buttafly/contents/_content.html.haml (5.4ms)
  [1m[36m (0.3ms)[0m  [1mSELECT COUNT(*) FROM "buttafly_spreadsheets"[0m
  Rendered application/_messages.html.haml (0.6ms)
Completed 200 OK in 14ms (Views: 11.2ms | ActiveRecord: 1.2ms)
  [1m[35m (0.3ms)[0m  SELECT COUNT(*) FROM "buttafly_mappings"  WHERE "buttafly_mappings"."originable_id" = $1 AND "buttafly_mappings"."originable_type" = $2  [["originable_id", 7], ["originable_type", "Buttafly::Spreadsheet"]]
  [1m[36mButtafly::Mapping Load (0.3ms)[0m  [1mSELECT  "buttafly_mappings".* FROM "buttafly_mappings"  WHERE "buttafly_mappings"."originable_id" = $1 AND "buttafly_mappings"."originable_type" = $2  ORDER BY "buttafly_mappings"."id" ASC LIMIT 1[0m  [["originable_id", 7], ["originable_type", "Buttafly::Spreadsheet"]]
  [1m[35mButtafly::Spreadsheet Load (0.2ms)[0m  SELECT  "buttafly_spreadsheets".* FROM "buttafly_spreadsheets"  WHERE "buttafly_spreadsheets"."id" = $1 LIMIT 1  [["id", 7]]
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "dummy_tribes" ("created_at", "name", "updated_at") VALUES ($1, $2, $3) RETURNING "id"  [["created_at", "2014-11-17 02:19:01.874218"], ["name", "MyString"], ["updated_at", "2014-11-17 02:19:01.874218"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "dummy_grandparents" ("created_at", "dummy_tribe_id", "name", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["created_at", "2014-11-17 02:19:01.876206"], ["dummy_tribe_id", 6], ["name", "Vicki Pacurar"], ["updated_at", "2014-11-17 02:19:01.876206"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "dummy_tribes" ("created_at", "name", "updated_at") VALUES ($1, $2, $3) RETURNING "id"  [["created_at", "2014-11-17 02:19:01.878191"], ["name", "MyString"], ["updated_at", "2014-11-17 02:19:01.878191"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO "dummy_parents" ("created_at", "dummy_grandparent_id", "dummy_tribe_id", "name", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["created_at", "2014-11-17 02:19:01.880042"], ["dummy_grandparent_id", 2], ["dummy_tribe_id", 7], ["name", "Sarah Jane Schoeneman"], ["updated_at", "2014-11-17 02:19:01.880042"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "dummy_tribes" ("created_at", "name", "updated_at") VALUES ($1, $2, $3) RETURNING "id"  [["created_at", "2014-11-17 02:19:01.882456"], ["name", "MyString"], ["updated_at", "2014-11-17 02:19:01.882456"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  COMMIT
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mButtafly::Spreadsheet Exists (0.3ms)[0m  SELECT  1 AS one FROM "buttafly_spreadsheets"  WHERE "buttafly_spreadsheets"."name" = 'test_file_name14' LIMIT 1
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
---------------------------------------------------------
Buttafly::MappingsController: test_0001_must POST #create
---------------------------------------------------------
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mButtafly::Spreadsheet Exists (0.3ms)[0m  SELECT  1 AS one FROM "buttafly_spreadsheets"  WHERE "buttafly_spreadsheets"."name" = 'test_file_name15' LIMIT 1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO "buttafly_spreadsheets" ("aasm_state", "created_at", "data", "flat_file", "name", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["aasm_state", "not_imported"], ["created_at", "2014-11-17 02:19:01.896310"], ["data", "[{\"mother\":\"Sarah Jane Schoeneman\",\"child\":\"Ella Mac Pacurar\",\"grandparent\":\"Vicki Pacurar\"}]"], ["flat_file", "family.odt.csv"], ["name", "test_file_name15"], ["updated_at", "2014-11-17 02:19:01.896310"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by Buttafly::MappingsController#create as HTML
  Parameters: {"mapping"=>{"originable_id"=>"8", "targetable_model"=>"DummyChild"}}
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mButtafly::Spreadsheet Load (0.3ms)[0m  SELECT  "buttafly_spreadsheets".* FROM "buttafly_spreadsheets"  WHERE "buttafly_spreadsheets"."id" = $1 LIMIT 1  [["id", 8]]
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO "buttafly_mappings" ("created_at", "originable_id", "originable_type", "targetable_model", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["created_at", "2014-11-17 02:19:01.904731"], ["originable_id", 8], ["originable_type", "Buttafly::Spreadsheet"], ["targetable_model", "DummyChild"], ["updated_at", "2014-11-17 02:19:01.904731"]]
  [1m[35m (0.2ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to /referring/url
Completed 302 Found in 4ms (ActiveRecord: 0.8ms)
  [1m[36mButtafly::Mapping Load (0.3ms)[0m  [1mSELECT  "buttafly_mappings".* FROM "buttafly_mappings"  WHERE "buttafly_mappings"."originable_id" = $1 AND "buttafly_mappings"."originable_type" = $2  ORDER BY "buttafly_mappings"."id" ASC LIMIT 1[0m  [["originable_id", 8], ["originable_type", "Buttafly::Spreadsheet"]]
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
-------------------------------------------------------------
Buttafly::MappingsController: test_0002_must 'DELETE' destroy
-------------------------------------------------------------
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mButtafly::Spreadsheet Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "buttafly_spreadsheets"  WHERE "buttafly_spreadsheets"."name" = 'test_file_name16' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "buttafly_spreadsheets" ("aasm_state", "created_at", "data", "flat_file", "name", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["aasm_state", "not_imported"], ["created_at", "2014-11-17 02:19:01.913454"], ["data", "{}"], ["flat_file", "family.odt.csv"], ["name", "test_file_name16"], ["updated_at", "2014-11-17 02:19:01.913454"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "buttafly_mappings" ("created_at", "originable_id", "originable_type", "targetable_model", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["created_at", "2014-11-17 02:19:01.916481"], ["originable_id", 9], ["originable_type", "Buttafly::Spreadsheet"], ["targetable_model", "DummyChild"], ["updated_at", "2014-11-17 02:19:01.916481"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.2ms)[0m  [1mSELECT COUNT(*) FROM "buttafly_mappings"[0m
Processing by Buttafly::MappingsController#destroy as HTML
  Parameters: {"id"=>"5"}
  [1m[35mButtafly::Mapping Load (0.2ms)[0m  SELECT  "buttafly_mappings".* FROM "buttafly_mappings"  WHERE "buttafly_mappings"."id" = $1 LIMIT 1  [["id", 5]]
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  DELETE FROM "buttafly_mappings" WHERE "buttafly_mappings"."id" = $1  [["id", 5]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to /referring/url
Completed 302 Found in 2ms (ActiveRecord: 0.6ms)
  [1m[35m (0.2ms)[0m  SELECT COUNT(*) FROM "buttafly_mappings"
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36mButtafly::Spreadsheet Exists (0.4ms)[0m  [1mSELECT  1 AS one FROM "buttafly_spreadsheets"  WHERE "buttafly_spreadsheets"."name" = 'test_file_name17' LIMIT 1[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  COMMIT
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  COMMIT
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "dummy_tribes" ("created_at", "name", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["created_at", "2014-11-17 02:19:01.937446"], ["name", "MyString"], ["updated_at", "2014-11-17 02:19:01.937446"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
-------------------------
RoutesTest: test_messages
-------------------------
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.0ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
---------------------------------------------
create legend Feature Test: test_0001_success
---------------------------------------------
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mButtafly::Spreadsheet Exists (0.3ms)[0m  SELECT  1 AS one FROM "buttafly_spreadsheets"  WHERE "buttafly_spreadsheets"."name" = 'test_file_name18' LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "buttafly_spreadsheets" ("aasm_state", "created_at", "data", "flat_file", "name", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["aasm_state", "not_imported"], ["created_at", "2014-11-17 02:19:01.948379"], ["data", "{}"], ["flat_file", "family.odt.csv"], ["name", "test_file_name18"], ["updated_at", "2014-11-17 02:19:01.948379"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "buttafly_mappings" ("created_at", "originable_id", "originable_type", "targetable_model", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["created_at", "2014-11-17 02:19:01.951429"], ["originable_id", 10], ["originable_type", "Buttafly::Spreadsheet"], ["targetable_model", "DummyChild"], ["updated_at", "2014-11-17 02:19:01.951429"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Started GET "/buttafly/contents" for 127.0.0.1 at 2014-11-16 18:19:01 -0800
Processing by Buttafly::ContentsController#index as HTML
  Rendered /home/fred/work/opensource/buttafly/app/views/buttafly/contents/_form.html.haml (1.9ms)
  [1m[35mButtafly::Spreadsheet Load (0.4ms)[0m  SELECT  "buttafly_spreadsheets".* FROM "buttafly_spreadsheets"   ORDER BY "buttafly_spreadsheets"."created_at" ASC LIMIT 5 OFFSET 0
  [1m[36mButtafly::Mapping Load (0.4ms)[0m  [1mSELECT "buttafly_mappings".* FROM "buttafly_mappings"  WHERE "buttafly_mappings"."originable_id" = $1 AND "buttafly_mappings"."originable_type" = $2[0m  [["originable_id", 10], ["originable_type", "Buttafly::Spreadsheet"]]
  [1m[35mButtafly::Legend Load (0.3ms)[0m  SELECT "buttafly_legends".* FROM "buttafly_legends"
  Rendered /home/fred/work/opensource/buttafly/app/views/buttafly/contents/_content.html.haml (6.8ms)
  [1m[36m (0.3ms)[0m  [1mSELECT COUNT(*) FROM "buttafly_spreadsheets"[0m
  Rendered application/_messages.html.haml (0.2ms)
Completed 200 OK in 15ms (Views: 12.5ms | ActiveRecord: 1.3ms)
Started GET "/buttafly/legends/new?mapping_id=6" for 127.0.0.1 at 2014-11-16 18:19:01 -0800
Processing by Buttafly::LegendsController#new as HTML
  Parameters: {"mapping_id"=>"6"}
  [1m[35mButtafly::Mapping Load (0.3ms)[0m  SELECT  "buttafly_mappings".* FROM "buttafly_mappings"  WHERE "buttafly_mappings"."id" = $1 LIMIT 1  [["id", 6]]
  [1m[36mButtafly::Spreadsheet Load (0.3ms)[0m  [1mSELECT  "buttafly_spreadsheets".* FROM "buttafly_spreadsheets"  WHERE "buttafly_spreadsheets"."id" = $1 LIMIT 1[0m  [["id", 10]]
  Rendered application/_messages.html.haml (0.3ms)
Completed 200 OK in 17ms (Views: 13.1ms | ActiveRecord: 0.6ms)
  [1m[35m (0.2ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  COMMIT
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mButtafly::Spreadsheet Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "buttafly_spreadsheets"  WHERE "buttafly_spreadsheets"."name" = 'test_file_name19' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "buttafly_spreadsheets" ("aasm_state", "created_at", "data", "flat_file", "name", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["aasm_state", "not_imported"], ["created_at", "2014-11-17 02:19:01.999291"], ["data", "{}"], ["flat_file", "family.odt.csv"], ["name", "test_file_name19"], ["updated_at", "2014-11-17 02:19:01.999291"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "buttafly_mappings" ("created_at", "originable_id", "originable_type", "targetable_model", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["created_at", "2014-11-17 02:19:02.002525"], ["originable_id", 11], ["originable_type", "Buttafly::Spreadsheet"], ["targetable_model", "DummyChild"], ["updated_at", "2014-11-17 02:19:02.002525"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mButtafly::Spreadsheet Exists (0.3ms)[0m  SELECT  1 AS one FROM "buttafly_spreadsheets"  WHERE "buttafly_spreadsheets"."name" = 'test_file_name20' LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "buttafly_spreadsheets" ("aasm_state", "created_at", "data", "flat_file", "name", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["aasm_state", "not_imported"], ["created_at", "2014-11-17 02:19:02.009692"], ["data", "{}"], ["flat_file", "family.odt.csv"], ["name", "test_file_name20"], ["updated_at", "2014-11-17 02:19:02.009692"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mButtafly::Spreadsheet Exists (0.4ms)[0m  SELECT  1 AS one FROM "buttafly_spreadsheets"  WHERE ("buttafly_spreadsheets"."name" = 'test_file_name20' AND "buttafly_spreadsheets"."id" != 12) LIMIT 1
  [1m[36mSQL (0.3ms)[0m  [1mUPDATE "buttafly_spreadsheets" SET "data" = $1, "imported_at" = $2, "updated_at" = $3 WHERE "buttafly_spreadsheets"."id" = 12[0m  [["data", "[{\"child name\":\"ella mac\",\"parent name\":\"sara\",\"grandparent name\":\"kc shekhar\",\"tribe name\":\"india\",\"age\":\"2.5\"},{\"child name\":\"rohan\",\"parent name\":\"doug\",\"grandparent name\":\"vicki\",\"tribe name\":\"america\",\"age\":\"6\"}]"], ["imported_at", "2014-11-17 02:19:02.012282"], ["updated_at", "2014-11-17 02:19:02.015664"]]
  [1m[35mButtafly::Spreadsheet Exists (0.3ms)[0m  SELECT  1 AS one FROM "buttafly_spreadsheets"  WHERE ("buttafly_spreadsheets"."name" = 'test_file_name20' AND "buttafly_spreadsheets"."id" != 12) LIMIT 1
  [1m[36mSQL (0.3ms)[0m  [1mUPDATE "buttafly_spreadsheets" SET "aasm_state" = $1, "updated_at" = $2 WHERE "buttafly_spreadsheets"."id" = 12[0m  [["aasm_state", "imported"], ["updated_at", "2014-11-17 02:19:02.019303"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.2ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mButtafly::Spreadsheet Exists (0.4ms)[0m  SELECT  1 AS one FROM "buttafly_spreadsheets"  WHERE "buttafly_spreadsheets"."name" = 'test_file_name21' LIMIT 1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO "buttafly_spreadsheets" ("aasm_state", "created_at", "data", "flat_file", "name", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["aasm_state", "not_imported"], ["created_at", "2014-11-17 02:19:02.026429"], ["data", "{}"], ["flat_file", "family.odt.csv"], ["name", "test_file_name21"], ["updated_at", "2014-11-17 02:19:02.026429"]]
  [1m[35m (0.2ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mButtafly::Spreadsheet Exists (0.4ms)[0m  SELECT  1 AS one FROM "buttafly_spreadsheets"  WHERE ("buttafly_spreadsheets"."name" = 'test_file_name21' AND "buttafly_spreadsheets"."id" != 13) LIMIT 1
  [1m[36mSQL (0.3ms)[0m  [1mUPDATE "buttafly_spreadsheets" SET "data" = $1, "updated_at" = $2 WHERE "buttafly_spreadsheets"."id" = 13[0m  [["data", "[{\"child name\":\"ella mac\",\"parent name\":\"sara\",\"grandparent name\":\"kc shekhar\",\"tribe name\":\"india\",\"age\":\"2.5\"},{\"child name\":\"rohan\",\"parent name\":\"doug\",\"grandparent name\":\"vicki\",\"tribe name\":\"america\",\"age\":\"6\"}]"], ["updated_at", "2014-11-17 02:19:02.031754"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.2ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
-------------------------------------------------------------
Buttafly::LegendsController::GET #new: test_0001_must succeed
-------------------------------------------------------------
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mButtafly::Spreadsheet Exists (0.3ms)[0m  SELECT  1 AS one FROM "buttafly_spreadsheets"  WHERE "buttafly_spreadsheets"."name" = 'test_file_name22' LIMIT 1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO "buttafly_spreadsheets" ("aasm_state", "created_at", "data", "flat_file", "name", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["aasm_state", "not_imported"], ["created_at", "2014-11-17 02:19:02.041016"], ["data", "{}"], ["flat_file", "family.odt.csv"], ["name", "test_file_name22"], ["updated_at", "2014-11-17 02:19:02.041016"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "buttafly_mappings" ("created_at", "originable_id", "originable_type", "targetable_model", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["created_at", "2014-11-17 02:19:02.043922"], ["originable_id", 14], ["originable_type", "Buttafly::Spreadsheet"], ["targetable_model", "DummyChild"], ["updated_at", "2014-11-17 02:19:02.043922"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by Buttafly::LegendsController#new as HTML
  Parameters: {"mapping_id"=>"8"}
  [1m[35mButtafly::Mapping Load (0.3ms)[0m  SELECT  "buttafly_mappings".* FROM "buttafly_mappings"  WHERE "buttafly_mappings"."id" = $1 LIMIT 1  [["id", 8]]
  [1m[36mButtafly::Spreadsheet Load (0.2ms)[0m  [1mSELECT  "buttafly_spreadsheets".* FROM "buttafly_spreadsheets"  WHERE "buttafly_spreadsheets"."id" = $1 LIMIT 1[0m  [["id", 14]]
  Rendered application/_messages.html.haml (0.1ms)
Completed 200 OK in 12ms (Views: 8.8ms | ActiveRecord: 0.5ms)
  [1m[35m (0.2ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
------------------------------------------------------------------------------------------------
Buttafly::LegendsController::GET #new: test_0002_must instantiate a legend from existing mapping
------------------------------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mButtafly::Spreadsheet Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "buttafly_spreadsheets"  WHERE "buttafly_spreadsheets"."name" = 'test_file_name23' LIMIT 1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO "buttafly_spreadsheets" ("aasm_state", "created_at", "data", "flat_file", "name", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["aasm_state", "not_imported"], ["created_at", "2014-11-17 02:19:02.064739"], ["data", "{}"], ["flat_file", "family.odt.csv"], ["name", "test_file_name23"], ["updated_at", "2014-11-17 02:19:02.064739"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "buttafly_mappings" ("created_at", "originable_id", "originable_type", "targetable_model", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["created_at", "2014-11-17 02:19:02.067878"], ["originable_id", 15], ["originable_type", "Buttafly::Spreadsheet"], ["targetable_model", "DummyChild"], ["updated_at", "2014-11-17 02:19:02.067878"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by Buttafly::LegendsController#new as HTML
  Parameters: {"mapping_id"=>"9"}
  [1m[36mButtafly::Mapping Load (0.3ms)[0m  [1mSELECT  "buttafly_mappings".* FROM "buttafly_mappings"  WHERE "buttafly_mappings"."id" = $1 LIMIT 1[0m  [["id", 9]]
  [1m[35mButtafly::Spreadsheet Load (0.2ms)[0m  SELECT  "buttafly_spreadsheets".* FROM "buttafly_spreadsheets"  WHERE "buttafly_spreadsheets"."id" = $1 LIMIT 1  [["id", 15]]
  Rendered application/_messages.html.haml (0.1ms)
Completed 200 OK in 11ms (Views: 7.5ms | ActiveRecord: 0.4ms)
  [1m[36m (0.2ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mButtafly::Spreadsheet Exists (0.3ms)[0m  SELECT  1 AS one FROM "buttafly_spreadsheets"  WHERE "buttafly_spreadsheets"."name" = 'test_file_name24' LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "buttafly_spreadsheets" ("aasm_state", "created_at", "data", "flat_file", "name", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["aasm_state", "not_imported"], ["created_at", "2014-11-17 02:19:02.088379"], ["data", "{}"], ["flat_file", "family.odt.csv"], ["name", "test_file_name24"], ["updated_at", "2014-11-17 02:19:02.088379"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "buttafly_mappings" ("created_at", "originable_id", "originable_type", "targetable_model", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["created_at", "2014-11-17 02:19:02.091520"], ["originable_id", 16], ["originable_type", "Buttafly::Spreadsheet"], ["targetable_model", "DummyChild"], ["updated_at", "2014-11-17 02:19:02.091520"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mROLLBACK TO SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
-------------------------------------------------------------------------
Buttafly::ContentsController: test_0001_get #show must assign @originable
-------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mButtafly::Spreadsheet Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "buttafly_spreadsheets"  WHERE "buttafly_spreadsheets"."name" = 'test_file_name25' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "buttafly_spreadsheets" ("aasm_state", "created_at", "data", "flat_file", "name", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["aasm_state", "not_imported"], ["created_at", "2014-11-17 02:19:02.100080"], ["data", "{}"], ["flat_file", "family.odt.csv"], ["name", "test_file_name25"], ["updated_at", "2014-11-17 02:19:02.100080"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by Buttafly::ContentsController#show as HTML
  Parameters: {"id"=>"17"}
  [1m[35mButtafly::Spreadsheet Load (0.2ms)[0m  SELECT  "buttafly_spreadsheets".* FROM "buttafly_spreadsheets"  WHERE "buttafly_spreadsheets"."id" = $1 LIMIT 1  [["id", 17]]
  Rendered application/_messages.html.haml (0.1ms)
Completed 200 OK in 5ms (Views: 4.2ms | ActiveRecord: 0.2ms)
  [1m[36m (0.2ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
-------------------------------------------------
Buttafly::ContentsController: test_0002_get #edit
-------------------------------------------------
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mButtafly::Spreadsheet Exists (0.4ms)[0m  SELECT  1 AS one FROM "buttafly_spreadsheets"  WHERE "buttafly_spreadsheets"."name" = 'test_file_name26' LIMIT 1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO "buttafly_spreadsheets" ("aasm_state", "created_at", "data", "flat_file", "name", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["aasm_state", "not_imported"], ["created_at", "2014-11-17 02:19:02.115878"], ["data", "{}"], ["flat_file", "family.odt.csv"], ["name", "test_file_name26"], ["updated_at", "2014-11-17 02:19:02.115878"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by Buttafly::ContentsController#edit as HTML
  Parameters: {"id"=>"18"}
  [1m[36mButtafly::Spreadsheet Load (0.2ms)[0m  [1mSELECT  "buttafly_spreadsheets".* FROM "buttafly_spreadsheets"  WHERE "buttafly_spreadsheets"."id" = $1 LIMIT 1[0m  [["id", 18]]
  Rendered /home/fred/work/opensource/buttafly/app/views/buttafly/contents/_form.html.haml (2.0ms)
  Rendered application/_messages.html.haml (0.1ms)
Completed 200 OK in 7ms (Views: 6.4ms | ActiveRecord: 0.2ms)
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
----------------------------------------------------
Buttafly::ContentsController: test_0003_post #create
----------------------------------------------------
Processing by Buttafly::ContentsController#create as HTML
  Parameters: {"originable"=>{"name"=>"slick name", "flat_file"=>"slickname.csv"}}
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mButtafly::Spreadsheet Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "buttafly_spreadsheets"  WHERE "buttafly_spreadsheets"."name" = 'slick name' LIMIT 1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO "buttafly_spreadsheets" ("aasm_state", "created_at", "flat_file", "name", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["aasm_state", "not_imported"], ["created_at", "2014-11-17 02:19:02.132843"], ["flat_file", nil], ["name", "slick name"], ["updated_at", "2014-11-17 02:19:02.132843"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://test.host/buttafly/contents
Completed 302 Found in 5ms (ActiveRecord: 0.8ms)
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
-------------------------------------------------------------------------
Buttafly::ContentsController: test_0004_patch #import saves a spreadsheet
-------------------------------------------------------------------------
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mButtafly::Spreadsheet Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "buttafly_spreadsheets"  WHERE "buttafly_spreadsheets"."name" = 'test_file_name27' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "buttafly_spreadsheets" ("aasm_state", "created_at", "data", "flat_file", "name", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["aasm_state", "not_imported"], ["created_at", "2014-11-17 02:19:02.139886"], ["data", "{}"], ["flat_file", "family.odt.csv"], ["name", "test_file_name27"], ["updated_at", "2014-11-17 02:19:02.139886"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by Buttafly::ContentsController#import as HTML
  Parameters: {"originable_type"=>"Buttafly::Spreadsheet", "id"=>"20"}
  [1m[35mButtafly::Spreadsheet Load (0.2ms)[0m  SELECT  "buttafly_spreadsheets".* FROM "buttafly_spreadsheets"  WHERE "buttafly_spreadsheets"."id" = $1 LIMIT 1  [["id", 20]]
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mButtafly::Spreadsheet Exists (0.4ms)[0m  SELECT  1 AS one FROM "buttafly_spreadsheets"  WHERE ("buttafly_spreadsheets"."name" = 'test_file_name27' AND "buttafly_spreadsheets"."id" != 20) LIMIT 1
  [1m[36mSQL (0.4ms)[0m  [1mUPDATE "buttafly_spreadsheets" SET "data" = $1, "imported_at" = $2, "updated_at" = $3 WHERE "buttafly_spreadsheets"."id" = 20[0m  [["data", "[{\"child name\":\"ella mac\",\"parent name\":\"sara\",\"grandparent name\":\"kc shekhar\",\"tribe name\":\"india\",\"age\":\"2.5\"},{\"child name\":\"rohan\",\"parent name\":\"doug\",\"grandparent name\":\"vicki\",\"tribe name\":\"america\",\"age\":\"6\"}]"], ["imported_at", "2014-11-17 02:19:02.144537"], ["updated_at", "2014-11-17 02:19:02.148078"]]
  [1m[35mButtafly::Spreadsheet Exists (0.4ms)[0m  SELECT  1 AS one FROM "buttafly_spreadsheets"  WHERE ("buttafly_spreadsheets"."name" = 'test_file_name27' AND "buttafly_spreadsheets"."id" != 20) LIMIT 1
  [1m[36mSQL (0.4ms)[0m  [1mUPDATE "buttafly_spreadsheets" SET "aasm_state" = $1, "updated_at" = $2 WHERE "buttafly_spreadsheets"."id" = 20[0m  [["aasm_state", "imported"], ["updated_at", "2014-11-17 02:19:02.152060"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to /referring/url
Completed 302 Found in 11ms (ActiveRecord: 1.9ms)
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
------------------------------------------------------------------------
Buttafly::ContentsController: test_0005_post #create saves a spreadsheet
------------------------------------------------------------------------
  [1m[36m (0.3ms)[0m  [1mSELECT COUNT(*) FROM "buttafly_spreadsheets"[0m
Processing by Buttafly::ContentsController#create as HTML
  Parameters: {"originable"=>{"name"=>"sweeet name", "flat_file"=>"summer.csv"}}
  [1m[35m (0.2ms)[0m  SAVEPOINT active_record_1
  [1m[36mButtafly::Spreadsheet Exists (0.4ms)[0m  [1mSELECT  1 AS one FROM "buttafly_spreadsheets"  WHERE "buttafly_spreadsheets"."name" = 'sweeet name' LIMIT 1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO "buttafly_spreadsheets" ("aasm_state", "created_at", "flat_file", "name", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["aasm_state", "not_imported"], ["created_at", "2014-11-17 02:19:02.160190"], ["flat_file", nil], ["name", "sweeet name"], ["updated_at", "2014-11-17 02:19:02.160190"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to http://test.host/buttafly/contents
Completed 302 Found in 5ms (ActiveRecord: 1.0ms)
  [1m[35m (0.3ms)[0m  SELECT COUNT(*) FROM "buttafly_spreadsheets"
  [1m[36m (0.2ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
--------------------------------------------------------
Buttafly::ContentsController: test_0006_should get index
--------------------------------------------------------
Processing by Buttafly::ContentsController#index as HTML
  Rendered /home/fred/work/opensource/buttafly/app/views/buttafly/contents/_form.html.haml (1.9ms)
  [1m[36mButtafly::Spreadsheet Load (0.4ms)[0m  [1mSELECT  "buttafly_spreadsheets".* FROM "buttafly_spreadsheets"   ORDER BY "buttafly_spreadsheets"."created_at" ASC LIMIT 5 OFFSET 0[0m
  [1m[35m (0.2ms)[0m  SELECT COUNT(*) FROM "buttafly_spreadsheets"
  Rendered application/_messages.html.haml (0.1ms)
Completed 200 OK in 8ms (Views: 5.6ms | ActiveRecord: 0.6ms)
  [1m[36m (0.2ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mButtafly::Spreadsheet Exists (0.4ms)[0m  SELECT  1 AS one FROM "buttafly_spreadsheets"  WHERE "buttafly_spreadsheets"."name" = 'test_file_name28' LIMIT 1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO "buttafly_spreadsheets" ("aasm_state", "created_at", "data", "flat_file", "name", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["aasm_state", "not_imported"], ["created_at", "2014-11-17 02:19:02.181342"], ["data", "{}"], ["flat_file", "family.odt.csv"], ["name", "test_file_name28"], ["updated_at", "2014-11-17 02:19:02.181342"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.2ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.0ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "dummy_tribes" ("created_at", "name", "updated_at") VALUES ($1, $2, $3) RETURNING "id"  [["created_at", "2014-11-17 02:19:02.189912"], ["name", "MyString"], ["updated_at", "2014-11-17 02:19:02.189912"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "dummy_grandparents" ("created_at", "dummy_tribe_id", "name", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["created_at", "2014-11-17 02:19:02.191763"], ["dummy_tribe_id", 10], ["name", "Vicki Pacurar"], ["updated_at", "2014-11-17 02:19:02.191763"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "dummy_tribes" ("created_at", "name", "updated_at") VALUES ($1, $2, $3) RETURNING "id"  [["created_at", "2014-11-17 02:19:02.193475"], ["name", "MyString"], ["updated_at", "2014-11-17 02:19:02.193475"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "dummy_parents" ("created_at", "dummy_grandparent_id", "dummy_tribe_id", "name", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["created_at", "2014-11-17 02:19:02.195132"], ["dummy_grandparent_id", 3], ["dummy_tribe_id", 11], ["name", "Sarah Jane Schoeneman"], ["updated_at", "2014-11-17 02:19:02.195132"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "dummy_tribes" ("created_at", "name", "updated_at") VALUES ($1, $2, $3) RETURNING "id"  [["created_at", "2014-11-17 02:19:02.196930"], ["name", "MyString"], ["updated_at", "2014-11-17 02:19:02.196930"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.4ms)[0m  [1mINSERT INTO "dummy_children" ("created_at", "dummy_parent_id", "dummy_tribe_id", "name", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["created_at", "2014-11-17 02:19:02.198633"], ["dummy_parent_id", 3], ["dummy_tribe_id", 12], ["name", "Ella Mac"], ["updated_at", "2014-11-17 02:19:02.198633"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "dummy_tribes" ("created_at", "name", "updated_at") VALUES ($1, $2, $3) RETURNING "id"  [["created_at", "2014-11-17 02:19:02.206191"], ["name", "MyString"], ["updated_at", "2014-11-17 02:19:02.206191"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO "dummy_grandparents" ("created_at", "dummy_tribe_id", "name", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["created_at", "2014-11-17 02:19:02.208415"], ["dummy_tribe_id", 13], ["name", "Vicki Pacurar"], ["updated_at", "2014-11-17 02:19:02.208415"]]
  [1m[35m (0.2ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "dummy_tribes" ("created_at", "name", "updated_at") VALUES ($1, $2, $3) RETURNING "id"  [["created_at", "2014-11-17 02:19:02.210858"], ["name", "MyString"], ["updated_at", "2014-11-17 02:19:02.210858"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "dummy_parents" ("created_at", "dummy_grandparent_id", "dummy_tribe_id", "name", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["created_at", "2014-11-17 02:19:02.212768"], ["dummy_grandparent_id", 4], ["dummy_tribe_id", 14], ["name", "Sarah Jane Schoeneman"], ["updated_at", "2014-11-17 02:19:02.212768"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "dummy_tribes" ("created_at", "name", "updated_at") VALUES ($1, $2, $3) RETURNING "id"  [["created_at", "2014-11-17 02:19:02.214750"], ["name", "MyString"], ["updated_at", "2014-11-17 02:19:02.214750"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "dummy_children" ("created_at", "dummy_parent_id", "dummy_tribe_id", "name", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["created_at", "2014-11-17 02:19:02.216425"], ["dummy_parent_id", 4], ["dummy_tribe_id", 15], ["name", "Ella Mac"], ["updated_at", "2014-11-17 02:19:02.216425"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "dummy_tribes" ("created_at", "name", "updated_at") VALUES ($1, $2, $3) RETURNING "id"  [["created_at", "2014-11-17 02:19:02.221083"], ["name", "MyString"], ["updated_at", "2014-11-17 02:19:02.221083"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "dummy_grandparents" ("created_at", "dummy_tribe_id", "name", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["created_at", "2014-11-17 02:19:02.222771"], ["dummy_tribe_id", 16], ["name", "Vicki Pacurar"], ["updated_at", "2014-11-17 02:19:02.222771"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.1ms)[0m  INSERT INTO "dummy_tribes" ("created_at", "name", "updated_at") VALUES ($1, $2, $3) RETURNING "id"  [["created_at", "2014-11-17 02:19:02.224520"], ["name", "MyString"], ["updated_at", "2014-11-17 02:19:02.224520"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36mActiveRecord::SchemaMigration Load (0.4ms)[0m  [1mSELECT "schema_migrations".* FROM "schema_migrations"[0m
  [1m[35m (0.2ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.5ms)[0m  INSERT INTO "dummy_tribes" ("created_at", "name", "updated_at") VALUES ($1, $2, $3) RETURNING "id"  [["created_at", "2014-11-17 02:41:59.372521"], ["name", "MyString"], ["updated_at", "2014-11-17 02:41:59.372521"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO "dummy_grandparents" ("created_at", "dummy_tribe_id", "name", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["created_at", "2014-11-17 02:41:59.383762"], ["dummy_tribe_id", 18], ["name", "Vicki Pacurar"], ["updated_at", "2014-11-17 02:41:59.383762"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO "dummy_tribes" ("created_at", "name", "updated_at") VALUES ($1, $2, $3) RETURNING "id"  [["created_at", "2014-11-17 02:41:59.387218"], ["name", "MyString"], ["updated_at", "2014-11-17 02:41:59.387218"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO "dummy_parents" ("created_at", "dummy_grandparent_id", "dummy_tribe_id", "name", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["created_at", "2014-11-17 02:41:59.390309"], ["dummy_grandparent_id", 6], ["dummy_tribe_id", 19], ["name", "Sarah Jane Schoeneman"], ["updated_at", "2014-11-17 02:41:59.390309"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "dummy_tribes" ("created_at", "name", "updated_at") VALUES ($1, $2, $3) RETURNING "id"  [["created_at", "2014-11-17 02:41:59.393539"], ["name", "MyString"], ["updated_at", "2014-11-17 02:41:59.393539"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO "dummy_children" ("created_at", "dummy_parent_id", "dummy_tribe_id", "name", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["created_at", "2014-11-17 02:41:59.396174"], ["dummy_parent_id", 5], ["dummy_tribe_id", 20], ["name", "Ella Mac"], ["updated_at", "2014-11-17 02:41:59.396174"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "dummy_tribes" ("created_at", "name", "updated_at") VALUES ($1, $2, $3) RETURNING "id"  [["created_at", "2014-11-17 02:41:59.403800"], ["name", "MyString"], ["updated_at", "2014-11-17 02:41:59.403800"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "dummy_grandparents" ("created_at", "dummy_tribe_id", "name", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["created_at", "2014-11-17 02:41:59.405832"], ["dummy_tribe_id", 21], ["name", "Vicki Pacurar"], ["updated_at", "2014-11-17 02:41:59.405832"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.3ms)[0m  INSERT INTO "dummy_tribes" ("created_at", "name", "updated_at") VALUES ($1, $2, $3) RETURNING "id"  [["created_at", "2014-11-17 02:41:59.408137"], ["name", "MyString"], ["updated_at", "2014-11-17 02:41:59.408137"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "dummy_parents" ("created_at", "dummy_grandparent_id", "dummy_tribe_id", "name", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["created_at", "2014-11-17 02:41:59.410345"], ["dummy_grandparent_id", 7], ["dummy_tribe_id", 22], ["name", "Sarah Jane Schoeneman"], ["updated_at", "2014-11-17 02:41:59.410345"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "dummy_tribes" ("created_at", "name", "updated_at") VALUES ($1, $2, $3) RETURNING "id"  [["created_at", "2014-11-17 02:41:59.412414"], ["name", "MyString"], ["updated_at", "2014-11-17 02:41:59.412414"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "dummy_children" ("created_at", "dummy_parent_id", "dummy_tribe_id", "name", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["created_at", "2014-11-17 02:41:59.414245"], ["dummy_parent_id", 6], ["dummy_tribe_id", 23], ["name", "Ella Mac"], ["updated_at", "2014-11-17 02:41:59.414245"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[36mActiveRecord::SchemaMigration Load (1.1ms)[0m  [1mSELECT "schema_migrations".* FROM "schema_migrations"[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.0ms)[0m  BEGIN
  [1m[36m (0.2ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mButtafly::Spreadsheet Exists (2.5ms)[0m  SELECT  1 AS one FROM "buttafly_spreadsheets"  WHERE "buttafly_spreadsheets"."name" = 'test_file_name1' LIMIT 1
  [1m[36mSQL (1.0ms)[0m  [1mINSERT INTO "buttafly_spreadsheets" ("aasm_state", "created_at", "data", "flat_file", "name", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["aasm_state", "not_imported"], ["created_at", "2014-11-17 21:58:40.018604"], ["data", "{}"], ["flat_file", "family.odt.csv"], ["name", "test_file_name1"], ["updated_at", "2014-11-17 21:58:40.018604"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mButtafly::Spreadsheet Exists (0.4ms)[0m  SELECT  1 AS one FROM "buttafly_spreadsheets"  WHERE ("buttafly_spreadsheets"."name" = 'test_file_name1' AND "buttafly_spreadsheets"."id" != 23) LIMIT 1
  [1m[36mSQL (0.3ms)[0m  [1mUPDATE "buttafly_spreadsheets" SET "data" = $1, "updated_at" = $2 WHERE "buttafly_spreadsheets"."id" = 23[0m  [["data", "[{\"child name\":\"ella mac\",\"parent name\":\"sara\",\"grandparent name\":\"kc shekhar\",\"tribe name\":\"india\",\"age\":\"2.5\"},{\"child name\":\"rohan\",\"parent name\":\"doug\",\"grandparent name\":\"vicki\",\"tribe name\":\"america\",\"age\":\"6\"}]"], ["updated_at", "2014-11-17 21:58:40.025119"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mButtafly::Spreadsheet Exists (0.3ms)[0m  SELECT  1 AS one FROM "buttafly_spreadsheets"  WHERE "buttafly_spreadsheets"."name" = 'test_file_name2' LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "buttafly_spreadsheets" ("aasm_state", "created_at", "data", "flat_file", "name", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["aasm_state", "not_imported"], ["created_at", "2014-11-17 21:58:40.030839"], ["data", "{}"], ["flat_file", "family.odt.csv"], ["name", "test_file_name2"], ["updated_at", "2014-11-17 21:58:40.030839"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mButtafly::Spreadsheet Exists (0.2ms)[0m  SELECT  1 AS one FROM "buttafly_spreadsheets"  WHERE ("buttafly_spreadsheets"."name" = 'test_file_name2' AND "buttafly_spreadsheets"."id" != 24) LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mUPDATE "buttafly_spreadsheets" SET "data" = $1, "imported_at" = $2, "updated_at" = $3 WHERE "buttafly_spreadsheets"."id" = 24[0m  [["data", "[{\"child name\":\"ella mac\",\"parent name\":\"sara\",\"grandparent name\":\"kc shekhar\",\"tribe name\":\"india\",\"age\":\"2.5\"},{\"child name\":\"rohan\",\"parent name\":\"doug\",\"grandparent name\":\"vicki\",\"tribe name\":\"america\",\"age\":\"6\"}]"], ["imported_at", "2014-11-17 21:58:40.032728"], ["updated_at", "2014-11-17 21:58:40.034493"]]
  [1m[35mButtafly::Spreadsheet Exists (0.2ms)[0m  SELECT  1 AS one FROM "buttafly_spreadsheets"  WHERE ("buttafly_spreadsheets"."name" = 'test_file_name2' AND "buttafly_spreadsheets"."id" != 24) LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mUPDATE "buttafly_spreadsheets" SET "aasm_state" = $1, "updated_at" = $2 WHERE "buttafly_spreadsheets"."id" = 24[0m  [["aasm_state", "imported"], ["updated_at", "2014-11-17 21:58:40.036872"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.1ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36m (0.2ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
-------------------------------------------------------------------------
Buttafly::ContentsController: test_0001_get #show must assign @originable
-------------------------------------------------------------------------
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mButtafly::Spreadsheet Exists (0.3ms)[0m  SELECT  1 AS one FROM "buttafly_spreadsheets"  WHERE "buttafly_spreadsheets"."name" = 'test_file_name3' LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "buttafly_spreadsheets" ("aasm_state", "created_at", "data", "flat_file", "name", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["aasm_state", "not_imported"], ["created_at", "2014-11-17 21:58:40.073305"], ["data", "{}"], ["flat_file", "family.odt.csv"], ["name", "test_file_name3"], ["updated_at", "2014-11-17 21:58:40.073305"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by Buttafly::ContentsController#show as HTML
  Parameters: {"id"=>"25"}
  [1m[36mButtafly::Spreadsheet Load (0.2ms)[0m  [1mSELECT  "buttafly_spreadsheets".* FROM "buttafly_spreadsheets"  WHERE "buttafly_spreadsheets"."id" = $1 LIMIT 1[0m  [["id", 25]]
  Rendered /home/fred/work/opensource/buttafly/app/views/buttafly/contents/show.html.haml within layouts/application (1.5ms)
  Rendered application/_messages.html.haml (1.2ms)
Completed 200 OK in 71ms (Views: 69.4ms | ActiveRecord: 0.2ms)
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
-------------------------------------------------
Buttafly::ContentsController: test_0002_get #edit
-------------------------------------------------
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mButtafly::Spreadsheet Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM "buttafly_spreadsheets"  WHERE "buttafly_spreadsheets"."name" = 'test_file_name4' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "buttafly_spreadsheets" ("aasm_state", "created_at", "data", "flat_file", "name", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["aasm_state", "not_imported"], ["created_at", "2014-11-17 21:58:40.152868"], ["data", "{}"], ["flat_file", "family.odt.csv"], ["name", "test_file_name4"], ["updated_at", "2014-11-17 21:58:40.152868"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by Buttafly::ContentsController#edit as HTML
  Parameters: {"id"=>"26"}
  [1m[35mButtafly::Spreadsheet Load (0.2ms)[0m  SELECT  "buttafly_spreadsheets".* FROM "buttafly_spreadsheets"  WHERE "buttafly_spreadsheets"."id" = $1 LIMIT 1  [["id", 26]]
  Rendered /home/fred/work/opensource/buttafly/app/views/buttafly/contents/_form.html.haml (5.1ms)
  Rendered application/_messages.html.haml (0.1ms)
Completed 200 OK in 10ms (Views: 9.2ms | ActiveRecord: 0.2ms)
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
----------------------------------------------------
Buttafly::ContentsController: test_0003_post #create
----------------------------------------------------
Processing by Buttafly::ContentsController#create as HTML
  Parameters: {"originable"=>{"name"=>"slick name", "flat_file"=>"slickname.csv"}}
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mButtafly::Spreadsheet Exists (0.3ms)[0m  SELECT  1 AS one FROM "buttafly_spreadsheets"  WHERE "buttafly_spreadsheets"."name" = 'slick name' LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "buttafly_spreadsheets" ("aasm_state", "created_at", "flat_file", "name", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["aasm_state", "not_imported"], ["created_at", "2014-11-17 21:58:40.169621"], ["flat_file", nil], ["name", "slick name"], ["updated_at", "2014-11-17 21:58:40.169621"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://test.host/buttafly/contents
Completed 302 Found in 4ms (ActiveRecord: 0.6ms)
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
-------------------------------------------------------------------------
Buttafly::ContentsController: test_0004_patch #import saves a spreadsheet
-------------------------------------------------------------------------
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mButtafly::Spreadsheet Exists (0.2ms)[0m  SELECT  1 AS one FROM "buttafly_spreadsheets"  WHERE "buttafly_spreadsheets"."name" = 'test_file_name5' LIMIT 1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO "buttafly_spreadsheets" ("aasm_state", "created_at", "data", "flat_file", "name", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["aasm_state", "not_imported"], ["created_at", "2014-11-17 21:58:40.175039"], ["data", "{}"], ["flat_file", "family.odt.csv"], ["name", "test_file_name5"], ["updated_at", "2014-11-17 21:58:40.175039"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by Buttafly::ContentsController#import as HTML
  Parameters: {"originable_type"=>"Buttafly::Spreadsheet", "id"=>"28"}
  [1m[36mButtafly::Spreadsheet Load (0.3ms)[0m  [1mSELECT  "buttafly_spreadsheets".* FROM "buttafly_spreadsheets"  WHERE "buttafly_spreadsheets"."id" = $1 LIMIT 1[0m  [["id", 28]]
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mButtafly::Spreadsheet Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "buttafly_spreadsheets"  WHERE ("buttafly_spreadsheets"."name" = 'test_file_name5' AND "buttafly_spreadsheets"."id" != 28) LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  UPDATE "buttafly_spreadsheets" SET "data" = $1, "imported_at" = $2, "updated_at" = $3 WHERE "buttafly_spreadsheets"."id" = 28  [["data", "[{\"child name\":\"ella mac\",\"parent name\":\"sara\",\"grandparent name\":\"kc shekhar\",\"tribe name\":\"india\",\"age\":\"2.5\"},{\"child name\":\"rohan\",\"parent name\":\"doug\",\"grandparent name\":\"vicki\",\"tribe name\":\"america\",\"age\":\"6\"}]"], ["imported_at", "2014-11-17 21:58:40.179592"], ["updated_at", "2014-11-17 21:58:40.181666"]]
  [1m[36mButtafly::Spreadsheet Exists (0.2ms)[0m  [1mSELECT  1 AS one FROM "buttafly_spreadsheets"  WHERE ("buttafly_spreadsheets"."name" = 'test_file_name5' AND "buttafly_spreadsheets"."id" != 28) LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  UPDATE "buttafly_spreadsheets" SET "aasm_state" = $1, "updated_at" = $2 WHERE "buttafly_spreadsheets"."id" = 28  [["aasm_state", "imported"], ["updated_at", "2014-11-17 21:58:40.184192"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Redirected to /referring/url
Completed 302 Found in 7ms (ActiveRecord: 1.4ms)
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
------------------------------------------------------------------------
Buttafly::ContentsController: test_0005_post #create saves a spreadsheet
------------------------------------------------------------------------
  [1m[35m (0.2ms)[0m  SELECT COUNT(*) FROM "buttafly_spreadsheets"
Processing by Buttafly::ContentsController#create as HTML
  Parameters: {"originable"=>{"name"=>"sweeet name", "flat_file"=>"summer.csv"}}
  [1m[36m (0.2ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mButtafly::Spreadsheet Exists (0.6ms)[0m  SELECT  1 AS one FROM "buttafly_spreadsheets"  WHERE "buttafly_spreadsheets"."name" = 'sweeet name' LIMIT 1
  [1m[36mSQL (0.3ms)[0m  [1mINSERT INTO "buttafly_spreadsheets" ("aasm_state", "created_at", "flat_file", "name", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["aasm_state", "not_imported"], ["created_at", "2014-11-17 21:58:40.192426"], ["flat_file", nil], ["name", "sweeet name"], ["updated_at", "2014-11-17 21:58:40.192426"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Redirected to http://test.host/buttafly/contents
Completed 302 Found in 6ms (ActiveRecord: 1.2ms)
  [1m[36m (0.2ms)[0m  [1mSELECT COUNT(*) FROM "buttafly_spreadsheets"[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
--------------------------------------------------------
Buttafly::ContentsController: test_0006_should get index
--------------------------------------------------------
Processing by Buttafly::ContentsController#index as HTML
  Rendered /home/fred/work/opensource/buttafly/app/views/buttafly/contents/_form.html.haml (1.3ms)
  [1m[35mButtafly::Spreadsheet Load (0.6ms)[0m  SELECT  "buttafly_spreadsheets".* FROM "buttafly_spreadsheets"   ORDER BY "buttafly_spreadsheets"."created_at" ASC LIMIT 5 OFFSET 0
  [1m[36m (0.2ms)[0m  [1mSELECT COUNT(*) FROM "buttafly_spreadsheets"[0m
  Rendered application/_messages.html.haml (0.1ms)
Completed 200 OK in 23ms (Views: 10.6ms | ActiveRecord: 2.5ms)
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  COMMIT
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.2ms)[0m  COMMIT
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (1.0ms)[0m  [1mINSERT INTO "dummy_tribes" ("created_at", "name", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["created_at", "2014-11-17 21:58:40.235138"], ["name", "MyString"], ["updated_at", "2014-11-17 21:58:40.235138"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (3.0ms)[0m  INSERT INTO "dummy_grandparents" ("created_at", "dummy_tribe_id", "name", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"  [["created_at", "2014-11-17 21:58:40.238541"], ["dummy_tribe_id", 24], ["name", "Vicki Pacurar"], ["updated_at", "2014-11-17 21:58:40.238541"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "dummy_tribes" ("created_at", "name", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["created_at", "2014-11-17 21:58:40.244276"], ["name", "MyString"], ["updated_at", "2014-11-17 21:58:40.244276"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.9ms)[0m  INSERT INTO "dummy_parents" ("created_at", "dummy_grandparent_id", "dummy_tribe_id", "name", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["created_at", "2014-11-17 21:58:40.246353"], ["dummy_grandparent_id", 8], ["dummy_tribe_id", 25], ["name", "Sarah Jane Schoeneman"], ["updated_at", "2014-11-17 21:58:40.246353"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "dummy_tribes" ("created_at", "name", "updated_at") VALUES ($1, $2, $3) RETURNING "id"[0m  [["created_at", "2014-11-17 21:58:40.250224"], ["name", "MyString"], ["updated_at", "2014-11-17 21:58:40.250224"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
---------------------------------------------
create legend Feature Test: test_0001_success
---------------------------------------------
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mButtafly::Spreadsheet Exists (0.2ms)[0m  SELECT  1 AS one FROM "buttafly_spreadsheets"  WHERE "buttafly_spreadsheets"."name" = 'test_file_name6' LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "buttafly_spreadsheets" ("aasm_state", "created_at", "data", "flat_file", "name", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["aasm_state", "not_imported"], ["created_at", "2014-11-17 21:58:40.262526"], ["data", "{}"], ["flat_file", "family.odt.csv"], ["name", "test_file_name6"], ["updated_at", "2014-11-17 21:58:40.262526"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (1.5ms)[0m  INSERT INTO "buttafly_mappings" ("created_at", "originable_id", "originable_type", "targetable_model", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["created_at", "2014-11-17 21:58:40.265504"], ["originable_id", 30], ["originable_type", "Buttafly::Spreadsheet"], ["targetable_model", "DummyChild"], ["updated_at", "2014-11-17 21:58:40.265504"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Started GET "/buttafly/contents" for 127.0.0.1 at 2014-11-17 13:58:40 -0800
Processing by Buttafly::ContentsController#index as HTML
  Rendered /home/fred/work/opensource/buttafly/app/views/buttafly/contents/_form.html.haml (1.6ms)
  [1m[35mButtafly::Spreadsheet Load (0.3ms)[0m  SELECT  "buttafly_spreadsheets".* FROM "buttafly_spreadsheets"   ORDER BY "buttafly_spreadsheets"."created_at" ASC LIMIT 5 OFFSET 0
  [1m[36mButtafly::Mapping Load (0.3ms)[0m  [1mSELECT "buttafly_mappings".* FROM "buttafly_mappings"  WHERE "buttafly_mappings"."originable_id" = $1 AND "buttafly_mappings"."originable_type" = $2[0m  [["originable_id", 30], ["originable_type", "Buttafly::Spreadsheet"]]
  [1m[35mButtafly::Legend Load (0.9ms)[0m  SELECT "buttafly_legends".* FROM "buttafly_legends"
  Rendered /home/fred/work/opensource/buttafly/app/views/buttafly/contents/_content.html.haml (18.9ms)
  [1m[36m (0.3ms)[0m  [1mSELECT COUNT(*) FROM "buttafly_spreadsheets"[0m
  Rendered application/_messages.html.haml (7.6ms)
Completed 200 OK in 34ms (Views: 30.8ms | ActiveRecord: 1.8ms)
Started GET "/buttafly/legends/new?mapping_id=11" for 127.0.0.1 at 2014-11-17 13:58:40 -0800
Processing by Buttafly::LegendsController#new as HTML
  Parameters: {"mapping_id"=>"11"}
  [1m[35mButtafly::Mapping Load (0.2ms)[0m  SELECT  "buttafly_mappings".* FROM "buttafly_mappings"  WHERE "buttafly_mappings"."id" = $1 LIMIT 1  [["id", 11]]
  [1m[36mButtafly::Spreadsheet Load (0.3ms)[0m  [1mSELECT  "buttafly_spreadsheets".* FROM "buttafly_spreadsheets"  WHERE "buttafly_spreadsheets"."id" = $1 LIMIT 1[0m  [["id", 30]]
Completed 500 Internal Server Error in 15ms
  [1m[35m (0.2ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  COMMIT
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  COMMIT
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  COMMIT
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  COMMIT
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
-------------------------------------------------------------
Buttafly::LegendsController::GET #new: test_0001_must succeed
-------------------------------------------------------------
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mButtafly::Spreadsheet Exists (0.3ms)[0m  [1mSELECT  1 AS one FROM "buttafly_spreadsheets"  WHERE "buttafly_spreadsheets"."name" = 'test_file_name10' LIMIT 1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "buttafly_spreadsheets" ("aasm_state", "created_at", "data", "flat_file", "name", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"  [["aasm_state", "not_imported"], ["created_at", "2014-11-17 21:58:40.347536"], ["data", "{}"], ["flat_file", "family.odt.csv"], ["name", "test_file_name10"], ["updated_at", "2014-11-17 21:58:40.347536"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
  [1m[35m (0.1ms)[0m  SAVEPOINT active_record_1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "buttafly_mappings" ("created_at", "originable_id", "originable_type", "targetable_model", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["created_at", "2014-11-17 21:58:40.350008"], ["originable_id", 31], ["originable_type", "Buttafly::Spreadsheet"], ["targetable_model", "DummyChild"], ["updated_at", "2014-11-17 21:58:40.350008"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
Processing by Buttafly::LegendsController#new as HTML
  Parameters: {"mapping_id"=>"12"}
  [1m[36mButtafly::Mapping Load (0.2ms)[0m  [1mSELECT  "buttafly_mappings".* FROM "buttafly_mappings"  WHERE "buttafly_mappings"."id" = $1 LIMIT 1[0m  [["id", 12]]
  [1m[35mButtafly::Spreadsheet Load (0.2ms)[0m  SELECT  "buttafly_spreadsheets".* FROM "buttafly_spreadsheets"  WHERE "buttafly_spreadsheets"."id" = $1 LIMIT 1  [["id", 31]]
Completed 500 Internal Server Error in 6ms
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
------------------------------------------------------------------------------------------------
Buttafly::LegendsController::GET #new: test_0002_must instantiate a legend from existing mapping
------------------------------------------------------------------------------------------------
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mButtafly::Spreadsheet Exists (0.2ms)[0m  SELECT  1 AS one FROM "buttafly_spreadsheets"  WHERE "buttafly_spreadsheets"."name" = 'test_file_name11' LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "buttafly_spreadsheets" ("aasm_state", "created_at", "data", "flat_file", "name", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["aasm_state", "not_imported"], ["created_at", "2014-11-17 21:58:40.362327"], ["data", "{}"], ["flat_file", "family.odt.csv"], ["name", "test_file_name11"], ["updated_at", "2014-11-17 21:58:40.362327"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "buttafly_mappings" ("created_at", "originable_id", "originable_type", "targetable_model", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["created_at", "2014-11-17 21:58:40.365195"], ["originable_id", 32], ["originable_type", "Buttafly::Spreadsheet"], ["targetable_model", "DummyChild"], ["updated_at", "2014-11-17 21:58:40.365195"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by Buttafly::LegendsController#new as HTML
  Parameters: {"mapping_id"=>"13"}
  [1m[35mButtafly::Mapping Load (0.2ms)[0m  SELECT  "buttafly_mappings".* FROM "buttafly_mappings"  WHERE "buttafly_mappings"."id" = $1 LIMIT 1  [["id", 13]]
  [1m[36mButtafly::Spreadsheet Load (0.2ms)[0m  [1mSELECT  "buttafly_spreadsheets".* FROM "buttafly_spreadsheets"  WHERE "buttafly_spreadsheets"."id" = $1 LIMIT 1[0m  [["id", 32]]
Completed 500 Internal Server Error in 6ms
  [1m[35m (0.2ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  COMMIT
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  COMMIT
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  ROLLBACK
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35m (0.1ms)[0m  COMMIT
  [1m[36m (0.0ms)[0m  [1mBEGIN[0m
  [1m[35mButtafly::Spreadsheet Exists (0.3ms)[0m  SELECT  1 AS one FROM "buttafly_spreadsheets"  WHERE "buttafly_spreadsheets"."name" = 'test_file_name12' LIMIT 1
  [1m[36m (0.1ms)[0m  [1mROLLBACK[0m
  [1m[35m (0.1ms)[0m  BEGIN
-----------------------------------------------------------------------------
Buttafly::LegendsController::POST #create: test_0001_must create a new legend
-----------------------------------------------------------------------------
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mButtafly::Spreadsheet Exists (0.3ms)[0m  SELECT  1 AS one FROM "buttafly_spreadsheets"  WHERE "buttafly_spreadsheets"."name" = 'test_file_name13' LIMIT 1
  [1m[36mSQL (0.2ms)[0m  [1mINSERT INTO "buttafly_spreadsheets" ("aasm_state", "created_at", "data", "flat_file", "name", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["aasm_state", "not_imported"], ["created_at", "2014-11-17 21:58:40.386439"], ["data", "{}"], ["flat_file", "family.odt.csv"], ["name", "test_file_name13"], ["updated_at", "2014-11-17 21:58:40.386439"]]
  [1m[35m (0.1ms)[0m  RELEASE SAVEPOINT active_record_1
  [1m[36m (0.1ms)[0m  [1mSAVEPOINT active_record_1[0m
  [1m[35mSQL (0.2ms)[0m  INSERT INTO "buttafly_mappings" ("created_at", "originable_id", "originable_type", "targetable_model", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"  [["created_at", "2014-11-17 21:58:40.388546"], ["originable_id", 33], ["originable_type", "Buttafly::Spreadsheet"], ["targetable_model", "DummyChild"], ["updated_at", "2014-11-17 21:58:40.388546"]]
  [1m[36m (0.1ms)[0m  [1mRELEASE SAVEPOINT active_record_1[0m
Processing by Buttafly::LegendsController#create as HTML
  Parameters: {"mapping_id"=>"14"}
Completed 500 Internal Server Error in 4771530ms
  [1m[35m (8.8ms)[0m  ROLLBACK
